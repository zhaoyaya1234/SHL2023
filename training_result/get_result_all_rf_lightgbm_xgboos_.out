nohup: ignoring input
the all length of training set:3922100
the all length of test set:575840
begin training single
training set:Hips,the 0th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 183.54
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.485373 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47625
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.081080
[LightGBM] [Info] Start training from score -2.078672
[LightGBM] [Info] Start training from score -3.147269
[LightGBM] [Info] Start training from score -2.121692
[LightGBM] [Info] Start training from score -1.820387
[LightGBM] [Info] Start training from score -1.933671
[LightGBM] [Info] Start training from score -1.837207
[LightGBM] [Info] Start training from score -2.108093
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.46916
[2]	valid_0's multi_logloss: 1.1849
[3]	valid_0's multi_logloss: 0.983715
[4]	valid_0's multi_logloss: 0.830338
[5]	valid_0's multi_logloss: 0.708569
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.611559
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[7]	valid_0's multi_logloss: 0.531461
[8]	valid_0's multi_logloss: 0.465133
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.409174
[10]	valid_0's multi_logloss: 0.361856
[11]	valid_0's multi_logloss: 0.321996
[12]	valid_0's multi_logloss: 0.288058
[13]	valid_0's multi_logloss: 0.257541
[14]	valid_0's multi_logloss: 0.232204
[15]	valid_0's multi_logloss: 0.209733
[16]	valid_0's multi_logloss: 0.190369
[17]	valid_0's multi_logloss: 0.17388
[18]	valid_0's multi_logloss: 0.159467
[19]	valid_0's multi_logloss: 0.147029
[20]	valid_0's multi_logloss: 0.136284
[21]	valid_0's multi_logloss: 0.126609
[22]	valid_0's multi_logloss: 0.117958
[23]	valid_0's multi_logloss: 0.109993
[24]	valid_0's multi_logloss: 0.103065
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[25]	valid_0's multi_logloss: 0.0970601
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[26]	valid_0's multi_logloss: 0.091852
[27]	valid_0's multi_logloss: 0.0866803
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[28]	valid_0's multi_logloss: 0.081963
[29]	valid_0's multi_logloss: 0.0778369
[30]	valid_0's multi_logloss: 0.0741576
[31]	valid_0's multi_logloss: 0.0702941
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[32]	valid_0's multi_logloss: 0.0673209
[33]	valid_0's multi_logloss: 0.0643257
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[34]	valid_0's multi_logloss: 0.0617195
[35]	valid_0's multi_logloss: 0.05932
[36]	valid_0's multi_logloss: 0.0568395
[37]	valid_0's multi_logloss: 0.0543781
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0521422
[39]	valid_0's multi_logloss: 0.0499157
[40]	valid_0's multi_logloss: 0.0480438
[41]	valid_0's multi_logloss: 0.0463534
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0447188
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[43]	valid_0's multi_logloss: 0.0431721
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.041444
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0394871
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0380888
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0364171
[48]	valid_0's multi_logloss: 0.0351965
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0343355
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0330976
[51]	valid_0's multi_logloss: 0.0320694
[52]	valid_0's multi_logloss: 0.0308725
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0298747
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0289398
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0281286
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0274535
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0266994
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0259331
[59]	valid_0's multi_logloss: 0.0250524
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0244539
[61]	valid_0's multi_logloss: 0.0237644
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0231415
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0225392
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0220468
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0213655
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0208662
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0204501
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0199361
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0192093
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0187124
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0182901
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0178408
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0174412
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0170239
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0166473
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0160727
[77]	valid_0's multi_logloss: 0.0157015
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0153874
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0151394
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0147634
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0144913
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0142224
[83]	valid_0's multi_logloss: 0.0138656
[84]	valid_0's multi_logloss: 0.0135741
[85]	valid_0's multi_logloss: 0.0133023
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0130142
[87]	valid_0's multi_logloss: 0.0126874
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0124179
[89]	valid_0's multi_logloss: 0.012113
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.0118649
[91]	valid_0's multi_logloss: 0.0116162
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[92]	valid_0's multi_logloss: 0.0113836
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.0112008
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0109848
[95]	valid_0's multi_logloss: 0.0108124
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.0105946
[97]	valid_0's multi_logloss: 0.0103457
[98]	valid_0's multi_logloss: 0.0101514
[99]	valid_0's multi_logloss: 0.00999371
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[100]	valid_0's multi_logloss: 0.00981674
Time elapsed for training LightGBM: 100.74
Training XGBoost...
Time elapsed for training XGBoost: 395.36
begin testing
training set : Hips ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.26
predict lgb
Time elapsed for testing lgb: 1.48
predict xgb
Time elapsed for testing xgb: 3.01
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hips ; testing set : Torso  testing result
tree_model.pred_mean
[[24910    10     0   119  1651   804  1980   366]
 [ 3560  3842     0 11310   476  4441   711  1803]
 [    0   848     0  1926     0     0     0     0]
 [  390     0     0  7876  2800   966     0     0]
 [  151     0     0     3 20210   110     0     0]
 [   89     0     0    56   880  7887   268     0]
 [ 1941     0     0    40   503  2920 15292  1114]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.80      0.83      0.82     29840
     Walking       0.82      0.15      0.25     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.37      0.65      0.47     12032
         Car       0.76      0.99      0.86     20474
         Bus       0.46      0.86      0.60      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.76      0.49      0.60     21707

    accuracy                           0.63    143960
   macro avg       0.56      0.58      0.52    143960
weighted avg       0.68      0.63      0.60    143960

tree_model.pred_mean_rf
[[24844     0     0    48  1726  1005  1772   445]
 [ 1550   789     0 17454  1110  3666   362  1212]
 [    0   852     0  1922     0     0     0     0]
 [    9     0     0  3396  5310  3167   150     0]
 [  268     0     0     0 18097  1978     0   131]
 [ 1174     0     0    21   480  7505     0     0]
 [ 2496     0     0    24     0  2468 13341  3481]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.83      0.83     29840
     Walking       0.48      0.03      0.06     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.15      0.28      0.19     12032
         Car       0.68      0.88      0.77     20474
         Bus       0.38      0.82      0.52      9180
       Train       0.50      0.61      0.55     21810
      Subway       0.67      0.49      0.56     21707

    accuracy                           0.55    143960
   macro avg       0.46      0.49      0.43    143960
weighted avg       0.57      0.55      0.51    143960

tree_model.pred_mean_lightgbm
[[23974    16     0   168  2083   899  2314   386]
 [ 3133  5201     0  9992   368  4918   799  1732]
 [    0   857     0  1917     0     0     0     0]
 [  423     0     0  8678  2931     0     0     0]
 [   58     0     0     0 20363    53     0     0]
 [   46     0     0    54   627  7715   738     0]
 [ 1525     0     0    47   675  3182 15290  1091]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.80      0.81     29840
     Walking       0.86      0.20      0.32     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.42      0.72      0.53     12032
         Car       0.75      0.99      0.86     20474
         Bus       0.46      0.84      0.59      9180
       Train       0.51      0.70      0.59     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.64    143960
   macro avg       0.57      0.59      0.54    143960
weighted avg       0.69      0.64      0.61    143960

tree_model.pred_mean_xgb
[[26086    27     0   250   985   621  1647   224]
 [ 4748  3258     0 11439   389  4005   520  1784]
 [    0   823     0  1479     0   472     0     0]
 [  688     0     0  8015  2233  1096     0     0]
 [  403     0     0     0 19844   227     0     0]
 [   99     0     0    82   977  7813   209     0]
 [ 1867     0     0    36   360  3050 15321  1176]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.77      0.87      0.82     29840
     Walking       0.79      0.12      0.22     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.38      0.67      0.48     12032
         Car       0.80      0.97      0.88     20474
         Bus       0.45      0.85      0.59      9180
       Train       0.53      0.70      0.61     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.63    143960
   macro avg       0.56      0.58      0.52    143960
weighted avg       0.67      0.63      0.59    143960

tree_model.pred_mv
[[25079    88     0   105  1513   913  1789   353]
 [ 4284  4198     0 11443   380  3797   486  1555]
 [    0   803     0  1911     0    60     0     0]
 [  728    29     0  7286  2835  1154     0     0]
 [  449     2     0     0 19643   370    10     0]
 [  685     0     0   152   886  7293   164     0]
 [ 1703    11     0    55   490  3082 15247  1222]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.76      0.84      0.80     29840
     Walking       0.82      0.16      0.27     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.35      0.61      0.44     12032
         Car       0.76      0.96      0.85     20474
         Bus       0.44      0.79      0.56      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.62    143960
   macro avg       0.55      0.57      0.52    143960
weighted avg       0.67      0.62      0.59    143960

test over
training set : Hips ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.06
predict lgb
Time elapsed for testing lgb: 1.26
predict xgb
Time elapsed for testing xgb: 2.55
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hips ; testing set : Bag  testing result
tree_model.pred_mean
[[27406     0     0   127   259   272   589  1187]
 [ 4055   614     0 16592   656  2006   511  1709]
 [    0  1373     0  1401     0     0     0     0]
 [  946     0     0  5957  4384   745     0     0]
 [   82     0     0    11 18849  1532     0     0]
 [   37     0     0   379  3011  5431   322     0]
 [  699     0     0   134  2326   757 16815  1079]
 [    0     0     0     0     0     0  2289 19418]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.31      0.02      0.04     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.24      0.50      0.33     12032
         Car       0.64      0.92      0.75     20474
         Bus       0.51      0.59      0.55      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.66    143960
   macro avg       0.52      0.58      0.52    143960
weighted avg       0.62      0.66      0.61    143960

tree_model.pred_mean_rf
[[28304     0     0    67   451   216   410   392]
 [ 1343   618     0 17641  1083  3502   428  1528]
 [    0   651     0  2123     0     0     0     0]
 [   78     0     0   935  7800  3219     0     0]
 [  101     0     0     8 18239  1928   101    97]
 [   13     0     0    63   711  8393     0     0]
 [ 1047     0     0    34   946   891 16002  2890]
 [    0     0     0     0     0     0  2301 19406]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.92      0.95      0.93     29840
     Walking       0.49      0.02      0.05     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.04      0.08      0.06     12032
         Car       0.62      0.89      0.73     20474
         Bus       0.46      0.91      0.61      9180
       Train       0.83      0.73      0.78     21810
      Subway       0.80      0.89      0.84     21707

    accuracy                           0.64    143960
   macro avg       0.52      0.56      0.50    143960
weighted avg       0.65      0.64      0.59    143960

tree_model.pred_mean_lightgbm
[[26989    33     0   179   489   207   756  1187]
 [ 4379  1483     0 15487   580  2099   564  1551]
 [    0  1466     0  1308     0     0     0     0]
 [ 1241     0     0  6881  3462   448     0     0]
 [   67     0     0     8 19223  1176     0     0]
 [   28     0     0   639  3091  4847   575     0]
 [  603     0     0   161  3529   697 15765  1055]
 [    0     0     0     0     0     0  2282 19425]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.81      0.90      0.85     29840
     Walking       0.50      0.06      0.10     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.28      0.57      0.38     12032
         Car       0.63      0.94      0.76     20474
         Bus       0.51      0.53      0.52      9180
       Train       0.79      0.72      0.76     21810
      Subway       0.84      0.89      0.86     21707

    accuracy                           0.66    143960
   macro avg       0.54      0.58      0.53    143960
weighted avg       0.65      0.66      0.61    143960

tree_model.pred_mean_xgb
[[27531    31     0   235   235   313   482  1013]
 [ 4423  1259     0 16010   247  2073   460  1671]
 [    0  1608     0  1166     0     0     0     0]
 [  726   452     0  7023  2537  1294     0     0]
 [  142     0     0    19 17909  2404     0     0]
 [   38     0     0   331  3609  4813   389     0]
 [  733     0     0   158  1994   795 17097  1033]
 [    0     0     0     0     0     0  2287 19420]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.38      0.05      0.09     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.28      0.58      0.38     12032
         Car       0.68      0.87      0.76     20474
         Bus       0.41      0.52      0.46      9180
       Train       0.83      0.78      0.80     21810
      Subway       0.84      0.89      0.87     21707

    accuracy                           0.66    143960
   macro avg       0.53      0.58      0.53    143960
weighted avg       0.64      0.66      0.62    143960

tree_model.pred_mv
[[27486    34     0   181   384   271   483  1001]
 [ 4544  1494     0 15592   559  2117   389  1448]
 [    1  1402     0  1371     0     0     0     0]
 [ 1295    36     0  5030  4164  1507     0     0]
 [  218    25     0     1 18613  1596    21     0]
 [   40     0     0   673  2902  5235   330     0]
 [  928     0     0   157  2120   810 16736  1059]
 [    0     0     0     0     0     0  2283 19424]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.80      0.92      0.85     29840
     Walking       0.50      0.06      0.10     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.22      0.42      0.29     12032
         Car       0.65      0.91      0.76     20474
         Bus       0.45      0.57      0.51      9180
       Train       0.83      0.77      0.80     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.65    143960
   macro avg       0.54      0.57      0.52    143960
weighted avg       0.65      0.65      0.61    143960

test over
training set : Hips ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.15
predict lgb
Time elapsed for testing lgb: 1.33
predict xgb
Time elapsed for testing xgb: 2.43
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hips ; testing set : Hand  testing result
tree_model.pred_mean
[[25619   252     0   597   584  1354   388  1046]
 [ 1345 13348     0  9990    55    23   302  1080]
 [    0  1313     0  1461     0     0     0     0]
 [   27     0     0 11935    70     0     0     0]
 [  528   184     0   406 18244  1112     0     0]
 [    8     0     0   311  3148  5278   435     0]
 [  803     3     0   766  2831    60 16193  1154]
 [    0     0     0     0     0     0  2260 19447]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.88      0.51      0.65     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.47      0.99      0.64     12032
         Car       0.73      0.89      0.80     20474
         Bus       0.67      0.57      0.62      9180
       Train       0.83      0.74      0.78     21810
      Subway       0.86      0.90      0.88     21707

    accuracy                           0.76    143960
   macro avg       0.67      0.68      0.66    143960
weighted avg       0.79      0.76      0.76    143960

tree_model.pred_mean_rf
[[24395   273     0   731  1210  1351   847  1033]
 [  718  9528     0 14694   240   234   153   576]
 [    0  1835     0   939     0     0     0     0]
 [   13     0     0  9604  2118   297     0     0]
 [  611   173     0   399 17401  1857     0    33]
 [   49     0     0   171  2285  6675     0     0]
 [  909     4     0   215  2444   429 15081  2728]
 [    0     0     0     0     0     0     0 21707]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.91      0.82      0.86     29840
     Walking       0.81      0.36      0.50     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.36      0.80      0.50     12032
         Car       0.68      0.85      0.75     20474
         Bus       0.62      0.73      0.67      9180
       Train       0.94      0.69      0.80     21810
      Subway       0.83      1.00      0.91     21707

    accuracy                           0.73    143960
   macro avg       0.64      0.66      0.62    143960
weighted avg       0.77      0.73      0.72    143960

tree_model.pred_mean_lightgbm
[[24234   171     0   484   516  2919   329  1187]
 [ 1461 13482     0  9508    96    34   339  1223]
 [    0  1539     0  1235     0     0     0     0]
 [   59    12     0 11879    82     0     0     0]
 [  600   167     0   229 18305  1173     0     0]
 [   22     0     0   738  2775  5173   472     0]
 [  771     5     0   985  3631     0 15286  1132]
 [    0     0     0     0     0     0  2268 19439]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.89      0.81      0.85     29840
     Walking       0.88      0.52      0.65     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.47      0.99      0.64     12032
         Car       0.72      0.89      0.80     20474
         Bus       0.56      0.56      0.56      9180
       Train       0.82      0.70      0.75     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.75    143960
   macro avg       0.65      0.67      0.64    143960
weighted avg       0.77      0.75      0.74    143960

tree_model.pred_mean_xgb
[[25787   350     0  1064   454   770   428   987]
 [ 1699 13753     0  9122     0    14   319  1236]
 [    0   239     0  2535     0     0     0     0]
 [   72     0     0 11960     0     0     0     0]
 [  547   165     0   715 17670  1377     0     0]
 [   16     0     0   369  3419  4668   708     0]
 [  653    24     0  1038  2318    52 16588  1137]
 [    0     0     0     0     0     0  2272 19435]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.95      0.53      0.68     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.45      0.99      0.62     12032
         Car       0.74      0.86      0.80     20474
         Bus       0.68      0.51      0.58      9180
       Train       0.82      0.76      0.79     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.76    143960
   macro avg       0.67      0.68      0.65    143960
weighted avg       0.80      0.76      0.76    143960

tree_model.pred_mv
[[24597   430     0   790   603  1723   637  1060]
 [ 1695 12419     0 10441   109   159   307  1013]
 [    0  1476     0  1298     0     0     0     0]
 [  285   108     0 11397   177    65     0     0]
 [  733   201     0  1221 17061  1239    19     0]
 [  145     0     0   807  2925  4816   487     0]
 [  976    23     0   972  2479   203 15880  1277]
 [    0     0     0     0     0     0  2272 19435]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.87      0.82      0.84     29840
     Walking       0.85      0.48      0.61     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.42      0.95      0.59     12032
         Car       0.73      0.83      0.78     20474
         Bus       0.59      0.52      0.55      9180
       Train       0.81      0.73      0.77     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.73    143960
   macro avg       0.64      0.65      0.63    143960
weighted avg       0.76      0.73      0.73    143960

test over
training set : Hips ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.08
predict lgb
Time elapsed for testing lgb: 1.34
predict xgb
Time elapsed for testing xgb: 2.8
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hips ; testing set : Hips  testing result
tree_model.pred_mean
[[25271   213     0   111   401    65  3620   159]
 [ 1120 21127     0  2839    20    42   703   292]
 [    0  1941   341   492     0     0     0     0]
 [  404   185     0 11443     0     0     0     0]
 [  355    67     0     0 18510  1542     0     0]
 [   28    47     0    45  2643  5995   422     0]
 [  356     1     0    87  4528    27 15784  1027]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.81      0.85     26143
         Run       1.00      0.12      0.22      2774
        Bike       0.76      0.95      0.85     12032
         Car       0.71      0.90      0.79     20474
         Bus       0.78      0.65      0.71      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.81      0.69      0.69    143960
weighted avg       0.79      0.76      0.75    143960

tree_model.pred_mean_rf
[[24546   599     0   345   614    24  3473   239]
 [ 1018 16100     0  8195    26    49   497   258]
 [    0  1710     0  1064     0     0     0     0]
 [   74   123     0 11467   368     0     0     0]
 [ 1160    73     0     0 15568  3512    21   140]
 [  338    52     0    58  2903  5743    86     0]
 [  439     5     0    83  2624   953 15874  1832]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.89      0.82      0.86     29840
     Walking       0.86      0.62      0.72     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.54      0.95      0.69     12032
         Car       0.70      0.76      0.73     20474
         Bus       0.56      0.63      0.59      9180
       Train       0.51      0.73      0.60     21810
      Subway       0.81      0.49      0.61     21707

    accuracy                           0.69    143960
   macro avg       0.61      0.62      0.60    143960
weighted avg       0.72      0.69      0.69    143960

tree_model.pred_mean_lightgbm
[[24207   241     0    71   664   549  3762   346]
 [ 1145 21021     0  2470    15   193   965   334]
 [    0  2005   331   438     0     0     0     0]
 [  436   206     0 11377    13     0     0     0]
 [  279    39     0     0 19067  1089     0     0]
 [    3    46     0    26  2348  6089   668     0]
 [  423    17     0    94  4526    92 16007   651]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.81      0.86     29840
     Walking       0.89      0.80      0.85     26143
         Run       1.00      0.12      0.21      2774
        Bike       0.79      0.95      0.86     12032
         Car       0.72      0.93      0.81     20474
         Bus       0.76      0.66      0.71      9180
       Train       0.49      0.73      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.81      0.69      0.69    143960
weighted avg       0.80      0.76      0.75    143960

tree_model.pred_mean_xgb
[[24739   406     0    94   921    45  3532   103]
 [ 1308 20688     0  2833    16    34   957   307]
 [    0  1529   485   712     0    48     0     0]
 [  415   214     0 11403     0     0     0     0]
 [  387    57     0     0 18450  1580     0     0]
 [   27    45     0    54  3073  5627   354     0]
 [  602     2     0    76  4324    56 15809   941]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.83      0.86     29840
     Walking       0.90      0.79      0.84     26143
         Run       1.00      0.17      0.30      2774
        Bike       0.75      0.95      0.84     12032
         Car       0.69      0.90      0.78     20474
         Bus       0.76      0.61      0.68      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.68      0.69    143960
weighted avg       0.79      0.75      0.75    143960

tree_model.pred_mv
[[24819   184     0   110   820   166  3557   184]
 [ 1610 20181     0  3145     1   138   839   229]
 [    0  1856   377   541     0     0     0     0]
 [  570   279     0 10944   215    24     0     0]
 [  902    36     0     0 17979  1557     0     0]
 [  242     4     0   110  2784  5653   387     0]
 [  595     2     0   108  3900   427 15911   867]
 [   17     1     0     0     0     0 11099 10590]]
              precision    recall  f1-score   support

       Still       0.86      0.83      0.85     29840
     Walking       0.90      0.77      0.83     26143
         Run       1.00      0.14      0.24      2774
        Bike       0.73      0.91      0.81     12032
         Car       0.70      0.88      0.78     20474
         Bus       0.71      0.62      0.66      9180
       Train       0.50      0.73      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.67      0.67    143960
weighted avg       0.78      0.74      0.74    143960

test over
training set:Bag,the 1th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 190.7
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.481336 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47630
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.079651
[LightGBM] [Info] Start training from score -2.076626
[LightGBM] [Info] Start training from score -3.144839
[LightGBM] [Info] Start training from score -2.125476
[LightGBM] [Info] Start training from score -1.820765
[LightGBM] [Info] Start training from score -1.933653
[LightGBM] [Info] Start training from score -1.837559
[LightGBM] [Info] Start training from score -2.107862
[1]	valid_0's multi_logloss: 1.45827
[2]	valid_0's multi_logloss: 1.17176
[3]	valid_0's multi_logloss: 0.970386
[4]	valid_0's multi_logloss: 0.817074
[5]	valid_0's multi_logloss: 0.695063
[6]	valid_0's multi_logloss: 0.597056
[7]	valid_0's multi_logloss: 0.516817
[8]	valid_0's multi_logloss: 0.450554
[9]	valid_0's multi_logloss: 0.394646
[10]	valid_0's multi_logloss: 0.347619
[11]	valid_0's multi_logloss: 0.307804
[12]	valid_0's multi_logloss: 0.273457
[13]	valid_0's multi_logloss: 0.243599
[14]	valid_0's multi_logloss: 0.218482
[15]	valid_0's multi_logloss: 0.196807
[16]	valid_0's multi_logloss: 0.17767
[17]	valid_0's multi_logloss: 0.16107
[18]	valid_0's multi_logloss: 0.146798
[19]	valid_0's multi_logloss: 0.133771
[20]	valid_0's multi_logloss: 0.122833
[21]	valid_0's multi_logloss: 0.113092
[22]	valid_0's multi_logloss: 0.10434
[23]	valid_0's multi_logloss: 0.096512
[24]	valid_0's multi_logloss: 0.0900527
[25]	valid_0's multi_logloss: 0.0839492
[26]	valid_0's multi_logloss: 0.0785119
[27]	valid_0's multi_logloss: 0.0735636
[28]	valid_0's multi_logloss: 0.0693304
[29]	valid_0's multi_logloss: 0.0653133
[30]	valid_0's multi_logloss: 0.062174
[31]	valid_0's multi_logloss: 0.0590298
[32]	valid_0's multi_logloss: 0.0561115
[33]	valid_0's multi_logloss: 0.0536124
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[34]	valid_0's multi_logloss: 0.0511942
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[35]	valid_0's multi_logloss: 0.0490212
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[36]	valid_0's multi_logloss: 0.0466208
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.0446126
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0424749
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[39]	valid_0's multi_logloss: 0.0409489
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[40]	valid_0's multi_logloss: 0.039248
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0375169
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0359475
[43]	valid_0's multi_logloss: 0.0345937
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.0332954
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0322051
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0311661
[47]	valid_0's multi_logloss: 0.0299206
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0289599
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.028053
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0271028
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0261401
[52]	valid_0's multi_logloss: 0.0252262
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0243934
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0235718
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0228967
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0221637
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0215751
[58]	valid_0's multi_logloss: 0.0208742
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0203371
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0197836
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0192644
[62]	valid_0's multi_logloss: 0.0186947
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0181455
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.017542
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0171475
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0167298
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0162701
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.01587
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0154715
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0150959
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0146758
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0142971
[73]	valid_0's multi_logloss: 0.0139238
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0136254
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0132623
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0128963
[77]	valid_0's multi_logloss: 0.0126331
[78]	valid_0's multi_logloss: 0.0123599
[79]	valid_0's multi_logloss: 0.0120121
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0117031
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0114528
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0111791
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.0109083
[84]	valid_0's multi_logloss: 0.0106148
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0104379
[86]	valid_0's multi_logloss: 0.0102633
[87]	valid_0's multi_logloss: 0.00998397
[88]	valid_0's multi_logloss: 0.00973994
[89]	valid_0's multi_logloss: 0.00952887
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.00931569
[91]	valid_0's multi_logloss: 0.00912885
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[92]	valid_0's multi_logloss: 0.00892902
[93]	valid_0's multi_logloss: 0.00875693
[94]	valid_0's multi_logloss: 0.00857165
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.00842541
[96]	valid_0's multi_logloss: 0.00826085
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.00808596
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.00794485
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.00780422
[100]	valid_0's multi_logloss: 0.00764742
Time elapsed for training LightGBM: 106.78
Training XGBoost...
Time elapsed for training XGBoost: 365.11
begin testing
training set : Bag ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.04
predict lgb
Time elapsed for testing lgb: 1.09
predict xgb
Time elapsed for testing xgb: 2.54
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Bag ; testing set : Torso  testing result
tree_model.pred_mean
[[22532   970     0    35   136  2278  3728   161]
 [  771 24581     8   164    32   287   199   101]
 [    0  1880   894     0     0     0     0     0]
 [  345  3935     0  4913  2443   276   120     0]
 [  318   215     0     0  8841  5551  5549     0]
 [   90    42     0     0     0  8610   438     0]
 [ 1928   102     0     3  1039  2405 15773   560]
 [    0     3     0     0     0     0 11099 10605]]
              precision    recall  f1-score   support

       Still       0.87      0.76      0.81     29840
     Walking       0.77      0.94      0.85     26143
         Run       0.99      0.32      0.49      2774
        Bike       0.96      0.41      0.57     12032
         Car       0.71      0.43      0.54     20474
         Bus       0.44      0.94      0.60      9180
       Train       0.43      0.72      0.54     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.76      0.63      0.63    143960
weighted avg       0.75      0.67      0.67    143960

tree_model.pred_mean_rf
[[14610   559     0   134   786  5245  7083  1423]
 [  299 24106     9   525   349   487   246   122]
 [    0  1795   902    77     0     0     0     0]
 [    0   959     0  7718  3168   187     0     0]
 [   27   149     0     0 10603  5213  4307   175]
 [  402    71     0     5    19  8412   271     0]
 [ 1235    42     0    42   430  3308 15617  1136]
 [    0     7     0     0     0     0 11099 10601]]
              precision    recall  f1-score   support

       Still       0.88      0.49      0.63     29840
     Walking       0.87      0.92      0.90     26143
         Run       0.99      0.33      0.49      2774
        Bike       0.91      0.64      0.75     12032
         Car       0.69      0.52      0.59     20474
         Bus       0.37      0.92      0.53      9180
       Train       0.40      0.72      0.52     21810
      Subway       0.79      0.49      0.60     21707

    accuracy                           0.64    143960
   macro avg       0.74      0.63      0.63    143960
weighted avg       0.74      0.64      0.65    143960

tree_model.pred_mean_lightgbm
[[21030  2206     0     0   192  1612  4586   214]
 [  664 24838     7    62     0   207   271    94]
 [    0  1884   890     0     0     0     0     0]
 [  185  5618     0  3490  2322   289   128     0]
 [   97   139     0     0  4874  5363 10001     0]
 [   25    28     0     0     0  8679   448     0]
 [ 1419   115     0     0  1418  2536 16322     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.70      0.79     29840
     Walking       0.71      0.95      0.81     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.98      0.29      0.45     12032
         Car       0.55      0.24      0.33     20474
         Bus       0.46      0.95      0.62      9180
       Train       0.38      0.75      0.50     21810
      Subway       0.97      0.49      0.65     21707

    accuracy                           0.63    143960
   macro avg       0.74      0.59      0.58    143960
weighted avg       0.73      0.63      0.62    143960

tree_model.pred_mean_xgb
[[24588   893     0    38    70  1719  2403   129]
 [ 1177 24121     7   134    26   360   220    98]
 [    0  1886   888     0     0     0     0     0]
 [  570  3625     0  5504  1990   270    73     0]
 [  571   283     0     0 11681  6696  1243     0]
 [  253    41     0     0     0  8438   448     0]
 [ 2684   120     0     1   621  2035 15550   799]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.82      0.82      0.82     29840
     Walking       0.78      0.92      0.84     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.97      0.46      0.62     12032
         Car       0.81      0.57      0.67     20474
         Bus       0.43      0.92      0.59      9180
       Train       0.50      0.71      0.59     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.70    143960
   macro avg       0.78      0.65      0.66    143960
weighted avg       0.77      0.70      0.70    143960

tree_model.pred_mv
[[22917   564     0    41   116  1908  4075   219]
 [ 1288 23762    33   243    80   430   255    52]
 [    0  1885   889     0     0     0     0     0]
 [  579  3599     0  5147  2284   302   121     0]
 [  440   253     0    41 10799  5328  3613     0]
 [  490    28     0   115     0  8116   431     0]
 [ 1868    82     0    51   870  2537 15555   847]
 [    0     2     0     0     0     0 11099 10606]]
              precision    recall  f1-score   support

       Still       0.83      0.77      0.80     29840
     Walking       0.79      0.91      0.84     26143
         Run       0.96      0.32      0.48      2774
        Bike       0.91      0.43      0.58     12032
         Car       0.76      0.53      0.62     20474
         Bus       0.44      0.88      0.58      9180
       Train       0.44      0.71      0.55     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.68    143960
   macro avg       0.76      0.63      0.64    143960
weighted avg       0.75      0.68      0.68    143960

test over
training set : Bag ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.13
predict lgb
Time elapsed for testing lgb: 1.39
predict xgb
Time elapsed for testing xgb: 2.85
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Bag ; testing set : Bag  testing result
tree_model.pred_mean
[[26591   714     0    47   180   193  1294   821]
 [  743 24430     8   581    74    71   129   107]
 [    0  1124  1650     0     0     0     0     0]
 [   72  2861     0  8702   294   103     0     0]
 [  329    97     0     0 18083  1777   188     0]
 [    6    80     0     2  2001  6548   543     0]
 [  609    81     0    58  2299   748 17184   831]
 [    0     3     0     0     0     0  2290 19414]]
              precision    recall  f1-score   support

       Still       0.94      0.89      0.91     29840
     Walking       0.83      0.93      0.88     26143
         Run       1.00      0.59      0.74      2774
        Bike       0.93      0.72      0.81     12032
         Car       0.79      0.88      0.83     20474
         Bus       0.69      0.71      0.70      9180
       Train       0.79      0.79      0.79     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.85    143960
   macro avg       0.86      0.80      0.82    143960
weighted avg       0.86      0.85      0.85    143960

tree_model.pred_mean_rf
[[23705   598     0   101   778   746  2561  1351]
 [  175 23753     5  1212   532   292    29   145]
 [    0  1517  1257     0     0     0     0     0]
 [   29   699     0  8662  2369   273     0     0]
 [  159    71     0     0 16990  2968   229    57]
 [    0    48     0    79  1770  6811   472     0]
 [  219    56     0    89  2126   807 17409  1104]
 [    0     6     0     0     0     0  2308 19393]]
              precision    recall  f1-score   support

       Still       0.98      0.79      0.88     29840
     Walking       0.89      0.91      0.90     26143
         Run       1.00      0.45      0.62      2774
        Bike       0.85      0.72      0.78     12032
         Car       0.69      0.83      0.75     20474
         Bus       0.57      0.74      0.65      9180
       Train       0.76      0.80      0.78     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.82    143960
   macro avg       0.83      0.77      0.78    143960
weighted avg       0.84      0.82      0.82    143960

tree_model.pred_mean_lightgbm
[[25669   816     0    31   523   372  2275   154]
 [  518 24779    10   444    78    50   157   107]
 [    0  1103  1671     0     0     0     0     0]
 [   52  3465     0  7930   296   289     0     0]
 [   98    99     0     0 18651  1341   285     0]
 [    0    71     0     0  2233  6319   557     0]
 [  735   111     0    47  3017   746 16900   254]
 [    0     0     0     0     0     0  2282 19425]]
              precision    recall  f1-score   support

       Still       0.95      0.86      0.90     29840
     Walking       0.81      0.95      0.88     26143
         Run       0.99      0.60      0.75      2774
        Bike       0.94      0.66      0.77     12032
         Car       0.75      0.91      0.82     20474
         Bus       0.69      0.69      0.69      9180
       Train       0.75      0.77      0.76     21810
      Subway       0.97      0.89      0.93     21707

    accuracy                           0.84    143960
   macro avg       0.86      0.79      0.81    143960
weighted avg       0.85      0.84      0.84    143960

tree_model.pred_mean_xgb
[[27556   619     0    35     9    90   910   621]
 [ 1007 24167     8   535    79    52   205    90]
 [    0   996  1778     0     0     0     0     0]
 [  158  2928     0  8670   171   105     0     0]
 [  548    75     0     0 17936  1787   128     0]
 [   13    78     0    10  2154  6378   547     0]
 [  725    65     0    66  2138   729 17214   873]
 [    0     5     0     0     0     0  2284 19418]]
              precision    recall  f1-score   support

       Still       0.92      0.92      0.92     29840
     Walking       0.84      0.92      0.88     26143
         Run       1.00      0.64      0.78      2774
        Bike       0.93      0.72      0.81     12032
         Car       0.80      0.88      0.83     20474
         Bus       0.70      0.69      0.70      9180
       Train       0.81      0.79      0.80     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.86    143960
   macro avg       0.86      0.81      0.83    143960
weighted avg       0.86      0.86      0.85    143960

tree_model.pred_mv
[[26722   588     0   124   228   389  1184   605]
 [ 1252 23733    20   740    79   124   151    44]
 [    0  1065  1709     0     0     0     0     0]
 [  265  2787     0  8143   637   200     0     0]
 [  509    48     0     0 17685  1907   325     0]
 [   11    43     0   182  2043  6431   470     0]
 [  757    48     0    81  2321   769 16906   928]
 [    0     7     0     0     0     0  2282 19418]]
              precision    recall  f1-score   support

       Still       0.91      0.90      0.90     29840
     Walking       0.84      0.91      0.87     26143
         Run       0.99      0.62      0.76      2774
        Bike       0.88      0.68      0.76     12032
         Car       0.77      0.86      0.81     20474
         Bus       0.65      0.70      0.68      9180
       Train       0.79      0.78      0.78     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.84    143960
   macro avg       0.84      0.79      0.81    143960
weighted avg       0.84      0.84      0.84    143960

test over
training set : Bag ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.08
predict lgb
Time elapsed for testing lgb: 1.39
predict xgb
Time elapsed for testing xgb: 2.94
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Bag ; testing set : Hand  testing result
tree_model.pred_mean
[[25122  1635     0   416   126   869   727   945]
 [  695 23784    11  1170     0    49   161   273]
 [    0   979  1795     0     0     0     0     0]
 [   42   837     0 11005    97    51     0     0]
 [  465   740     0  1337 15555  2110   267     0]
 [    0     0     0   218  3239  5723     0     0]
 [  755   124     0   217  2477   170 17520   547]
 [    0     0     0     0     0     0  2269 19438]]
              precision    recall  f1-score   support

       Still       0.93      0.84      0.88     29840
     Walking       0.85      0.91      0.88     26143
         Run       0.99      0.65      0.78      2774
        Bike       0.77      0.91      0.83     12032
         Car       0.72      0.76      0.74     20474
         Bus       0.64      0.62      0.63      9180
       Train       0.84      0.80      0.82     21810
      Subway       0.92      0.90      0.91     21707

    accuracy                           0.83    143960
   macro avg       0.83      0.80      0.81    143960
weighted avg       0.84      0.83      0.83    143960

tree_model.pred_mean_rf
[[17038  1526     0   996  2474  5148  1626  1032]
 [  152 23514    16  2041    27   171    35   187]
 [    0   653  2121     0     0     0     0     0]
 [    0   130     0 11884    18     0     0     0]
 [  262   267     0  5187  8532  4000  2226     0]
 [    0    11     0   684  1277  7208     0     0]
 [  388   118     0   598  2299   479 16722  1206]
 [    0    11     0     0     0     0   120 21576]]
              precision    recall  f1-score   support

       Still       0.96      0.57      0.71     29840
     Walking       0.90      0.90      0.90     26143
         Run       0.99      0.76      0.86      2774
        Bike       0.56      0.99      0.71     12032
         Car       0.58      0.42      0.49     20474
         Bus       0.42      0.79      0.55      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.90      0.99      0.94     21707

    accuracy                           0.75    143960
   macro avg       0.76      0.77      0.74    143960
weighted avg       0.79      0.75      0.75    143960

tree_model.pred_mean_lightgbm
[[25507  1911     0   362   165   715   975   205]
 [  812 23737    15   856     1    93   203   426]
 [    0  1010  1764     0     0     0     0     0]
 [  406  3074     0  7835   215   222   280     0]
 [  370   907     0   599 16530  1928   140     0]
 [    5     9     0   140  3261  5765     0     0]
 [  769   217     0   115  3628   203 16855    23]
 [    0     0     0     0     0     0  2274 19433]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.77      0.91      0.83     26143
         Run       0.99      0.64      0.77      2774
        Bike       0.79      0.65      0.71     12032
         Car       0.69      0.81      0.75     20474
         Bus       0.65      0.63      0.64      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.97      0.90      0.93     21707

    accuracy                           0.82    143960
   macro avg       0.82      0.77      0.79    143960
weighted avg       0.82      0.82      0.82    143960

tree_model.pred_mean_xgb
[[25468  1240     0   609   121   809   664   929]
 [  989 23499     4  1089     0    66   357   139]
 [    0  1124  1650     0     0     0     0     0]
 [   69   482     0 11372   109     0     0     0]
 [  578   720     0  1202 15552  2215   207     0]
 [    5     0     0   206  3300  5489   180     0]
 [  877   113     0   602  2110   127 16937  1044]
 [    0    20     0     0     0     0  2265 19422]]
              precision    recall  f1-score   support

       Still       0.91      0.85      0.88     29840
     Walking       0.86      0.90      0.88     26143
         Run       1.00      0.59      0.75      2774
        Bike       0.75      0.95      0.84     12032
         Car       0.73      0.76      0.75     20474
         Bus       0.63      0.60      0.61      9180
       Train       0.82      0.78      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    143960
   macro avg       0.83      0.79      0.80    143960
weighted avg       0.83      0.83      0.83    143960

tree_model.pred_mv
[[24049  1838     0   864   111  1222   791   965]
 [ 1100 22939     0  1731     0    80   186   107]
 [    0   908  1773    93     0     0     0     0]
 [  202   887     0 10719   191    33     0     0]
 [  730   744     0  1751 14441  2080   728     0]
 [   21     0     0   593  2747  5684   135     0]
 [  938   253     0   544  2286   201 16567  1021]
 [   22    18     0     0     0     0  2273 19394]]
              precision    recall  f1-score   support

       Still       0.89      0.81      0.85     29840
     Walking       0.83      0.88      0.85     26143
         Run       1.00      0.64      0.78      2774
        Bike       0.66      0.89      0.76     12032
         Car       0.73      0.71      0.72     20474
         Bus       0.61      0.62      0.62      9180
       Train       0.80      0.76      0.78     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.80    143960
   macro avg       0.80      0.77      0.78    143960
weighted avg       0.81      0.80      0.80    143960

test over
training set : Bag ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.03
predict lgb
Time elapsed for testing lgb: 1.33
predict xgb
Time elapsed for testing xgb: 2.7
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Bag ; testing set : Hips  testing result
tree_model.pred_mean
[[23182  2221     0    42   141   578  3563   113]
 [  547 24217     0   329     0    87   609   354]
 [    0   932  1842     0     0     0     0     0]
 [   81  6398     0  5553     0     0     0     0]
 [  716   142     0     0  9232  3663  6721     0]
 [   37    23     0    20  1050  7378   672     0]
 [  805   101     0     0  1654  1021 17468   761]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.78      0.84     29840
     Walking       0.71      0.93      0.80     26143
         Run       1.00      0.66      0.80      2774
        Bike       0.93      0.46      0.62     12032
         Car       0.76      0.45      0.57     20474
         Bus       0.58      0.80      0.67      9180
       Train       0.44      0.80      0.56     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.69    143960
   macro avg       0.78      0.67      0.69    143960
weighted avg       0.76      0.69      0.69    143960

tree_model.pred_mean_rf
[[22553  1607     0   646   429   549  3649   407]
 [  265 24267     0   651     0   315   425   220]
 [    0   503  1845   426     0     0     0     0]
 [   24  3254     0  8754     0     0     0     0]
 [  564   117     0     0  5993  4757  8879   164]
 [   74    40     0    43   442  8065   516     0]
 [  176    62     0    67   625  1621 18117  1142]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.95      0.76      0.84     29840
     Walking       0.81      0.93      0.87     26143
         Run       1.00      0.67      0.80      2774
        Bike       0.83      0.73      0.77     12032
         Car       0.80      0.29      0.43     20474
         Bus       0.53      0.88      0.66      9180
       Train       0.42      0.83      0.56     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.70    143960
   macro avg       0.77      0.70      0.69    143960
weighted avg       0.77      0.70      0.69    143960

tree_model.pred_mean_lightgbm
[[22076  2543     0     0   162  1148  3799   112]
 [  395 24370     0    15     0    70   766   527]
 [    0   938  1836     0     0     0     0     0]
 [  108  8216     0  3659    49     0     0     0]
 [  317   141     0     0  9415  3331  7270     0]
 [   16    19     0     0  1884  6491   770     0]
 [  738   105     0     0  1874   983 18072    38]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.74      0.83     29840
     Walking       0.67      0.93      0.78     26143
         Run       1.00      0.66      0.80      2774
        Bike       1.00      0.30      0.47     12032
         Car       0.70      0.46      0.56     20474
         Bus       0.54      0.71      0.61      9180
       Train       0.43      0.83      0.57     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.78      0.64      0.66    143960
weighted avg       0.76      0.67      0.67    143960

tree_model.pred_mean_xgb
[[23326  2061     0    59   182   540  3568   104]
 [  829 23570   214   558     0   114   694   164]
 [    0   926  1848     0     0     0     0     0]
 [  129  6773     0  5130     0     0     0     0]
 [ 1413   113     0     0 12707  4303  1938     0]
 [   53    15     0    36   812  7605   659     0]
 [ 1037    68     0     0  1472   918 17477   838]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.78      0.82     29840
     Walking       0.70      0.90      0.79     26143
         Run       0.90      0.67      0.76      2774
        Bike       0.89      0.43      0.58     12032
         Car       0.84      0.62      0.71     20474
         Bus       0.56      0.83      0.67      9180
       Train       0.49      0.80      0.61     21810
      Subway       0.91      0.49      0.63     21707

    accuracy                           0.71    143960
   macro avg       0.77      0.69      0.70    143960
weighted avg       0.77      0.71      0.71    143960

tree_model.pred_mv
[[23021  1929     0   127   239   833  3573   118]
 [ 1122 23308    45   655     0   291   585   137]
 [    0   858  1828    88     0     0     0     0]
 [  261  6083     0  5308   212    84    84     0]
 [ 1150    67     0    15 10329  3887  5026     0]
 [  182    33     0    82   932  7234   717     0]
 [ 1022    73     0    32  1419   972 17540   752]
 [   28     1     0     0     0     0 11099 10579]]
              precision    recall  f1-score   support

       Still       0.86      0.77      0.81     29840
     Walking       0.72      0.89      0.80     26143
         Run       0.98      0.66      0.79      2774
        Bike       0.84      0.44      0.58     12032
         Car       0.79      0.50      0.61     20474
         Bus       0.54      0.79      0.64      9180
       Train       0.45      0.80      0.58     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.69    143960
   macro avg       0.76      0.67      0.68    143960
weighted avg       0.75      0.69      0.69    143960

test over
training set:Hand,the 2th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 192.18
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.577110 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47276
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.081877
[LightGBM] [Info] Start training from score -2.077592
[LightGBM] [Info] Start training from score -3.142385
[LightGBM] [Info] Start training from score -2.121724
[LightGBM] [Info] Start training from score -1.820112
[LightGBM] [Info] Start training from score -1.936743
[LightGBM] [Info] Start training from score -1.835639
[LightGBM] [Info] Start training from score -2.108860
[1]	valid_0's multi_logloss: 1.48454
[2]	valid_0's multi_logloss: 1.20426
[3]	valid_0's multi_logloss: 1.00667
[4]	valid_0's multi_logloss: 0.856764
[5]	valid_0's multi_logloss: 0.739219
[6]	valid_0's multi_logloss: 0.644089
[7]	valid_0's multi_logloss: 0.565861
[8]	valid_0's multi_logloss: 0.501138
[9]	valid_0's multi_logloss: 0.44737
[10]	valid_0's multi_logloss: 0.400658
[11]	valid_0's multi_logloss: 0.361211
[12]	valid_0's multi_logloss: 0.327524
[13]	valid_0's multi_logloss: 0.298136
[14]	valid_0's multi_logloss: 0.272801
[15]	valid_0's multi_logloss: 0.249829
[16]	valid_0's multi_logloss: 0.229483
[17]	valid_0's multi_logloss: 0.212344
[18]	valid_0's multi_logloss: 0.19759
[19]	valid_0's multi_logloss: 0.184051
[20]	valid_0's multi_logloss: 0.172299
[21]	valid_0's multi_logloss: 0.161627
[22]	valid_0's multi_logloss: 0.152462
[23]	valid_0's multi_logloss: 0.144173
[24]	valid_0's multi_logloss: 0.136901
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[25]	valid_0's multi_logloss: 0.130499
[26]	valid_0's multi_logloss: 0.12439
[27]	valid_0's multi_logloss: 0.118978
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[28]	valid_0's multi_logloss: 0.114205
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[29]	valid_0's multi_logloss: 0.10971
[30]	valid_0's multi_logloss: 0.10524
[31]	valid_0's multi_logloss: 0.101239
[32]	valid_0's multi_logloss: 0.0977588
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[33]	valid_0's multi_logloss: 0.0941507
[34]	valid_0's multi_logloss: 0.0906429
[35]	valid_0's multi_logloss: 0.0874385
[36]	valid_0's multi_logloss: 0.0845583
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.0817934
[38]	valid_0's multi_logloss: 0.0793941
[39]	valid_0's multi_logloss: 0.0770331
[40]	valid_0's multi_logloss: 0.0748361
[41]	valid_0's multi_logloss: 0.0726498
[42]	valid_0's multi_logloss: 0.0705099
[43]	valid_0's multi_logloss: 0.0686248
[44]	valid_0's multi_logloss: 0.0668361
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0651203
[46]	valid_0's multi_logloss: 0.063393
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0616404
[48]	valid_0's multi_logloss: 0.0596775
[49]	valid_0's multi_logloss: 0.0582633
[50]	valid_0's multi_logloss: 0.0565381
[51]	valid_0's multi_logloss: 0.0551853
[52]	valid_0's multi_logloss: 0.0537992
[53]	valid_0's multi_logloss: 0.0522174
[54]	valid_0's multi_logloss: 0.0510594
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0499504
[56]	valid_0's multi_logloss: 0.0488712
[57]	valid_0's multi_logloss: 0.047567
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0465293
[59]	valid_0's multi_logloss: 0.045552
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0446476
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0437985
[62]	valid_0's multi_logloss: 0.042845
[63]	valid_0's multi_logloss: 0.0419587
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0412688
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0404813
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0397884
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0390298
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0382337
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0373068
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0365633
[71]	valid_0's multi_logloss: 0.0358383
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0351345
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0343903
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0337676
[75]	valid_0's multi_logloss: 0.0332543
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0325732
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0320622
[78]	valid_0's multi_logloss: 0.0315583
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0310535
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.030572
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0300259
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0295373
[83]	valid_0's multi_logloss: 0.0290635
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0286559
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0280887
[86]	valid_0's multi_logloss: 0.0276327
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.027266
[88]	valid_0's multi_logloss: 0.0267524
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[89]	valid_0's multi_logloss: 0.0262975
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.0257728
[91]	valid_0's multi_logloss: 0.0253944
[92]	valid_0's multi_logloss: 0.0249426
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.024646
[94]	valid_0's multi_logloss: 0.024321
[95]	valid_0's multi_logloss: 0.0237388
[96]	valid_0's multi_logloss: 0.0234484
[97]	valid_0's multi_logloss: 0.0230285
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.0227481
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0224096
[100]	valid_0's multi_logloss: 0.0219633
Time elapsed for training LightGBM: 107.3
Training XGBoost...
Time elapsed for training XGBoost: 426.54
begin testing
training set : Hand ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.13
predict lgb
Time elapsed for testing lgb: 1.29
predict xgb
Time elapsed for testing xgb: 2.95
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hand ; testing set : Torso  testing result
tree_model.pred_mean
[[26124    75     0     0   490   557  2262   332]
 [ 2699 19021     8   192   521  2826   453   423]
 [    0  1891   883     0     0     0     0     0]
 [ 1794   514     0   942  8059   723     0     0]
 [  485    26     0     0 15484  4139   340     0]
 [  285     3     0     0   593  8046   253     0]
 [ 2360    13     0     0  1212  2249 15899    77]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.77      0.88      0.82     29840
     Walking       0.88      0.73      0.80     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.83      0.08      0.14     12032
         Car       0.59      0.76      0.66     20474
         Bus       0.43      0.88      0.58      9180
       Train       0.52      0.73      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.74      0.61      0.59    143960
weighted avg       0.74      0.67      0.66    143960

tree_model.pred_mean_rf
[[26733     3     0     0   161   754  1950   239]
 [ 4900 16039     0   298   949  2840   491   626]
 [    0  1860     0   914     0     0     0     0]
 [ 1061   166     0   209  9198  1398     0     0]
 [  690     2     0     0 13891  4127  1764     0]
 [ 1350     0     0     0   301  7529     0     0]
 [ 3921     0     0     0     4  1196 15604  1085]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.69      0.90      0.78     29840
     Walking       0.89      0.61      0.73     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.15      0.02      0.03     12032
         Car       0.57      0.68      0.62     20474
         Bus       0.42      0.82      0.56      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.84      0.49      0.62     21707

    accuracy                           0.63    143960
   macro avg       0.51      0.53      0.49    143960
weighted avg       0.63      0.63      0.60    143960

tree_model.pred_mean_lightgbm
[[24628   140     0     0  1051  1045  2608   368]
 [ 2175 19982    15   154   679  2343   415   380]
 [    0  1882   892     0     0     0     0     0]
 [ 1512   523     0  2086  7361   550     0     0]
 [  426    43     0     0 16212  3466   327     0]
 [  105     3     0     0   586  8038   448     0]
 [ 1624    30     0     0  1517  2549 16074    16]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.81      0.83      0.82     29840
     Walking       0.88      0.76      0.82     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.93      0.17      0.29     12032
         Car       0.59      0.79      0.68     20474
         Bus       0.45      0.88      0.59      9180
       Train       0.52      0.74      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.68    143960
   macro avg       0.76      0.62      0.62    143960
weighted avg       0.76      0.68      0.67    143960

tree_model.pred_mean_xgb
[[26767    87     0     0   586   252  2013   135]
 [ 3284 18592    12   207   348  2872   489   339]
 [    0  1886   888     0     0     0     0     0]
 [ 3374   474     0   628  7187   369     0     0]
 [  592    24     0     0 15189  4446   223     0]
 [  229     9     0     0   929  7882   131     0]
 [ 3169    20     0     0  1164  1643 15814     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.72      0.90      0.80     29840
     Walking       0.88      0.71      0.79     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.75      0.05      0.10     12032
         Car       0.60      0.74      0.66     20474
         Bus       0.45      0.86      0.59      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.67    143960
   macro avg       0.73      0.60      0.58    143960
weighted avg       0.73      0.67      0.65    143960

tree_model.pred_mv
[[26602    16     0     0   365   587  2058   212]
 [ 3412 18175    10   441   535  2818   400   352]
 [    0  1875   879     6     0    14     0     0]
 [ 2514   525     0   952  7470   571     0     0]
 [  587     6     0     0 15484  3894   503     0]
 [  776     3     0    13   637  7595   156     0]
 [ 2920     2     0     0  1004  1808 15969   107]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.72      0.89      0.80     29840
     Walking       0.88      0.70      0.78     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.67      0.08      0.14     12032
         Car       0.61      0.76      0.67     20474
         Bus       0.44      0.83      0.57      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.72      0.60      0.59    143960
weighted avg       0.72      0.67      0.65    143960

test over
training set : Hand ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.98
predict lgb
Time elapsed for testing lgb: 1.42
predict xgb
Time elapsed for testing xgb: 2.53
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hand ; testing set : Bag  testing result
tree_model.pred_mean
[[25446    64     0     0  1282   947  1037  1064]
 [ 2271 21185     0   335  1046   562   352   392]
 [    0   909   743  1122     0     0     0     0]
 [ 1776   286     0     0  8765  1201     4     0]
 [  581     3     0     3 18436  1372    79     0]
 [    0     0     0     0  2396  6573   211     0]
 [  836    20     0     0  3236   835 16764   119]
 [    0     0     0     0     0     0  2301 19406]]
              precision    recall  f1-score   support

       Still       0.82      0.85      0.84     29840
     Walking       0.94      0.81      0.87     26143
         Run       1.00      0.27      0.42      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.52      0.90      0.66     20474
         Bus       0.57      0.72      0.64      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.75    143960
   macro avg       0.70      0.65      0.64    143960
weighted avg       0.73      0.75      0.73    143960

tree_model.pred_mean_rf
[[27507    11     0     0   264   150   920   988]
 [ 2685 20051     0   277  1250   952   341   587]
 [    0  1269     0  1505     0     0     0     0]
 [ 1326   115     0     0  8465  2126     0     0]
 [  442     0     0     0 17691  2251    55    35]
 [   33     0     0     0  1466  7571   110     0]
 [ 1440     0     0     0  1690   761 16997   922]
 [    0     0     0     0     0     0  2326 19381]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.93      0.77      0.84     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.57      0.86      0.69     20474
         Bus       0.55      0.82      0.66      9180
       Train       0.82      0.78      0.80     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    143960
   macro avg       0.57      0.63      0.59    143960
weighted avg       0.71      0.76      0.73    143960

tree_model.pred_mean_lightgbm
[[23275   131     0    35  2505  1349  1358  1187]
 [ 1840 21741     5   235  1136   426   393   367]
 [    0   395   861  1518     0     0     0     0]
 [ 1719   299     0   181  8512  1321     0     0]
 [  539     0     0     0 18236  1609    90     0]
 [    0     0     0     0  2389  6400   391     0]
 [  710    47     0     0  3377   816 16841    19]
 [    0     3     0     0     0     0  2291 19413]]
              precision    recall  f1-score   support

       Still       0.83      0.78      0.80     29840
     Walking       0.96      0.83      0.89     26143
         Run       0.99      0.31      0.47      2774
        Bike       0.09      0.02      0.03     12032
         Car       0.50      0.89      0.64     20474
         Bus       0.54      0.70      0.61      9180
       Train       0.79      0.77      0.78     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.74    143960
   macro avg       0.70      0.65      0.64    143960
weighted avg       0.74      0.74      0.73    143960

tree_model.pred_mean_xgb
[[25884   106     0    30  1145   737  1210   728]
 [ 2928 20659     0   525   849   504   333   345]
 [    0  1003   831   940     0     0     0     0]
 [ 2784   296     0     0  7933  1000    19     0]
 [  639     0     0    19 18736  1080     0     0]
 [    0     1     0     0  2604  6401   174     0]
 [  883    48     0     0  3511   817 16471    80]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.78      0.87      0.82     29840
     Walking       0.93      0.79      0.86     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.54      0.92      0.68     20474
         Bus       0.61      0.70      0.65      9180
       Train       0.80      0.76      0.78     21810
      Subway       0.94      0.89      0.92     21707

    accuracy                           0.75    143960
   macro avg       0.70      0.65      0.65    143960
weighted avg       0.73      0.75      0.73    143960

tree_model.pred_mv
[[25815    43     0    45  1243   771   972   951]
 [ 2830 20332     6   574  1029   662   353   357]
 [    1   873   805  1087     0     8     0     0]
 [ 2130   397     0   182  7933  1330    60     0]
 [  729    26     0     0 18295  1344    80     0]
 [   22    16     0     8  2573  6378   183     0]
 [  917    41     0     0  2997   835 16806   214]
 [    0     1     0     0     0     5  2285 19416]]
              precision    recall  f1-score   support

       Still       0.80      0.87      0.83     29840
     Walking       0.94      0.78      0.85     26143
         Run       0.99      0.29      0.45      2774
        Bike       0.10      0.02      0.03     12032
         Car       0.54      0.89      0.67     20474
         Bus       0.56      0.69      0.62      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.75    143960
   macro avg       0.71      0.65      0.64    143960
weighted avg       0.74      0.75      0.73    143960

test over
training set : Hand ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.02
predict lgb
Time elapsed for testing lgb: 1.3
predict xgb
Time elapsed for testing xgb: 2.83
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hand ; testing set : Hand  testing result
tree_model.pred_mean
[[27116   211     0     0   633   683   168  1029]
 [ 2642 21546     1   339   628   417   191   379]
 [    0  1053  1721     0     0     0     0     0]
 [ 2933    88     0  2842  6065   104     0     0]
 [  554   123     0     0 17809  1988     0     0]
 [   11    14     0     0  2557  6418   180     0]
 [  978    70     0    34  3584   148 16839   157]
 [    0     0     0     0     0     0  2289 19418]]
              precision    recall  f1-score   support

       Still       0.79      0.91      0.85     29840
     Walking       0.93      0.82      0.88     26143
         Run       1.00      0.62      0.77      2774
        Bike       0.88      0.24      0.37     12032
         Car       0.57      0.87      0.69     20474
         Bus       0.66      0.70      0.68      9180
       Train       0.86      0.77      0.81     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.79    143960
   macro avg       0.83      0.73      0.74    143960
weighted avg       0.82      0.79      0.78    143960

tree_model.pred_mean_rf
[[27022   255     0     0   477   916   133  1037]
 [ 2257 21979     5   462   716   297   106   321]
 [    0   695  2079     0     0     0     0     0]
 [ 1567    77     0  1383  8809   196     0     0]
 [  784   192     0    70 16877  2282   176    93]
 [  361    25     0     0   693  8069    32     0]
 [ 1415    27     0     0  3057   258 15892  1161]
 [    0     1     0     0     0     0  2278 19428]]
              precision    recall  f1-score   support

       Still       0.81      0.91      0.85     29840
     Walking       0.95      0.84      0.89     26143
         Run       1.00      0.75      0.86      2774
        Bike       0.72      0.11      0.20     12032
         Car       0.55      0.82      0.66     20474
         Bus       0.67      0.88      0.76      9180
       Train       0.85      0.73      0.79     21810
      Subway       0.88      0.90      0.89     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.74      0.74    143960
weighted avg       0.80      0.78      0.77    143960

tree_model.pred_mean_lightgbm
[[26798   241     0     0   885   791   500   625]
 [ 2346 21618    11   314   676   438   335   405]
 [    0  1431  1343     0     0     0     0     0]
 [ 2868    89     0  3569  5403   103     0     0]
 [  460    73     0     0 18446  1435    60     0]
 [   16     4     0     0  2388  6554   218     0]
 [  699    85     0    93  3665   114 17117    37]
 [    0     0     0     0     0     0  2290 19417]]
              precision    recall  f1-score   support

       Still       0.81      0.90      0.85     29840
     Walking       0.92      0.83      0.87     26143
         Run       0.99      0.48      0.65      2774
        Bike       0.90      0.30      0.45     12032
         Car       0.59      0.90      0.71     20474
         Bus       0.69      0.71      0.70      9180
       Train       0.83      0.78      0.81     21810
      Subway       0.95      0.89      0.92     21707

    accuracy                           0.80    143960
   macro avg       0.83      0.72      0.75    143960
weighted avg       0.83      0.80      0.79    143960

tree_model.pred_mean_xgb
[[27398   164     0     0   576   572   163   967]
 [ 3070 21189     4   321   624   485   174   276]
 [    0   773  2001     0     0     0     0     0]
 [ 3736   222     0  2813  5176    85     0     0]
 [  652    87     0     0 17272  2463     0     0]
 [  193    16     0     0  2586  6385     0     0]
 [ 1123    88     0    64  3905    98 16403   129]
 [    0     0     0     0     0     0  2290 19417]]
              precision    recall  f1-score   support

       Still       0.76      0.92      0.83     29840
     Walking       0.94      0.81      0.87     26143
         Run       1.00      0.72      0.84      2774
        Bike       0.88      0.23      0.37     12032
         Car       0.57      0.84      0.68     20474
         Bus       0.63      0.70      0.66      9180
       Train       0.86      0.75      0.80     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.78    143960
   macro avg       0.82      0.73      0.75    143960
weighted avg       0.81      0.78      0.78    143960

tree_model.pred_mv
[[26929   110     0     0   633   889   267  1012]
 [ 3040 20883    13   354   838   548   155   312]
 [    1   790  1983     0     0     0     0     0]
 [ 3422   329     0  2793  5295   158    35     0]
 [  704   213     0     2 17554  1905    96     0]
 [  290     7     0    24  2102  6718    39     0]
 [ 1289    53     0    52  3447   168 16560   241]
 [   11     0     0     0     0    28  2275 19393]]
              precision    recall  f1-score   support

       Still       0.75      0.90      0.82     29840
     Walking       0.93      0.80      0.86     26143
         Run       0.99      0.71      0.83      2774
        Bike       0.87      0.23      0.37     12032
         Car       0.59      0.86      0.70     20474
         Bus       0.65      0.73      0.69      9180
       Train       0.85      0.76      0.80     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.78    143960
   macro avg       0.82      0.74      0.75    143960
weighted avg       0.81      0.78      0.77    143960

test over
training set : Hand ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.99
predict lgb
Time elapsed for testing lgb: 1.19
predict xgb
Time elapsed for testing xgb: 2.62
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Hand ; testing set : Hips  testing result
tree_model.pred_mean
[[22949   106     0    54  1400  1439  3645   247]
 [ 1602 21609     0   945   277   485   897   328]
 [    0   354   646  1774     0     0     0     0]
 [ 1064  5255     0  2610  2794   309     0     0]
 [  506    20     0     0 16908  2917   123     0]
 [  199    13     0     0   775  7541   652     0]
 [ 1339    27     0    48  2188   919 17053   236]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.77      0.80     29840
     Walking       0.79      0.83      0.81     26143
         Run       1.00      0.23      0.38      2774
        Bike       0.48      0.22      0.30     12032
         Car       0.69      0.83      0.75     20474
         Bus       0.55      0.82      0.66      9180
       Train       0.51      0.78      0.62     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.69    143960
   macro avg       0.72      0.62      0.62    143960
weighted avg       0.73      0.69      0.68    143960

tree_model.pred_mean_rf
[[25430   149     0    85    36   218  3787   135]
 [ 1541 22694     0   924   185   303   157   339]
 [    0   298     0  2476     0     0     0     0]
 [ 1062  3739     0  3509  3664    58     0     0]
 [ 1348    38     0     0 12496  2620  3943    29]
 [  766    32     0    23   114  7852   393     0]
 [ 1584    21     0    44  1230  1109 16971   851]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.80      0.85      0.83     29840
     Walking       0.84      0.87      0.85     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.50      0.29      0.37     12032
         Car       0.70      0.61      0.65     20474
         Bus       0.65      0.86      0.74      9180
       Train       0.47      0.78      0.58     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.69    143960
   macro avg       0.61      0.59      0.58    143960
weighted avg       0.71      0.69      0.68    143960

tree_model.pred_mean_lightgbm
[[21117   124     0    29  2554  1762  3908   346]
 [ 1420 21080     0  1249   312   509  1216   357]
 [    0   404   791  1579     0     0     0     0]
 [  996  4907     0  3160  2507   393    69     0]
 [  221    37     0     0 17317  2577   322     0]
 [   49     0     0     0   750  7602   779     0]
 [ 1263    16     0    48  2111   882 17331   159]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.71      0.77     29840
     Walking       0.79      0.81      0.80     26143
         Run       1.00      0.29      0.44      2774
        Bike       0.52      0.26      0.35     12032
         Car       0.68      0.85      0.75     20474
         Bus       0.55      0.83      0.66      9180
       Train       0.50      0.79      0.61     21810
      Subway       0.92      0.49      0.64     21707

    accuracy                           0.69    143960
   macro avg       0.73      0.63      0.63    143960
weighted avg       0.73      0.69      0.68    143960

tree_model.pred_mean_xgb
[[23483    86     0    76  1324  1221  3530   120]
 [ 1914 21382     0  1029   201   476   875   266]
 [    0   287   648  1839     0     0     0     0]
 [ 1293  5356     0  2518  2578   287     0     0]
 [  553    19     0     0 16438  3464     0     0]
 [  287     2     0     0  1224  7279   388     0]
 [ 1292    32     0    47  2619   856 16922    42]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.81      0.79      0.80     29840
     Walking       0.79      0.82      0.80     26143
         Run       1.00      0.23      0.38      2774
        Bike       0.46      0.21      0.29     12032
         Car       0.67      0.80      0.73     20474
         Bus       0.54      0.79      0.64      9180
       Train       0.52      0.78      0.62     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.69    143960
   macro avg       0.72      0.61      0.61    143960
weighted avg       0.72      0.69      0.68    143960

tree_model.pred_mv
[[23546    99     0    21  1320  1108  3618   128]
 [ 1983 20739     0  1428   344   599   808   242]
 [    0   312   650  1812     0     0     0     0]
 [ 1243  4789     0  2964  2699   318    19     0]
 [  941    22     0    10 16686  2558   257     0]
 [  402    20     0    20   750  7472   516     0]
 [ 1462    11     0    25  2022   868 17191   231]
 [    6     1     0     0     0     0 11099 10601]]
              precision    recall  f1-score   support

       Still       0.80      0.79      0.79     29840
     Walking       0.80      0.79      0.80     26143
         Run       1.00      0.23      0.38      2774
        Bike       0.47      0.25      0.32     12032
         Car       0.70      0.81      0.75     20474
         Bus       0.58      0.81      0.68      9180
       Train       0.51      0.79      0.62     21810
      Subway       0.95      0.49      0.64     21707

    accuracy                           0.69    143960
   macro avg       0.73      0.62      0.62    143960
weighted avg       0.73      0.69      0.68    143960

test over
training set:Torso,the 3th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 188.7
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.672235 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47485
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.084744
[LightGBM] [Info] Start training from score -2.078407
[LightGBM] [Info] Start training from score -3.142592
[LightGBM] [Info] Start training from score -2.122161
[LightGBM] [Info] Start training from score -1.819923
[LightGBM] [Info] Start training from score -1.933600
[LightGBM] [Info] Start training from score -1.836271
[LightGBM] [Info] Start training from score -2.107736
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.4675
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.18558
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 0.986101
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[4]	valid_0's multi_logloss: 0.835937
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.715574
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.619422
[7]	valid_0's multi_logloss: 0.539208
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.471991
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.416629
[10]	valid_0's multi_logloss: 0.367719
[11]	valid_0's multi_logloss: 0.327155
[12]	valid_0's multi_logloss: 0.292412
[13]	valid_0's multi_logloss: 0.262161
[14]	valid_0's multi_logloss: 0.236567
[15]	valid_0's multi_logloss: 0.21383
[16]	valid_0's multi_logloss: 0.194311
[17]	valid_0's multi_logloss: 0.177228
[18]	valid_0's multi_logloss: 0.162438
[19]	valid_0's multi_logloss: 0.149309
[20]	valid_0's multi_logloss: 0.138288
[21]	valid_0's multi_logloss: 0.128252
[22]	valid_0's multi_logloss: 0.11885
[23]	valid_0's multi_logloss: 0.110911
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[24]	valid_0's multi_logloss: 0.103478
[25]	valid_0's multi_logloss: 0.0972226
[26]	valid_0's multi_logloss: 0.0917807
[27]	valid_0's multi_logloss: 0.0864818
[28]	valid_0's multi_logloss: 0.0822478
[29]	valid_0's multi_logloss: 0.0782366
[30]	valid_0's multi_logloss: 0.0736889
[31]	valid_0's multi_logloss: 0.0700181
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[32]	valid_0's multi_logloss: 0.0667923
[33]	valid_0's multi_logloss: 0.0636738
[34]	valid_0's multi_logloss: 0.0606682
[35]	valid_0's multi_logloss: 0.0580204
[36]	valid_0's multi_logloss: 0.0552473
[37]	valid_0's multi_logloss: 0.0530886
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0511972
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[39]	valid_0's multi_logloss: 0.0494646
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[40]	valid_0's multi_logloss: 0.0475
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0455861
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0437327
[43]	valid_0's multi_logloss: 0.0420351
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.0405348
[45]	valid_0's multi_logloss: 0.039176
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0379778
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.036754
[48]	valid_0's multi_logloss: 0.0354871
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0342478
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0332391
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0321768
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0312552
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.030286
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0295511
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0285808
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0276633
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0269653
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0260439
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0253912
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0246774
[61]	valid_0's multi_logloss: 0.0239632
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0232043
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0225916
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0219447
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0213551
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0207631
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.020201
[68]	valid_0's multi_logloss: 0.0196563
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0191989
[70]	valid_0's multi_logloss: 0.018657
[71]	valid_0's multi_logloss: 0.0182313
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0177883
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.017451
[74]	valid_0's multi_logloss: 0.0170313
[75]	valid_0's multi_logloss: 0.0166325
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0162337
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0158865
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0155462
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0152351
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0148743
[81]	valid_0's multi_logloss: 0.0145346
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0142632
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.0139741
[84]	valid_0's multi_logloss: 0.0136833
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0134081
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0130673
[87]	valid_0's multi_logloss: 0.0128362
[88]	valid_0's multi_logloss: 0.0125145
[89]	valid_0's multi_logloss: 0.012328
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.0120915
[91]	valid_0's multi_logloss: 0.0118411
[92]	valid_0's multi_logloss: 0.0115797
[93]	valid_0's multi_logloss: 0.0113551
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0111605
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.0109572
[96]	valid_0's multi_logloss: 0.0107421
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.0105542
[98]	valid_0's multi_logloss: 0.0103252
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0100836
[100]	valid_0's multi_logloss: 0.00990727
Time elapsed for training LightGBM: 107.16
Training XGBoost...
Time elapsed for training XGBoost: 420.11
begin testing
training set : Torso ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.05
predict lgb
Time elapsed for testing lgb: 1.34
predict xgb
Time elapsed for testing xgb: 2.7
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Torso ; testing set : Torso  testing result
tree_model.pred_mean
[[26150   180     0   131   693    20  2338   328]
 [ 1606 22392    19   895   292    71   561   307]
 [    0   228   896  1650     0     0     0     0]
 [  299   418     0  7723  3592     0     0     0]
 [  300    41     0     0 18761  1173   199     0]
 [  101    43     0     8  2310  6400   318     0]
 [ 1453     1     0    38  2194  1930 15086  1108]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.88      0.88     29840
     Walking       0.96      0.86      0.91     26143
         Run       0.98      0.32      0.49      2774
        Bike       0.74      0.64      0.69     12032
         Car       0.67      0.92      0.78     20474
         Bus       0.67      0.70      0.68      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.75    143960
   macro avg       0.78      0.69      0.70    143960
weighted avg       0.78      0.75      0.75    143960

tree_model.pred_mean_rf
[[25923   205     0    88   344  1255  1865   160]
 [ 1694 18988    21  4541   125   311   287   176]
 [    0     7   907  1860     0     0     0     0]
 [  116   140     0  7454  2954  1077   291     0]
 [  359    38     0     0 17344  2503   230     0]
 [  355    55     0    25   476  8218    51     0]
 [ 2630     3     0    45   769  2209 15100  1054]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.87      0.85     29840
     Walking       0.98      0.73      0.83     26143
         Run       0.98      0.33      0.49      2774
        Bike       0.53      0.62      0.57     12032
         Car       0.79      0.85      0.82     20474
         Bus       0.53      0.90      0.66      9180
       Train       0.52      0.69      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.73    143960
   macro avg       0.76      0.68      0.68    143960
weighted avg       0.77      0.73      0.73    143960

tree_model.pred_mean_lightgbm
[[23747   246     0   312   730    97  3343  1365]
 [ 1395 22416    19   461   770    83   695   304]
 [    0   162   891  1457   264     0     0     0]
 [  310   594     0  7535  3525     0    68     0]
 [  289    20     0     0 18806  1152   207     0]
 [  115    44     0     0  2458  6201   362     0]
 [ 1291    15     0   151  3013  1210 15068  1062]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.80      0.83     29840
     Walking       0.95      0.86      0.90     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.76      0.63      0.69     12032
         Car       0.64      0.92      0.75     20474
         Bus       0.71      0.68      0.69      9180
       Train       0.49      0.69      0.57     21810
      Subway       0.80      0.49      0.61     21707

    accuracy                           0.73    143960
   macro avg       0.77      0.67      0.69    143960
weighted avg       0.77      0.73      0.73    143960

tree_model.pred_mean_xgb
[[26459   164     0    63   931     4  2047   172]
 [ 1738 21672    18   917   576   121   713   388]
 [    0   933   890   951     0     0     0     0]
 [  307   241     0  7911  3573     0     0     0]
 [  302    56     0     0 19254   687   175     0]
 [  179    30     0    38  2279  6264   390     0]
 [ 1552     1     0    43  2250  1761 15105  1098]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.89      0.88     29840
     Walking       0.94      0.83      0.88     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.80      0.66      0.72     12032
         Car       0.67      0.94      0.78     20474
         Bus       0.71      0.68      0.70      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.75    143960
   macro avg       0.79      0.69      0.71    143960
weighted avg       0.78      0.75      0.75    143960

tree_model.pred_mv
[[26274   175     0   156   723   154  2145   213]
 [ 1935 21545     2  1334   398   150   522   257]
 [    3   536   859  1376     0     0     0     0]
 [  588   299     0  7793  3298    11    43     0]
 [  396    36     0     0 18535  1224   283     0]
 [  658    24     0   173  2147  5881   297     0]
 [ 1857    11    10   160  1842  1649 15181  1100]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.88      0.85     29840
     Walking       0.95      0.82      0.88     26143
         Run       0.99      0.31      0.47      2774
        Bike       0.71      0.65      0.68     12032
         Car       0.69      0.91      0.78     20474
         Bus       0.65      0.64      0.64      9180
       Train       0.51      0.70      0.59     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.77      0.67      0.69    143960
weighted avg       0.77      0.74      0.74    143960

test over
training set : Torso ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.99
predict lgb
Time elapsed for testing lgb: 1.3
predict xgb
Time elapsed for testing xgb: 2.6
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Torso ; testing set : Bag  testing result
tree_model.pred_mean
[[25006   124  1752   300   449   237   785  1187]
 [ 1322 17025     1  5990   354    78   890   483]
 [    0  1295  1424    55     0     0     0     0]
 [  446   265     0  6050  5078   193     0     0]
 [  293    39     0   129 17706  2152   155     0]
 [   14    36     0  2435   921  5546   228     0]
 [  157     0     0   108  4431   630 15393  1091]
 [    0     0     0     0     0     0  2301 19406]]
              precision    recall  f1-score   support

       Still       0.92      0.84      0.88     29840
     Walking       0.91      0.65      0.76     26143
         Run       0.45      0.51      0.48      2774
        Bike       0.40      0.50      0.45     12032
         Car       0.61      0.86      0.72     20474
         Bus       0.63      0.60      0.62      9180
       Train       0.78      0.71      0.74     21810
      Subway       0.88      0.89      0.88     21707

    accuracy                           0.75    143960
   macro avg       0.70      0.70      0.69    143960
weighted avg       0.77      0.75      0.75    143960

tree_model.pred_mean_rf
[[26131   125     0   125   545  1709   242   963]
 [ 1209 19379     0  4373   156   160   642   224]
 [    0   978   569  1227     0     0     0     0]
 [  345    31     0  5094  4488  2064    10     0]
 [  416    16     0     0 17366  2420   256     0]
 [    0    29     0   143  1503  7462    43     0]
 [  955     4     0    66  2657   801 16280  1047]
 [    0     0     0     0     0     0  4702 17005]]
              precision    recall  f1-score   support

       Still       0.90      0.88      0.89     29840
     Walking       0.94      0.74      0.83     26143
         Run       1.00      0.21      0.34      2774
        Bike       0.46      0.42      0.44     12032
         Car       0.65      0.85      0.74     20474
         Bus       0.51      0.81      0.63      9180
       Train       0.73      0.75      0.74     21810
      Subway       0.88      0.78      0.83     21707

    accuracy                           0.76    143960
   macro avg       0.76      0.68      0.68    143960
weighted avg       0.78      0.76      0.76    143960

tree_model.pred_mean_lightgbm
[[22835   130  3551   350   412   328  1034  1200]
 [ 1491 17209    19  5364   422   236   922   480]
 [    0  1099  1675     0     0     0     0     0]
 [  759   634     0  5679  4960     0     0     0]
 [  243    38     0   552 17930  1626    85     0]
 [   13    22     0  3069   921  4908   247     0]
 [   74     0   343   162  4808   294 15029  1100]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.90      0.77      0.83     29840
     Walking       0.90      0.66      0.76     26143
         Run       0.30      0.60      0.40      2774
        Bike       0.37      0.47      0.42     12032
         Car       0.61      0.88      0.72     20474
         Bus       0.66      0.53      0.59      9180
       Train       0.77      0.69      0.73     21810
      Subway       0.87      0.89      0.88     21707

    accuracy                           0.73    143960
   macro avg       0.67      0.69      0.67    143960
weighted avg       0.76      0.73      0.74    143960

tree_model.pred_mean_xgb
[[24075   134  3496   403   723   109   405   495]
 [ 1633 15380     2  6597   868   195   856   612]
 [    0  1347  1176   251     0     0     0     0]
 [  170    69     0  6786  4669   338     0     0]
 [  383    42   177   744 17411  1623    94     0]
 [   14    32     0  2585   688  5435   426     0]
 [  228     0    60    95  4130   532 15706  1059]
 [    0     0     0     0     0     0  2292 19415]]
              precision    recall  f1-score   support

       Still       0.91      0.81      0.85     29840
     Walking       0.90      0.59      0.71     26143
         Run       0.24      0.42      0.31      2774
        Bike       0.39      0.56      0.46     12032
         Car       0.61      0.85      0.71     20474
         Bus       0.66      0.59      0.62      9180
       Train       0.79      0.72      0.76     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.73    143960
   macro avg       0.68      0.68      0.67    143960
weighted avg       0.77      0.73      0.74    143960

tree_model.pred_mv
[[25329   126  1764   423   457   218   441  1082]
 [ 1866 16300     1  6273   359    96   825   423]
 [    0  1236  1316   222     0     0     0     0]
 [  677   459     0  5846  4744   306     0     0]
 [  656    39   105   513 17310  1710   141     0]
 [   58    10     0  2554  1034  5267   257     0]
 [  461     0   158   185  4053   535 15346  1072]
 [  124     0    43     0     0     0  2285 19255]]
              precision    recall  f1-score   support

       Still       0.87      0.85      0.86     29840
     Walking       0.90      0.62      0.74     26143
         Run       0.39      0.47      0.43      2774
        Bike       0.37      0.49      0.42     12032
         Car       0.62      0.85      0.71     20474
         Bus       0.65      0.57      0.61      9180
       Train       0.80      0.70      0.75     21810
      Subway       0.88      0.89      0.88     21707

    accuracy                           0.74    143960
   macro avg       0.68      0.68      0.67    143960
weighted avg       0.76      0.74      0.74    143960

test over
training set : Torso ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.07
predict lgb
Time elapsed for testing lgb: 1.22
predict xgb
Time elapsed for testing xgb: 2.47
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Torso ; testing set : Hand  testing result
tree_model.pred_mean
[[22704   778  2082  2116   245     0   580  1335]
 [  551 15966     0  8570     0     0   590   466]
 [    0   379  1950   445     0     0     0     0]
 [    0     0     0 11934    98     0     0     0]
 [  273   225     0  2916 15298  1666    96     0]
 [   13     0     0  2337   936  5768   126     0]
 [  588    40    91  1640  3543     0 14754  1154]
 [    0     0     0     0     0     0  2279 19428]]
              precision    recall  f1-score   support

       Still       0.94      0.76      0.84     29840
     Walking       0.92      0.61      0.73     26143
         Run       0.47      0.70      0.57      2774
        Bike       0.40      0.99      0.57     12032
         Car       0.76      0.75      0.75     20474
         Bus       0.78      0.63      0.69      9180
       Train       0.80      0.68      0.73     21810
      Subway       0.87      0.90      0.88     21707

    accuracy                           0.75    143960
   macro avg       0.74      0.75      0.72    143960
weighted avg       0.81      0.75      0.76    143960

tree_model.pred_mean_rf
[[26159    99     0  2052   185  1007   115   223]
 [  655  3554     0 21750     0     0     3   181]
 [    0     0  1491  1283     0     0     0     0]
 [    0     0     0 11990    42     0     0     0]
 [  308    15     0  2673 14972  2465    41     0]
 [    0     0     0   682   871  7627     0     0]
 [ 1272    10     0   843  2738   137 15537  1273]
 [    0    18     0     0     0     0     0 21689]]
              precision    recall  f1-score   support

       Still       0.92      0.88      0.90     29840
     Walking       0.96      0.14      0.24     26143
         Run       1.00      0.54      0.70      2774
        Bike       0.29      1.00      0.45     12032
         Car       0.80      0.73      0.76     20474
         Bus       0.68      0.83      0.75      9180
       Train       0.99      0.71      0.83     21810
      Subway       0.93      1.00      0.96     21707

    accuracy                           0.72    143960
   macro avg       0.82      0.73      0.70    143960
weighted avg       0.86      0.72      0.71    143960

tree_model.pred_mean_lightgbm
[[18635  1078  6035  1461   302     0  1353   976]
 [  626 17919    29  6484     0     0   595   490]
 [    0   312  2330   132     0     0     0     0]
 [   19    92     0 11805   116     0     0     0]
 [  139   485   156  2838 15326  1437    93     0]
 [   21     0     0  3348   604  4837   370     0]
 [  552    69   503  1613  4044    10 14044   975]
 [    0     0     0     0     0    74  2297 19336]]
              precision    recall  f1-score   support

       Still       0.93      0.62      0.75     29840
     Walking       0.90      0.69      0.78     26143
         Run       0.26      0.84      0.39      2774
        Bike       0.43      0.98      0.59     12032
         Car       0.75      0.75      0.75     20474
         Bus       0.76      0.53      0.62      9180
       Train       0.75      0.64      0.69     21810
      Subway       0.89      0.89      0.89     21707

    accuracy                           0.72    143960
   macro avg       0.71      0.74      0.68    143960
weighted avg       0.80      0.72      0.74    143960

tree_model.pred_mean_xgb
[[22222   729  2458  2590   308     0   279  1254]
 [  571 16506     6  7925     3     0   545   587]
 [    0   352  1738   684     0     0     0     0]
 [    0     3     0 11918   111     0     0     0]
 [  289   221     0  4184 14136  1527   117     0]
 [   16     0     0  3345  1009  4707   103     0]
 [  439    74   193  1696  3772     0 14452  1184]
 [    0     0     0     0     0     0  2277 19430]]
              precision    recall  f1-score   support

       Still       0.94      0.74      0.83     29840
     Walking       0.92      0.63      0.75     26143
         Run       0.40      0.63      0.48      2774
        Bike       0.37      0.99      0.54     12032
         Car       0.73      0.69      0.71     20474
         Bus       0.76      0.51      0.61      9180
       Train       0.81      0.66      0.73     21810
      Subway       0.87      0.90      0.88     21707

    accuracy                           0.73    143960
   macro avg       0.72      0.72      0.69    143960
weighted avg       0.81      0.73      0.75    143960

tree_model.pred_mv
[[22638   929  2232  2304   313    25   611   788]
 [  783 14954    82  9399    39     8   444   434]
 [    0   407  1586   781     0     0     0     0]
 [   56   163     0 11708   105     0     0     0]
 [  461   339    91  4354 13627  1450   152     0]
 [  179     0    14  2842   770  5188   187     0]
 [  829    98   290  1682  3216     0 14511  1184]
 [   44     5     0    17     0     0  2079 19562]]
              precision    recall  f1-score   support

       Still       0.91      0.76      0.83     29840
     Walking       0.89      0.57      0.69     26143
         Run       0.37      0.57      0.45      2774
        Bike       0.35      0.97      0.52     12032
         Car       0.75      0.67      0.71     20474
         Bus       0.78      0.57      0.65      9180
       Train       0.81      0.67      0.73     21810
      Subway       0.89      0.90      0.90     21707

    accuracy                           0.72    143960
   macro avg       0.72      0.71      0.68    143960
weighted avg       0.80      0.72      0.74    143960

test over
training set : Torso ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.0
predict lgb
Time elapsed for testing lgb: 1.36
predict xgb
Time elapsed for testing xgb: 2.5
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : Torso ; testing set : Hips  testing result
tree_model.pred_mean
[[23453   828     0   245   674   416  3688   536]
 [  734 21593    38  2256     0    56  1192   274]
 [    0   141  1799   834     0     0     0     0]
 [   94  1805     0 10114    19     0     0     0]
 [  602    33     0     0 16602  2852   385     0]
 [  277     0     0   123  1670  6437   673     0]
 [  746    39     0    56  2726   791 16397  1055]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.79      0.84     29840
     Walking       0.88      0.83      0.85     26143
         Run       0.98      0.65      0.78      2774
        Bike       0.74      0.84      0.79     12032
         Car       0.77      0.81      0.79     20474
         Bus       0.61      0.70      0.65      9180
       Train       0.49      0.75      0.59     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.74    143960
   macro avg       0.78      0.73      0.74    143960
weighted avg       0.78      0.74      0.75    143960

tree_model.pred_mean_rf
[[23691   466     0   677    21  1265  3594   126]
 [  964 14169     0 10264     0   110   440   196]
 [    0     0  1575  1199     0     0     0     0]
 [   55   354     0 11473   150     0     0     0]
 [ 1079    19     0     0 16194  2818   364     0]
 [ 1098     0     0   241  1872  5688   281     0]
 [ 1129     3     0    94  2034  1073 16429  1048]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.79      0.82     29840
     Walking       0.94      0.54      0.69     26143
         Run       1.00      0.57      0.72      2774
        Bike       0.48      0.95      0.64     12032
         Car       0.80      0.79      0.79     20474
         Bus       0.52      0.62      0.57      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.69    143960
   macro avg       0.75      0.69      0.68    143960
weighted avg       0.76      0.69      0.70    143960

tree_model.pred_mean_lightgbm
[[22144   845     0   462   661   386  4095  1247]
 [  748 21411    96  1845     0    83  1504   456]
 [    0   198  1798   778     0     0     0     0]
 [  213  2405     0  9292    29     0    93     0]
 [ 1887    34     0   100 14947  3055   451     0]
 [  238     0     0    74  1909  6245   714     0]
 [  446    35     0    69  3297   844 16066  1053]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.74      0.80     29840
     Walking       0.86      0.82      0.84     26143
         Run       0.95      0.65      0.77      2774
        Bike       0.74      0.77      0.75     12032
         Car       0.72      0.73      0.72     20474
         Bus       0.59      0.68      0.63      9180
       Train       0.47      0.74      0.58     21810
      Subway       0.79      0.49      0.60     21707

    accuracy                           0.71    143960
   macro avg       0.75      0.70      0.71    143960
weighted avg       0.75      0.71      0.72    143960

tree_model.pred_mean_xgb
[[23280   822    43   791  1018   119  3614   153]
 [  662 21691    88  1746     0    47  1644   265]
 [    0   148  1784   842     0     0     0     0]
 [  372  1694     0  9960     6     0     0     0]
 [  478    48     0     0 17038  2441   469     0]
 [  360     0     0   112  1326  6655   727     0]
 [  806    64     0    31  2294   748 16824  1043]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.78      0.83     29840
     Walking       0.89      0.83      0.86     26143
         Run       0.93      0.64      0.76      2774
        Bike       0.74      0.83      0.78     12032
         Car       0.79      0.83      0.81     20474
         Bus       0.66      0.72      0.69      9180
       Train       0.49      0.77      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.78      0.74      0.75    143960
weighted avg       0.79      0.75      0.75    143960

tree_model.pred_mv
[[23683   807     0   468   657   355  3697   173]
 [ 1043 20952    93  2637    11    36  1229   142]
 [    0   207  1683   877     7     0     0     0]
 [  515  1678     0  9673   166     0     0     0]
 [  888    50     0    59 16780  2205   492     0]
 [  425     2     0   201  1597  6358   597     0]
 [  890    22     0    89  2272   848 16659  1030]
 [    0     2     0     0     0     0 11099 10606]]
              precision    recall  f1-score   support

       Still       0.86      0.79      0.83     29840
     Walking       0.88      0.80      0.84     26143
         Run       0.95      0.61      0.74      2774
        Bike       0.69      0.80      0.74     12032
         Car       0.78      0.82      0.80     20474
         Bus       0.65      0.69      0.67      9180
       Train       0.49      0.76      0.60     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.77      0.72      0.73    143960
weighted avg       0.78      0.74      0.74    143960

test over
begin training all
training set:all_train_set,the 0th training set
begin training
X_train: (3922100, 204)
y_train: 3922100
Training rf...
Time elapsed for training rf: 853.9
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 2.117639 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47654
[LightGBM] [Info] Number of data points in the train set: 3137680, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.080901
[LightGBM] [Info] Start training from score -2.077162
[LightGBM] [Info] Start training from score -3.143678
[LightGBM] [Info] Start training from score -2.122350
[LightGBM] [Info] Start training from score -1.821914
[LightGBM] [Info] Start training from score -1.934800
[LightGBM] [Info] Start training from score -1.836659
[LightGBM] [Info] Start training from score -2.107799
[1]	valid_0's multi_logloss: 1.49963
[2]	valid_0's multi_logloss: 1.22889
[3]	valid_0's multi_logloss: 1.03543
[4]	valid_0's multi_logloss: 0.891098
[5]	valid_0's multi_logloss: 0.775329
[6]	valid_0's multi_logloss: 0.681294
[7]	valid_0's multi_logloss: 0.602642
[8]	valid_0's multi_logloss: 0.53699
[9]	valid_0's multi_logloss: 0.481715
[10]	valid_0's multi_logloss: 0.435072
[11]	valid_0's multi_logloss: 0.395657
[12]	valid_0's multi_logloss: 0.36195
[13]	valid_0's multi_logloss: 0.332587
[14]	valid_0's multi_logloss: 0.306934
[15]	valid_0's multi_logloss: 0.284439
[16]	valid_0's multi_logloss: 0.265054
[17]	valid_0's multi_logloss: 0.247838
[18]	valid_0's multi_logloss: 0.231917
[19]	valid_0's multi_logloss: 0.218338
[20]	valid_0's multi_logloss: 0.20626
[21]	valid_0's multi_logloss: 0.195594
[22]	valid_0's multi_logloss: 0.186344
[23]	valid_0's multi_logloss: 0.177504
[24]	valid_0's multi_logloss: 0.170047
[25]	valid_0's multi_logloss: 0.163155
[26]	valid_0's multi_logloss: 0.156363
[27]	valid_0's multi_logloss: 0.150125
[28]	valid_0's multi_logloss: 0.14421
[29]	valid_0's multi_logloss: 0.138879
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[30]	valid_0's multi_logloss: 0.134014
[31]	valid_0's multi_logloss: 0.129137
[32]	valid_0's multi_logloss: 0.124966
[33]	valid_0's multi_logloss: 0.12095
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[34]	valid_0's multi_logloss: 0.117105
[35]	valid_0's multi_logloss: 0.113755
[36]	valid_0's multi_logloss: 0.110682
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.107664
[38]	valid_0's multi_logloss: 0.104596
[39]	valid_0's multi_logloss: 0.101821
[40]	valid_0's multi_logloss: 0.0993204
[41]	valid_0's multi_logloss: 0.0965987
[42]	valid_0's multi_logloss: 0.0940691
[43]	valid_0's multi_logloss: 0.0919205
[44]	valid_0's multi_logloss: 0.0899064
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0877547
[46]	valid_0's multi_logloss: 0.0858415
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0837696
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0821619
[49]	valid_0's multi_logloss: 0.0801726
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0786621
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0770833
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0752199
[53]	valid_0's multi_logloss: 0.0736675
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0724273
[55]	valid_0's multi_logloss: 0.0711641
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0698742
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0685817
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0676348
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0665531
[60]	valid_0's multi_logloss: 0.0652636
[61]	valid_0's multi_logloss: 0.064176
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0632285
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0622416
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0613605
[65]	valid_0's multi_logloss: 0.0604156
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.059515
[67]	valid_0's multi_logloss: 0.0585662
[68]	valid_0's multi_logloss: 0.0576421
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0567253
[70]	valid_0's multi_logloss: 0.0559578
[71]	valid_0's multi_logloss: 0.0552099
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0544206
[73]	valid_0's multi_logloss: 0.0537588
[74]	valid_0's multi_logloss: 0.0529142
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0521766
[76]	valid_0's multi_logloss: 0.0514448
[77]	valid_0's multi_logloss: 0.0507639
[78]	valid_0's multi_logloss: 0.050122
[79]	valid_0's multi_logloss: 0.0495698
[80]	valid_0's multi_logloss: 0.0489591
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0484676
[82]	valid_0's multi_logloss: 0.0476968
[83]	valid_0's multi_logloss: 0.0470058
[84]	valid_0's multi_logloss: 0.0462447
[85]	valid_0's multi_logloss: 0.045553
[86]	valid_0's multi_logloss: 0.0450087
[87]	valid_0's multi_logloss: 0.0443496
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0438252
[89]	valid_0's multi_logloss: 0.0433215
[90]	valid_0's multi_logloss: 0.0427876
[91]	valid_0's multi_logloss: 0.0421928
[92]	valid_0's multi_logloss: 0.0417612
[93]	valid_0's multi_logloss: 0.0412774
[94]	valid_0's multi_logloss: 0.0408101
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.0404372
[96]	valid_0's multi_logloss: 0.0400144
[97]	valid_0's multi_logloss: 0.0396181
[98]	valid_0's multi_logloss: 0.0392378
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0388367
[100]	valid_0's multi_logloss: 0.0383942
Time elapsed for training LightGBM: 388.39
Training XGBoost...
Time elapsed for training XGBoost: 1920.04
begin testing
training set : all_train_set ; testing set : all_test_set; test order: 0
X_val  : (575840, 204)
y_val  : 575840
predict rf
Time elapsed for testing rf 5.01
predict lgb
Time elapsed for testing lgb: 4.59
predict xgb
Time elapsed for testing xgb: 9.71
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : all_train_set ; testing set : all_test_set  testing result
tree_model.pred_mean
[[105146   1800      0    104   1708   1689   6681   2232]
 [  5313  93143     42   2745    497    890   1126    816]
 [     0   7258   3482    356      0      0      0      0]
 [  3239   3955      0  29918  10216    800      0      0]
 [  1112    344      0      0  75011   4746    683      0]
 [   171    109      0    123   9194  26414    709      0]
 [  4657    229      0    195   9898   4617  64401   3243]
 [     0     13      0      0      0      0  26755  60060]]
              precision    recall  f1-score   support

       Still       0.88      0.88      0.88    119360
     Walking       0.87      0.89      0.88    104572
         Run       0.99      0.31      0.48     11096
        Bike       0.89      0.62      0.73     48128
         Car       0.70      0.92      0.80     81896
         Bus       0.67      0.72      0.70     36720
       Train       0.64      0.74      0.69     87240
      Subway       0.91      0.69      0.78     86828

    accuracy                           0.79    575840
   macro avg       0.82      0.72      0.74    575840
weighted avg       0.81      0.79      0.79    575840

tree_model.pred_mean_rf
[[104660   1866      0    640   2104   2406   5430   2254]
 [  4770  92385     21   4093   1048    835    559    861]
 [     0   6761   3346    989      0      0      0      0]
 [   390   4603      0  24256  15639   3240      0      0]
 [  1986    494      0    214  72011   6445    558    188]
 [  2062    163      0    232   4642  29618      3      0]
 [  6824    194      0    178   4218   3801  67655   4370]
 [     0     21      0      0      0      0  24504  62303]]
              precision    recall  f1-score   support

       Still       0.87      0.88      0.87    119360
     Walking       0.87      0.88      0.88    104572
         Run       0.99      0.30      0.46     11096
        Bike       0.79      0.50      0.62     48128
         Car       0.72      0.88      0.79     81896
         Bus       0.64      0.81      0.71     36720
       Train       0.69      0.78      0.73     87240
      Subway       0.89      0.72      0.79     86828

    accuracy                           0.79    575840
   macro avg       0.81      0.72      0.73    575840
weighted avg       0.80      0.79      0.79    575840

tree_model.pred_mean_lightgbm
[[96869  1630   142   236  4167  4397  9434  2485]
 [ 5078 92669    55  2102   828  1093  1488  1259]
 [    0  7467  3304   325     0     0     0     0]
 [ 4184  3620     0 28783 11074   467     0     0]
 [  940   199     0     0 75875  4185   697     0]
 [   24    85     0    92  9201 26444   874     0]
 [ 3560   168     0   215 10956  4865 65204  2272]
 [    0    12     0     0     0     0 26767 60049]]
              precision    recall  f1-score   support

       Still       0.88      0.81      0.84    119360
     Walking       0.88      0.89      0.88    104572
         Run       0.94      0.30      0.45     11096
        Bike       0.91      0.60      0.72     48128
         Car       0.68      0.93      0.78     81896
         Bus       0.64      0.72      0.68     36720
       Train       0.62      0.75      0.68     87240
      Subway       0.91      0.69      0.79     86828

    accuracy                           0.78    575840
   macro avg       0.81      0.71      0.73    575840
weighted avg       0.80      0.78      0.78    575840

tree_model.pred_mean_xgb
[[105323   1949      0    235   2526   1533   6304   1490]
 [  5922  92725     58   3054    260    787   1183    583]
 [     0   7157   3395    544      0      0      0      0]
 [  4365   4631      0  31033   7184    838     77      0]
 [  1501    442      0      0  73894   5335    724      0]
 [   244     93      0    129  10119  25550    585      0]
 [  4865    237      0    278  11532   4183  62584   3561]
 [     0      9      0      0      0      0  26750  60069]]
              precision    recall  f1-score   support

       Still       0.86      0.88      0.87    119360
     Walking       0.86      0.89      0.88    104572
         Run       0.98      0.31      0.47     11096
        Bike       0.88      0.64      0.74     48128
         Car       0.70      0.90      0.79     81896
         Bus       0.67      0.70      0.68     36720
       Train       0.64      0.72      0.67     87240
      Subway       0.91      0.69      0.79     86828

    accuracy                           0.79    575840
   macro avg       0.81      0.72      0.74    575840
weighted avg       0.80      0.79      0.79    575840

tree_model.pred_mv
[[104871   1228      0    227   2256   2050   6635   2093]
 [  7362  89241     42   3764    756   1461   1276    670]
 [     0   6765   3625    706      0      0      0      0]
 [  5042   4695      0  26899  10162   1232     98      0]
 [  2105    489      0    113  73488   4708    993      0]
 [  1197     79      0    479   9139  25104    722      0]
 [  5084    146      0    330   9665   4409  64091   3515]
 [    38      4      0      0      0      0  26754  60032]]
              precision    recall  f1-score   support

       Still       0.83      0.88      0.86    119360
     Walking       0.87      0.85      0.86    104572
         Run       0.99      0.33      0.49     11096
        Bike       0.83      0.56      0.67     48128
         Car       0.70      0.90      0.78     81896
         Bus       0.64      0.68      0.66     36720
       Train       0.64      0.73      0.68     87240
      Subway       0.91      0.69      0.78     86828

    accuracy                           0.78    575840
   macro avg       0.80      0.70      0.72    575840
weighted avg       0.79      0.78      0.77    575840

test over
training set : all_train_set ; testing set : Torso; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.07
predict lgb
Time elapsed for testing lgb: 1.31
predict xgb
Time elapsed for testing xgb: 2.68
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : all_train_set ; testing set : Torso  testing result
tree_model.pred_mean
[[26334   266     0    45   400   508  2055   232]
 [ 1679 23125     4   257   162   542   216   158]
 [    0  1892   882     0     0     0     0     0]
 [  453   408     0  7140  3681   350     0     0]
 [  298    57     0     0 18482  1470   167     0]
 [  129    37     0     0  1853  7021   140     0]
 [ 2164    30     0    19   755  2727 15262   853]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.85      0.88      0.86     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.32      0.48      2774
        Bike       0.96      0.59      0.73     12032
         Car       0.73      0.90      0.81     20474
         Bus       0.56      0.76      0.64      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.80      0.69      0.71    143960
weighted avg       0.79      0.76      0.75    143960

tree_model.pred_mean_rf
[[25645   305     0    54   490  1463  1701   182]
 [ 1844 22373     0   705   501   412   149   159]
 [    0  1922   852     0     0     0     0     0]
 [   81  1000     0  4050  5970   931     0     0]
 [  202    86     0     0 18119  1922    66    79]
 [ 1002    58     0     5   795  7320     0     0]
 [ 3316    14     0    25     0  1746 15691  1018]
 [    0     4     0     0     0     0 11099 10604]]
              precision    recall  f1-score   support

       Still       0.80      0.86      0.83     29840
     Walking       0.87      0.86      0.86     26143
         Run       1.00      0.31      0.47      2774
        Bike       0.84      0.34      0.48     12032
         Car       0.70      0.88      0.78     20474
         Bus       0.53      0.80      0.64      9180
       Train       0.55      0.72      0.62     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.73    143960
   macro avg       0.77      0.66      0.66    143960
weighted avg       0.76      0.73      0.72    143960

tree_model.pred_mean_lightgbm
[[23756   322     0    10   667   931  3767   387]
 [ 1283 23133     9   243   226   754   225   270]
 [    0  1889   885     0     0     0     0     0]
 [  420   430     0  7033  3887   262     0     0]
 [  267    26     0     0 18624  1368   189     0]
 [    0    29     0     0  1924  7048   179     0]
 [ 1487    15     0    11  1098  3147 15430   622]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.80      0.83     29840
     Walking       0.90      0.88      0.89     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.96      0.58      0.73     12032
         Car       0.70      0.91      0.79     20474
         Bus       0.52      0.77      0.62      9180
       Train       0.50      0.71      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.68      0.70    143960
weighted avg       0.79      0.74      0.74    143960

tree_model.pred_mean_xgb
[[26640   379     0    24   305   359  1994   139]
 [ 2012 22909    10   276   120   462   223   131]
 [    0  1885   889     0     0     0     0     0]
 [  815   333     0  7437  3045   325    77     0]
 [  359    62     0     0 18182  1704   167     0]
 [  201    31     0     0  1785  6984   179     0]
 [ 2422    38     0     0   969  2340 15093   948]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.89      0.86     29840
     Walking       0.89      0.88      0.88     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.96      0.62      0.75     12032
         Car       0.74      0.89      0.81     20474
         Bus       0.57      0.76      0.65      9180
       Train       0.52      0.69      0.60     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.80      0.69      0.71    143960
weighted avg       0.79      0.76      0.75    143960

tree_model.pred_mv
[[26615   174     0    20   382   541  1922   186]
 [ 2314 22245    23   374   229   610   204   144]
 [    0  1791   887    96     0     0     0     0]
 [  955   680     0  6431  3497   382    87     0]
 [  373    46     0     0 18276  1525   254     0]
 [  765    21     0   105  1523  6604   162     0]
 [ 2012    12     0    34   955  2651 15280   866]
 [    9     1     0     0     0     0 11099 10598]]
              precision    recall  f1-score   support

       Still       0.81      0.89      0.85     29840
     Walking       0.89      0.85      0.87     26143
         Run       0.97      0.32      0.48      2774
        Bike       0.91      0.53      0.67     12032
         Car       0.74      0.89      0.81     20474
         Bus       0.54      0.72      0.61      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.78      0.67      0.69    143960
weighted avg       0.78      0.74      0.74    143960

test over
training set : all_train_set ; testing set : Bag; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.04
predict lgb
Time elapsed for testing lgb: 1.34
predict xgb
Time elapsed for testing xgb: 2.61
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : all_train_set ; testing set : Bag  testing result
tree_model.pred_mean
[[27462   320     0     0   467    57   621   913]
 [ 1224 23403     4   713   190    92   352   165]
 [    0  1893   881     0     0     0     0     0]
 [ 1188   717     0  5052  4757   318     0     0]
 [   96    15     0     0 19825   347   191     0]
 [    0    33     0    46  2644  6278   179     0]
 [  712    34     0    90  2831   716 16535   892]
 [    0     1     0     0     0     0  2290 19416]]
              precision    recall  f1-score   support

       Still       0.90      0.92      0.91     29840
     Walking       0.89      0.90      0.89     26143
         Run       1.00      0.32      0.48      2774
        Bike       0.86      0.42      0.56     12032
         Car       0.65      0.97      0.77     20474
         Bus       0.80      0.68      0.74      9180
       Train       0.82      0.76      0.79     21810
      Subway       0.91      0.89      0.90     21707

    accuracy                           0.83    143960
   macro avg       0.85      0.73      0.76    143960
weighted avg       0.84      0.83      0.82    143960

tree_model.pred_mean_rf
[[28029   237     0    43   341   111   123   956]
 [  953 23414     0   832   387   159    87   311]
 [    0  1914   860     0     0     0     0     0]
 [  108   623     0  1865  7237  2199     0     0]
 [  255    36     0     0 18618  1370   134    61]
 [   33    39     0    50  1364  7694     0     0]
 [ 1375    18     0    66  1020   511 17851   969]
 [    0     0     0     0     0     0  2306 19401]]
              precision    recall  f1-score   support

       Still       0.91      0.94      0.93     29840
     Walking       0.89      0.90      0.89     26143
         Run       1.00      0.31      0.47      2774
        Bike       0.65      0.16      0.25     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.64      0.84      0.73      9180
       Train       0.87      0.82      0.84     21810
      Subway       0.89      0.89      0.89     21707

    accuracy                           0.82    143960
   macro avg       0.81      0.72      0.72    143960
weighted avg       0.82      0.82      0.80    143960

tree_model.pred_mean_lightgbm
[[24855   310   141     5  2175   326  1051   977]
 [ 1283 23319     8   471   263    65   461   273]
 [    0  1888   886     0     0     0     0     0]
 [ 1122   524     0  5843  4463    80     0     0]
 [   79     8     0     0 19653   549   185     0]
 [    0    28     0    34  2510  6373   235     0]
 [  518    20     0   110  2969   720 16618   855]
 [    0     1     0     0     0     0  2287 19419]]
              precision    recall  f1-score   support

       Still       0.89      0.83      0.86     29840
     Walking       0.89      0.89      0.89     26143
         Run       0.86      0.32      0.47      2774
        Bike       0.90      0.49      0.63     12032
         Car       0.61      0.96      0.75     20474
         Bus       0.79      0.69      0.74      9180
       Train       0.80      0.76      0.78     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.81    143960
   macro avg       0.83      0.73      0.75    143960
weighted avg       0.83      0.81      0.81    143960

tree_model.pred_mean_xgb
[[28073   383     0    11   424   186   469   294]
 [ 1445 23210     6   809   110    79   363   121]
 [    0  1688   887   199     0     0     0     0]
 [ 2213   815     0  5345  3333   326     0     0]
 [  288    55     0     0 19846   125   160     0]
 [    0    35     0    51  3103  5813   178     0]
 [  635    61     0    58  3686   717 15734   919]
 [    0     2     0     0     0     0  2281 19424]]
              precision    recall  f1-score   support

       Still       0.86      0.94      0.90     29840
     Walking       0.88      0.89      0.89     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.83      0.44      0.58     12032
         Car       0.65      0.97      0.78     20474
         Bus       0.80      0.63      0.71      9180
       Train       0.82      0.72      0.77     21810
      Subway       0.94      0.89      0.91     21707

    accuracy                           0.82    143960
   macro avg       0.85      0.73      0.75    143960
weighted avg       0.84      0.82      0.81    143960

tree_model.pred_mv
[[27400   113     0    48   613   322   541   803]
 [ 1812 22395    19   808   295   320   396    98]
 [    0  1709   889   176     0     0     0     0]
 [ 1725   857     0  4453  4371   626     0     0]
 [  378    38     0     0 19354   451   253     0]
 [    5    24     0   156  2790  5989   216     0]
 [  907    35     0    99  2810   612 16365   982]
 [    0     2     0     0     0     0  2283 19422]]
              precision    recall  f1-score   support

       Still       0.85      0.92      0.88     29840
     Walking       0.89      0.86      0.87     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.78      0.37      0.50     12032
         Car       0.64      0.95      0.76     20474
         Bus       0.72      0.65      0.68      9180
       Train       0.82      0.75      0.78     21810
      Subway       0.91      0.89      0.90     21707

    accuracy                           0.81    143960
   macro avg       0.82      0.71      0.73    143960
weighted avg       0.82      0.81      0.80    143960

test over
training set : all_train_set ; testing set : Hand; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.19
predict lgb
Time elapsed for testing lgb: 1.2
predict xgb
Time elapsed for testing xgb: 2.6
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : all_train_set ; testing set : Hand  testing result
tree_model.pred_mean
[[26733   489     0    14   559   714   364   967]
 [ 1528 23072     1   970   131    48   132   261]
 [    0  1490  1232    52     0     0     0     0]
 [ 1004    61     0  9244  1591   132     0     0]
 [  314   234     0     0 18456  1337   133     0]
 [   13    18     0    27  2628  6295   199     0]
 [  936    99     0    79  3486   203 16286   721]
 [    0    11     0     0     0     0  2267 19429]]
              precision    recall  f1-score   support

       Still       0.88      0.90      0.89     29840
     Walking       0.91      0.88      0.89     26143
         Run       1.00      0.44      0.61      2774
        Bike       0.89      0.77      0.82     12032
         Car       0.69      0.90      0.78     20474
         Bus       0.72      0.69      0.70      9180
       Train       0.84      0.75      0.79     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.84    143960
   macro avg       0.85      0.78      0.80    143960
weighted avg       0.85      0.84      0.84    143960

tree_model.pred_mean_rf
[[26044   625     0   159  1051   817   159   985]
 [  977 23110     0  1507   160   142    40   207]
 [    0  1325  1132   317     0     0     0     0]
 [    2   188     0  9576  2156   110     0     0]
 [  557   298     0   214 17757  1559    41    48]
 [  339    27     0   110  1388  7316     0     0]
 [  994   104     0    55  2426   356 16623  1252]
 [    0    17     0     0     0     0     0 21690]]
              precision    recall  f1-score   support

       Still       0.90      0.87      0.89     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.41      0.58      2774
        Bike       0.80      0.80      0.80     12032
         Car       0.71      0.87      0.78     20474
         Bus       0.71      0.80      0.75      9180
       Train       0.99      0.76      0.86     21810
      Subway       0.90      1.00      0.95     21707

    accuracy                           0.86    143960
   macro avg       0.86      0.80      0.81    143960
weighted avg       0.87      0.86      0.86    143960

tree_model.pred_mean_lightgbm
[[25726   384     1   210   587  1227   726   979]
 [ 1749 22720     3   743   248    63   237   380]
 [    0  1585  1189     0     0     0     0     0]
 [ 1875   130     0  7790  2112   125     0     0]
 [  352   132     0     0 18881   986   123     0]
 [    6    15     0    13  2699  6215   232     0]
 [  922    84     0    94  3587   134 16790   199]
 [    0    10     0     0     0     0  2282 19415]]
              precision    recall  f1-score   support

       Still       0.84      0.86      0.85     29840
     Walking       0.91      0.87      0.89     26143
         Run       1.00      0.43      0.60      2774
        Bike       0.88      0.65      0.75     12032
         Car       0.67      0.92      0.78     20474
         Bus       0.71      0.68      0.69      9180
       Train       0.82      0.77      0.80     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.82    143960
   macro avg       0.84      0.76      0.78    143960
weighted avg       0.84      0.82      0.82    143960

tree_model.pred_mean_xgb
[[26810   609     0   151   574   568   176   952]
 [ 1473 23174    10  1101    30    46   138   171]
 [    0  1455  1223    96     0     0     0     0]
 [  680   293     0 10067   805   187     0     0]
 [  365   285     0     0 17849  1764   211     0]
 [   21    11     0    29  3100  5989    30     0]
 [  922    78     0   213  3937   206 15593   861]
 [    0     7     0     0     0     0  2271 19429]]
              precision    recall  f1-score   support

       Still       0.89      0.90      0.89     29840
     Walking       0.89      0.89      0.89     26143
         Run       0.99      0.44      0.61      2774
        Bike       0.86      0.84      0.85     12032
         Car       0.68      0.87      0.76     20474
         Bus       0.68      0.65      0.67      9180
       Train       0.85      0.71      0.78     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.83    143960
   macro avg       0.84      0.77      0.79    143960
weighted avg       0.84      0.83      0.83    143960

tree_model.pred_mv
[[26445   369     0   107   610   757   574   978]
 [ 1827 22152     0  1296   191   238   198   241]
 [    0  1296  1329   149     0     0     0     0]
 [ 1563   297     0  8197  1803   162    10     0]
 [  515   357     0   113 17890  1372   227     0]
 [  181     7     0   174  2702  6013   103     0]
 [ 1185    74     0   135  3316   208 16045   847]
 [   13     0     0     0     0     0  2273 19421]]
              precision    recall  f1-score   support

       Still       0.83      0.89      0.86     29840
     Walking       0.90      0.85      0.87     26143
         Run       1.00      0.48      0.65      2774
        Bike       0.81      0.68      0.74     12032
         Car       0.67      0.87      0.76     20474
         Bus       0.69      0.66      0.67      9180
       Train       0.83      0.74      0.78     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.82    143960
   macro avg       0.83      0.76      0.78    143960
weighted avg       0.82      0.82      0.82    143960

test over
training set : all_train_set ; testing set : Hips; test order: 4
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.1
predict lgb
Time elapsed for testing lgb: 1.3
predict xgb
Time elapsed for testing xgb: 2.63
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
----------------------------rf lgb xgb  mv vote---------------------------------
training set : all_train_set ; testing set : Hips  testing result
tree_model.pred_mean
[[24617   725     0    45   282   410  3641   120]
 [  862 23596     0   805    14   208   426   232]
 [    0  1983   487   304     0     0     0     0]
 [  594  2769     0  8482   187     0     0     0]
 [  404    38     0     0 18248  1592   192     0]
 [   29    21     0    50  2069  6820   191     0]
 [  845    66     0     7  2826   971 16318   777]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.82      0.86     29840
     Walking       0.81      0.90      0.85     26143
         Run       1.00      0.18      0.30      2774
        Bike       0.88      0.70      0.78     12032
         Car       0.77      0.89      0.83     20474
         Bus       0.68      0.74      0.71      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.81      0.68      0.70    143960
weighted avg       0.79      0.76      0.76    143960

tree_model.pred_mean_rf
[[24942   699     0   384   222    15  3447   131]
 [  960 23502     0  1092     0   122   283   184]
 [    0  1600   502   672     0     0     0     0]
 [  199  2792     0  8765   276     0     0     0]
 [  972    74     0     0 17517  1594   317     0]
 [  688    39     0    67  1095  7288     3     0]
 [ 1139    58     0    32   772  1188 17490  1131]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.84      0.85     29840
     Walking       0.82      0.90      0.86     26143
         Run       1.00      0.18      0.31      2774
        Bike       0.80      0.73      0.76     12032
         Car       0.88      0.86      0.87     20474
         Bus       0.71      0.79      0.75      9180
       Train       0.54      0.80      0.64     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    143960
   macro avg       0.81      0.70      0.71    143960
weighted avg       0.80      0.77      0.76    143960

tree_model.pred_mean_lightgbm
[[22532   614     0    11   738  1913  3890   142]
 [  763 23532     0   645    91   211   565   336]
 [    0  2105   344   325     0     0     0     0]
 [  767  2536     0  8117   612     0     0     0]
 [  242    33     0     0 18717  1282   200     0]
 [   18    13     0    45  2068  6808   228     0]
 [  633    49     0     0  3302   864 16366   596]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.90      0.76      0.82     29840
     Walking       0.81      0.90      0.86     26143
         Run       1.00      0.12      0.22      2774
        Bike       0.89      0.67      0.77     12032
         Car       0.73      0.91      0.81     20474
         Bus       0.61      0.74      0.67      9180
       Train       0.51      0.75      0.60     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.74    143960
   macro avg       0.80      0.67      0.67    143960
weighted avg       0.79      0.74      0.74    143960

tree_model.pred_mean_xgb
[[23800   578     0    49  1223   420  3665   105]
 [  958 23498     0   868     0   200   459   160]
 [    0  2129   396   249     0     0     0     0]
 [  657  3190     0  8184     1     0     0     0]
 [  489    40     0     0 18017  1742   186     0]
 [   22    16     0    49  2131  6764   198     0]
 [  886    60     0     7  2940   920 16164   833]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.80      0.84     29840
     Walking       0.80      0.90      0.84     26143
         Run       1.00      0.14      0.25      2774
        Bike       0.87      0.68      0.76     12032
         Car       0.74      0.88      0.80     20474
         Bus       0.67      0.74      0.70      9180
       Train       0.51      0.74      0.60     21810
      Subway       0.91      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.67      0.68    143960
weighted avg       0.78      0.75      0.74    143960

tree_model.pred_mv
[[24411   572     0    52   651   430  3598   126]
 [ 1409 22449     0  1286    41   293   478   187]
 [    0  1964   532   278     0     0     0     0]
 [  799  2861     0  7818   491    62     1     0]
 [  839    48     0     0 17968  1360   259     0]
 [  246    27     0    44  2124  6498   241     0]
 [  980    25     0    62  2584   938 16401   820]
 [   16     1     0     0     0     0 11099 10591]]
              precision    recall  f1-score   support

       Still       0.85      0.82      0.83     29840
     Walking       0.80      0.86      0.83     26143
         Run       1.00      0.19      0.32      2774
        Bike       0.82      0.65      0.72     12032
         Car       0.75      0.88      0.81     20474
         Bus       0.68      0.71      0.69      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.67      0.68    143960
weighted avg       0.77      0.74      0.74    143960

test over
