nohup: ignoring input
the all length of training set:4202100
the all length of test set:603840
begin training single
training set:Hips,the 0th training set
begin training
X_train: (1050525, 204)
y_train: 1050525
Training rf...
Time elapsed for training rf: 287.7
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.468658 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 51998
[LightGBM] [Info] Number of data points in the train set: 840420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.150916
[LightGBM] [Info] Start training from score -2.146529
[LightGBM] [Info] Start training from score -2.233937
[LightGBM] [Info] Start training from score -2.191544
[LightGBM] [Info] Start training from score -1.889140
[LightGBM] [Info] Start training from score -2.005541
[LightGBM] [Info] Start training from score -1.905332
[LightGBM] [Info] Start training from score -2.177533
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.50299
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.20376
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 0.994447
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[4]	valid_0's multi_logloss: 0.836804
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.71177
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.612093
[7]	valid_0's multi_logloss: 0.529612
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.461925
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.405667
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[10]	valid_0's multi_logloss: 0.357315
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[11]	valid_0's multi_logloss: 0.316603
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[12]	valid_0's multi_logloss: 0.281794
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[13]	valid_0's multi_logloss: 0.252198
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[14]	valid_0's multi_logloss: 0.226893
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[15]	valid_0's multi_logloss: 0.204888
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[16]	valid_0's multi_logloss: 0.185921
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[17]	valid_0's multi_logloss: 0.170016
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[18]	valid_0's multi_logloss: 0.156299
[19]	valid_0's multi_logloss: 0.144063
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[20]	valid_0's multi_logloss: 0.133396
[21]	valid_0's multi_logloss: 0.123952
[22]	valid_0's multi_logloss: 0.115147
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[23]	valid_0's multi_logloss: 0.107854
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[24]	valid_0's multi_logloss: 0.100568
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[25]	valid_0's multi_logloss: 0.0942125
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[26]	valid_0's multi_logloss: 0.0882254
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[27]	valid_0's multi_logloss: 0.0828555
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[28]	valid_0's multi_logloss: 0.0785317
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[29]	valid_0's multi_logloss: 0.0746177
[30]	valid_0's multi_logloss: 0.0707106
[31]	valid_0's multi_logloss: 0.0669024
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[32]	valid_0's multi_logloss: 0.063911
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[33]	valid_0's multi_logloss: 0.0607938
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[34]	valid_0's multi_logloss: 0.0581721
[35]	valid_0's multi_logloss: 0.0556504
[36]	valid_0's multi_logloss: 0.0531881
[37]	valid_0's multi_logloss: 0.0507259
[38]	valid_0's multi_logloss: 0.0482945
[39]	valid_0's multi_logloss: 0.0463706
[40]	valid_0's multi_logloss: 0.0447492
[41]	valid_0's multi_logloss: 0.0430745
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0414034
[43]	valid_0's multi_logloss: 0.0400479
[44]	valid_0's multi_logloss: 0.0384939
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0370931
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0359059
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0345886
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0333812
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.032274
[50]	valid_0's multi_logloss: 0.0309872
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0300814
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0290056
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0280811
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0273797
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0263613
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0255356
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0248093
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0241046
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0235016
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0228782
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0221612
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0213783
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0208248
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0202743
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0196571
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0192166
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0185832
[68]	valid_0's multi_logloss: 0.0181741
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0178012
[70]	valid_0's multi_logloss: 0.0173655
[71]	valid_0's multi_logloss: 0.0168383
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0164147
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0160581
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0157027
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.01536
[76]	valid_0's multi_logloss: 0.014976
[77]	valid_0's multi_logloss: 0.0146147
[78]	valid_0's multi_logloss: 0.014295
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0139919
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0137286
[81]	valid_0's multi_logloss: 0.0133848
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0130867
[83]	valid_0's multi_logloss: 0.0127814
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0124257
[85]	valid_0's multi_logloss: 0.0121578
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0119318
[87]	valid_0's multi_logloss: 0.0116264
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0113902
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[89]	valid_0's multi_logloss: 0.0111765
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.0110096
[91]	valid_0's multi_logloss: 0.0107087
[92]	valid_0's multi_logloss: 0.0105145
[93]	valid_0's multi_logloss: 0.0102782
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0100746
[95]	valid_0's multi_logloss: 0.00988927
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.00973361
[97]	valid_0's multi_logloss: 0.00954373
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.00934079
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.00917865
[100]	valid_0's multi_logloss: 0.00902416
Time elapsed for training LightGBM: 140.5
Training XGBoost...
Time elapsed for training XGBoost: 612.55
begin testing
training set : Hips ; testing set : Torso; test order: 0
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.02
predict lgb
Time elapsed for testing lgb: 1.29
predict xgb
Time elapsed for testing xgb: 2.71
training set : Hips ; testing set : Torso  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[25035    47     0    96  1540   685  2070   367]
 [ 2739  6306    13 10872   424  3522   583  1684]
 [    0   434  7000  2340     0     0     0     0]
 [  648     0     0  8041  2531   812     0     0]
 [  186     2     0     0 20094   192     0     0]
 [  139     0     0    84   939  7746   272     0]
 [ 1806     0     0    36   524  3044 15299  1101]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.84      0.83     29840
     Walking       0.93      0.24      0.38     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.37      0.67      0.48     12032
         Car       0.77      0.98      0.86     20474
         Bus       0.48      0.84      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.71      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25120    24     0   127  1502   609  2089   369]
 [ 2773  6128    18 10917   461  3524   573  1749]
 [    0   421  7000  2353     0     0     0     0]
 [  547     0     0  8000  2636   849     0     0]
 [  153     0     0     0 20191   130     0     0]
 [   97     0     0    55  1044  7795   189     0]
 [ 1876     0     0    32   546  2991 15266  1099]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.84      0.83     29840
     Walking       0.93      0.23      0.37     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.37      0.66      0.48     12032
         Car       0.77      0.99      0.86     20474
         Bus       0.49      0.85      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.71      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25028     7     0   146  1444   670  2174   371]
 [ 2744  6180    20 10803   517  3512   612  1755]
 [    0   415  7000  2359     0     0     0     0]
 [  559     0     0  8020  2554   899     0     0]
 [  144     0     0     0 20225   105     0     0]
 [   82     0     0    41  1061  7828   168     0]
 [ 1994     0     0    22   539  2928 15237  1090]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.84      0.83     29840
     Walking       0.94      0.24      0.38     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.37      0.67      0.48     12032
         Car       0.77      0.99      0.86     20474
         Bus       0.49      0.85      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.71      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[24917     4     0   161  1475   719  2191   373]
 [ 2669  6197    24 10753   491  3618   619  1772]
 [    0   371  7000  2403     0     0     0     0]
 [  557     0     0  8051  2525   899     0     0]
 [  153     0     0     0 20229    92     0     0]
 [   23     0     0    37  1052  7895   173     0]
 [ 2086     0     0    10   505  2904 15230  1075]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.84      0.83     29840
     Walking       0.94      0.24      0.38     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.38      0.67      0.48     12032
         Car       0.77      0.99      0.87     20474
         Bus       0.49      0.86      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.71      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[24892     2     0   178  1401   731  2257   379]
 [ 2786  6158    26 10641   464  3662   645  1761]
 [    0   394  7000  2380     0     0     0     0]
 [  566     0     0  8095  2473   898     0     0]
 [  132     0     0     0 20249    93     0     0]
 [   29     0     0    33  1007  7938   173     0]
 [ 2051     0     0     1   507  2935 15253  1063]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.83      0.83     29840
     Walking       0.94      0.24      0.38     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.38      0.67      0.49     12032
         Car       0.78      0.99      0.87     20474
         Bus       0.49      0.86      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.71      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[24910     0     0   214  1340   908  2102   366]
 [ 3155  5888    23 10655   466  3523   725  1708]
 [    0   223  7000  2551     0     0     0     0]
 [  484     0     0  8141  2589   818     0     0]
 [  176     0     0     2 20200    96     0     0]
 [   68     0     0     7   889  8145    71     0]
 [ 1886     0     0     0   529  2972 15440   983]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.81      0.83      0.82     29840
     Walking       0.96      0.23      0.37     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.38      0.68      0.48     12032
         Car       0.78      0.99      0.87     20474
         Bus       0.49      0.89      0.64      9180
       Train       0.52      0.71      0.60     21810
      Subway       0.78      0.49      0.60     21707

    accuracy                           0.66    150960
   macro avg       0.72      0.69      0.65    150960
weighted avg       0.74      0.66      0.65    150960

training set : Hips ; testing set : Bag; test order: 1
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.01
predict lgb
Time elapsed for testing lgb: 1.23
predict xgb
Time elapsed for testing xgb: 2.62
training set : Hips ; testing set : Bag  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[27447    11     0   176   383   113   531  1179]
 [ 3906  2036    17 15510   445  2000   464  1765]
 [    0  1362  7000  1412     0     0     0     0]
 [  975     0     0  5846  4337   874     0     0]
 [  110     0     0    21 18634  1709     0     0]
 [   20     0     0   528  2996  5392   244     0]
 [  719     0     0   120  2471   755 16665  1080]
 [    0     0     0     0     0     0  2288 19419]]
              precision    recall  f1-score   support

       Still       0.83      0.92      0.87     29840
     Walking       0.60      0.08      0.14     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.25      0.49      0.33     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.50      0.59      0.54      9180
       Train       0.83      0.76      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.68      0.67      0.64    150960
weighted avg       0.71      0.68      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[27567     0     0   150   321    76   532  1194]
 [ 3899  1739    27 15738   456  2009   508  1767]
 [    0  1391  7000  1383     0     0     0     0]
 [  943     0     0  6121  4187   781     0     0]
 [   87     0     0    10 18642  1735     0     0]
 [   28     0     0   498  2860  5511   283     0]
 [  676     0     0   100  2498   747 16709  1080]
 [    0     0     0     0     0     0  2289 19418]]
              precision    recall  f1-score   support

       Still       0.83      0.92      0.87     29840
     Walking       0.56      0.07      0.12     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.26      0.51      0.34     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.51      0.60      0.55      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.68      0.67      0.64    150960
weighted avg       0.70      0.68      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[27562     0     0   140   311    95   540  1192]
 [ 3972  1665    32 15703   496  1964   526  1785]
 [    0  1431  7000  1343     0     0     0     0]
 [  919     0     0  6048  4297   768     0     0]
 [   86     0     0    13 18631  1744     0     0]
 [   35     0     0   518  2860  5492   275     0]
 [  668     0     0   102  2503   722 16755  1060]
 [    0     0     0     0     0     0  2290 19417]]
              precision    recall  f1-score   support

       Still       0.83      0.92      0.87     29840
     Walking       0.54      0.06      0.11     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.25      0.50      0.34     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.51      0.60      0.55      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.68      0.67      0.64    150960
weighted avg       0.70      0.68      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[27604     0     0   142   286    98   518  1192]
 [ 4137  1592    33 15748   510  1865   494  1764]
 [    0  1445  7000  1329     0     0     0     0]
 [  879     0     0  6067  4272   814     0     0]
 [   88     0     0    14 18665  1707     0     0]
 [   43     0     0   519  2808  5540   270     0]
 [  631     0     0   105  2555   751 16715  1053]
 [    0     0     0     0     0     0  2291 19416]]
              precision    recall  f1-score   support

       Still       0.83      0.93      0.87     29840
     Walking       0.52      0.06      0.11     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.25      0.50      0.34     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.51      0.60      0.56      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.68      0.67      0.64    150960
weighted avg       0.70      0.68      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[27640     0     0   137   283   100   493  1187]
 [ 4244  1491    36 15746   504  1861   506  1755]
 [    0  1432  7000  1342     0     0     0     0]
 [  874     0     0  6148  4260   750     0     0]
 [   89     0     0    14 18663  1708     0     0]
 [   48     0     0   510  2735  5637   250     0]
 [  617     0     0   106  2612   741 16684  1050]
 [    0     0     0     0     0     0  2291 19416]]
              precision    recall  f1-score   support

       Still       0.82      0.93      0.87     29840
     Walking       0.51      0.06      0.10     26143
         Run       0.99      0.72      0.83      9774
        Bike       0.26      0.51      0.34     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.52      0.61      0.56      9180
       Train       0.82      0.76      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.68      0.67      0.64    150960
weighted avg       0.69      0.68      0.65    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[27513     0     0   173   259   122   586  1187]
 [ 4523  1338    54 15465   570  1885   585  1723]
 [    0  1414  7000  1360     0     0     0     0]
 [ 1012     0     0  6241  4236   543     0     0]
 [  111     0     0    16 18613  1734     0     0]
 [   78     0     0   429  2757  5792   124     0]
 [  356     0     0   109  2842   742 16746  1015]
 [    0     0     0     0     0     0  2295 19412]]
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.49      0.05      0.09     26143
         Run       0.99      0.72      0.83      9774
        Bike       0.26      0.52      0.35     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.54      0.63      0.58      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.68    150960
   macro avg       0.67      0.68      0.64    150960
weighted avg       0.69      0.68      0.64    150960

training set : Hips ; testing set : Hand; test order: 2
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.95
predict lgb
Time elapsed for testing lgb: 1.37
predict xgb
Time elapsed for testing xgb: 2.72
training set : Hips ; testing set : Hand  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[25776   257     0   697   583  1135   364  1028]
 [ 1386 11769     8 11496    13    45   333  1093]
 [    0   622  7000  2152     0     0     0     0]
 [   13     0     0 11882   137     0     0     0]
 [  494   183     0   647 18134  1016     0     0]
 [    6     0     0   284  3361  5147   382     0]
 [  963     0     0   730  2828    94 16016  1179]
 [    0     0     0     0     0     0  2268 19439]]
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.92      0.45      0.60     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.43      0.99      0.60     12032
         Car       0.72      0.89      0.80     20474
         Bus       0.69      0.56      0.62      9180
       Train       0.83      0.73      0.78     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.76      0.75    150960
weighted avg       0.82      0.76      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25931   293     0   688   593  1067   215  1053]
 [ 1224 11893    12 11536    47    12   313  1106]
 [    0   656  7000  2118     0     0     0     0]
 [    4     0     0 11899   129     0     0     0]
 [  547   203     0   382 18394   948     0     0]
 [    7     0     0   278  3393  5166   336     0]
 [  949     5     0   736  2851    91 16010  1168]
 [    0     0     0     0     0     0  2263 19444]]
              precision    recall  f1-score   support

       Still       0.90      0.87      0.89     29840
     Walking       0.91      0.45      0.61     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.43      0.99      0.60     12032
         Car       0.72      0.90      0.80     20474
         Bus       0.71      0.56      0.63      9180
       Train       0.84      0.73      0.78     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.75    150960
weighted avg       0.82      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25999   297     0   670   579  1042   187  1066]
 [ 1257 11921    16 11483    71    29   262  1104]
 [    0   720  7000  2054     0     0     0     0]
 [    8     0     0 12024     0     0     0     0]
 [  577   203     0   289 18453   952     0     0]
 [   14     0     0   283  3395  5153   335     0]
 [  840     7     0   767  2875    66 16092  1163]
 [    0     0     0     0     0     0  2257 19450]]
              precision    recall  f1-score   support

       Still       0.91      0.87      0.89     29840
     Walking       0.91      0.46      0.61     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.44      1.00      0.61     12032
         Car       0.73      0.90      0.80     20474
         Bus       0.71      0.56      0.63      9180
       Train       0.84      0.74      0.79     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.75    150960
weighted avg       0.82      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26020   316     0   664   535  1012   209  1084]
 [ 1331 11803    13 11488    52    45   276  1135]
 [    0   626  7000  2148     0     0     0     0]
 [   19     0     0 12013     0     0     0     0]
 [  558   206     0   253 18502   955     0     0]
 [   21     0     0   299  3410  5148   302     0]
 [  813     4     0   721  2897    60 16155  1160]
 [    0     0     0     0     0     0  2253 19454]]
              precision    recall  f1-score   support

       Still       0.90      0.87      0.89     29840
     Walking       0.91      0.45      0.60     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.44      1.00      0.61     12032
         Car       0.73      0.90      0.81     20474
         Bus       0.71      0.56      0.63      9180
       Train       0.84      0.74      0.79     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.75    150960
weighted avg       0.82      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[25975   358     0   724   479   973   231  1100]
 [ 1354 11614    12 11584    53    53   275  1198]
 [    0   671  7000  2103     0     0     0     0]
 [   21     0     0 12011     0     0     0     0]
 [  539   206     0   221 18519   989     0     0]
 [   28     0     0   297  3446  5127   282     0]
 [  790     0     0   746  2937    29 16152  1156]
 [    0     0     0     0     0     0  2251 19456]]
              precision    recall  f1-score   support

       Still       0.90      0.87      0.89     29840
     Walking       0.90      0.44      0.60     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.43      1.00      0.60     12032
         Car       0.73      0.90      0.81     20474
         Bus       0.71      0.56      0.63      9180
       Train       0.84      0.74      0.79     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.75    150960
weighted avg       0.82      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[25793   376     0   975   337   904   268  1187]
 [ 1514 10841    31 12079    46   129   313  1190]
 [    0   814  7000  1960     0     0     0     0]
 [   36     0     0 11996     0     0     0     0]
 [  589   169     0    29 18595  1092     0     0]
 [   26     0     0   330  3373  5191   260     0]
 [  563     0     0   664  3003     0 16464  1116]
 [    0     0     0     0     0     0  2240 19467]]
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.89      0.41      0.57     26143
         Run       1.00      0.72      0.83      9774
        Bike       0.43      1.00      0.60     12032
         Car       0.73      0.91      0.81     20474
         Bus       0.71      0.57      0.63      9180
       Train       0.84      0.75      0.80     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.76      0.75    150960
weighted avg       0.82      0.76      0.76    150960

training set : Hips ; testing set : Hips; test order: 3
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.99
predict lgb
Time elapsed for testing lgb: 1.42
predict xgb
Time elapsed for testing xgb: 2.91
training set : Hips ; testing set : Hips  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[25344   146     0    78   396    82  3638   156]
 [ 1176 20876    13  2994     7    53   770   254]
 [    0  1972  7285   517     0     0     0     0]
 [  459   195     0 11205   173     0     0     0]
 [  624    52     0     0 18128  1670     0     0]
 [    9    23     0    45  2779  5968   356     0]
 [  508     4     0    49  4201   357 15791   900]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.85      0.87     29840
     Walking       0.90      0.80      0.84     26143
         Run       1.00      0.75      0.85      9774
        Bike       0.75      0.93      0.83     12032
         Car       0.71      0.89      0.79     20474
         Bus       0.73      0.65      0.69      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.76    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.76      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25350   153     0   115   373    68  3622   159]
 [ 1121 21158    28  2658    23    44   802   309]
 [    0  1979  7274   521     0     0     0     0]
 [  392   150     0 11413    77     0     0     0]
 [  435    68     0     0 18319  1652     0     0]
 [   38    49     0    49  2784  5970   290     0]
 [  425     7     0    89  4412   176 15764   937]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.85      0.88     29840
     Walking       0.90      0.81      0.85     26143
         Run       1.00      0.74      0.85      9774
        Bike       0.77      0.95      0.85     12032
         Car       0.70      0.89      0.79     20474
         Bus       0.75      0.65      0.70      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25267   176     0   126   378    71  3639   183]
 [ 1085 21140    38  2600    24    38   824   394]
 [    0  1982  7256   536     0     0     0     0]
 [  382    32     0 11597    21     0     0     0]
 [  409    88     0     0 18331  1646     0     0]
 [   38    61     0    50  2798  5933   300     0]
 [  428    21     0    94  4462    93 15784   928]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.81      0.85     26143
         Run       0.99      0.74      0.85      9774
        Bike       0.77      0.96      0.86     12032
         Car       0.70      0.90      0.79     20474
         Bus       0.76      0.65      0.70      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[25255   176     0   155   364    54  3638   198]
 [ 1082 21165    39  2604    30    33   791   399]
 [    0  1984  7230   560     0     0     0     0]
 [  344    14     0 11647    27     0     0     0]
 [  350    89     0     0 18412  1623     0     0]
 [   46    68     0    27  2771  5951   317     0]
 [  375    28     0   102  4481    77 15787   960]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.81      0.85     26143
         Run       0.99      0.74      0.85      9774
        Bike       0.77      0.97      0.86     12032
         Car       0.71      0.90      0.79     20474
         Bus       0.77      0.65      0.70      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[25265   174     0   169   352    46  3631   203]
 [ 1096 21107    40  2640    39    42   788   391]
 [    0  1974  7216   584     0     0     0     0]
 [  282     0     0 11735    15     0     0     0]
 [  316    84     0     0 18456  1618     0     0]
 [   49    82     0     9  2704  5998   338     0]
 [  378    26     0   106  4477    74 15793   956]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.81      0.85     26143
         Run       0.99      0.74      0.85      9774
        Bike       0.77      0.98      0.86     12032
         Car       0.71      0.90      0.79     20474
         Bus       0.77      0.65      0.71      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[25339   205     0   177   208    58  3573   280]
 [ 1068 21024    48  2606   109    37   770   481]
 [    0  1922  7128   724     0     0     0     0]
 [  303     0     0 11729     0     0     0     0]
 [  284   115     0     0 18493  1582     0     0]
 [    8   108     0     0  2783  6026   255     0]
 [  423    27     0    93  4550     0 15826   891]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.80      0.85     26143
         Run       0.99      0.73      0.84      9774
        Bike       0.77      0.97      0.86     12032
         Car       0.71      0.90      0.79     20474
         Bus       0.78      0.66      0.71      9180
       Train       0.50      0.73      0.59     21810
      Subway       0.87      0.49      0.62     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.77      0.77    150960
weighted avg       0.80      0.77      0.77    150960

training set:Bag,the 1th training set
begin training
X_train: (1050525, 204)
y_train: 1050525
Training rf...
Time elapsed for training rf: 303.65
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.730150 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 51976
[LightGBM] [Info] Number of data points in the train set: 840420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.150854
[LightGBM] [Info] Start training from score -2.147537
[LightGBM] [Info] Start training from score -2.234159
[LightGBM] [Info] Start training from score -2.192002
[LightGBM] [Info] Start training from score -1.889219
[LightGBM] [Info] Start training from score -2.005081
[LightGBM] [Info] Start training from score -1.905076
[LightGBM] [Info] Start training from score -2.176673
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.49833
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.19571
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 0.986181
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[4]	valid_0's multi_logloss: 0.827848
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.703011
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.601775
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[7]	valid_0's multi_logloss: 0.519249
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.45052
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.394023
[10]	valid_0's multi_logloss: 0.346082
[11]	valid_0's multi_logloss: 0.3052
[12]	valid_0's multi_logloss: 0.270594
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[13]	valid_0's multi_logloss: 0.241208
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[14]	valid_0's multi_logloss: 0.21558
[15]	valid_0's multi_logloss: 0.193484
[16]	valid_0's multi_logloss: 0.174848
[17]	valid_0's multi_logloss: 0.15846
[18]	valid_0's multi_logloss: 0.143943
[19]	valid_0's multi_logloss: 0.131161
[20]	valid_0's multi_logloss: 0.120456
[21]	valid_0's multi_logloss: 0.110745
[22]	valid_0's multi_logloss: 0.102219
[23]	valid_0's multi_logloss: 0.0949646
[24]	valid_0's multi_logloss: 0.0884832
[25]	valid_0's multi_logloss: 0.0825692
[26]	valid_0's multi_logloss: 0.0766524
[27]	valid_0's multi_logloss: 0.0718531
[28]	valid_0's multi_logloss: 0.0671908
[29]	valid_0's multi_logloss: 0.0635933
[30]	valid_0's multi_logloss: 0.0601914
[31]	valid_0's multi_logloss: 0.0570228
[32]	valid_0's multi_logloss: 0.0543628
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[33]	valid_0's multi_logloss: 0.0517503
[34]	valid_0's multi_logloss: 0.048912
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[35]	valid_0's multi_logloss: 0.0465686
[36]	valid_0's multi_logloss: 0.0444721
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.0423708
[38]	valid_0's multi_logloss: 0.0406008
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[39]	valid_0's multi_logloss: 0.0388987
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[40]	valid_0's multi_logloss: 0.0372329
[41]	valid_0's multi_logloss: 0.0357597
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0345252
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[43]	valid_0's multi_logloss: 0.0329504
[44]	valid_0's multi_logloss: 0.0316783
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0305071
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0294728
[47]	valid_0's multi_logloss: 0.028388
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0274739
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0264543
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0257064
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0248818
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0239916
[53]	valid_0's multi_logloss: 0.0232903
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0225538
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0218968
[56]	valid_0's multi_logloss: 0.021369
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0206992
[58]	valid_0's multi_logloss: 0.0199578
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0193025
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0186991
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0181452
[62]	valid_0's multi_logloss: 0.017678
[63]	valid_0's multi_logloss: 0.0170806
[64]	valid_0's multi_logloss: 0.0165117
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0160808
[66]	valid_0's multi_logloss: 0.0157198
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0153191
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0148865
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0144523
[70]	valid_0's multi_logloss: 0.0141224
[71]	valid_0's multi_logloss: 0.0137407
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0134313
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0130817
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0128344
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0125456
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0122444
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0119035
[78]	valid_0's multi_logloss: 0.0115566
[79]	valid_0's multi_logloss: 0.0113407
[80]	valid_0's multi_logloss: 0.0110802
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0107722
[82]	valid_0's multi_logloss: 0.010508
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.0102841
[84]	valid_0's multi_logloss: 0.0100546
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.00987681
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.00961529
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.00941657
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.00919442
[89]	valid_0's multi_logloss: 0.00902223
[90]	valid_0's multi_logloss: 0.00886443
[91]	valid_0's multi_logloss: 0.00866913
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[92]	valid_0's multi_logloss: 0.00845205
[93]	valid_0's multi_logloss: 0.0083147
[94]	valid_0's multi_logloss: 0.00817135
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.00797932
[96]	valid_0's multi_logloss: 0.00781875
[97]	valid_0's multi_logloss: 0.00766322
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.00751856
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.00737435
[100]	valid_0's multi_logloss: 0.00721613
Time elapsed for training LightGBM: 295.77
Training XGBoost...
Time elapsed for training XGBoost: 560.4
begin testing
training set : Bag ; testing set : Torso; test order: 0
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.04
predict lgb
Time elapsed for testing lgb: 1.2
predict xgb
Time elapsed for testing xgb: 2.8
training set : Bag ; testing set : Torso  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[23453   881     0    17   152  2238  2471   628]
 [  866 24394     7   114    97   367   199    99]
 [    0  1881  7893     0     0     0     0     0]
 [  267  3707     0  5472  2193   337    56     0]
 [  426   252     0     0 12890  5509  1397     0]
 [  113    36     0     0     0  8585   446     0]
 [ 1788   123     0    19   981  2493 16281   125]
 [    0     2     0     0     0     0 11099 10606]]
              precision    recall  f1-score   support

       Still       0.87      0.79      0.83     29840
     Walking       0.78      0.93      0.85     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.97      0.45      0.62     12032
         Car       0.79      0.63      0.70     20474
         Bus       0.44      0.94      0.60      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.72      0.72    150960
weighted avg       0.79      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[23358   928     0    35   127  2248  2523   621]
 [  751 24678    24    72    34   286   189   109]
 [    0  1880  7894     0     0     0     0     0]
 [  214  3741     0  5465  2242   324    46     0]
 [  438   261     0     0 13025  5584  1166     0]
 [   33    41     0     0     0  8665   441     0]
 [ 1928   141     0     0   916  2482 16230   113]
 [    0     3     0     0     0     0 11099 10605]]
              precision    recall  f1-score   support

       Still       0.87      0.78      0.83     29840
     Walking       0.78      0.94      0.85     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.98      0.45      0.62     12032
         Car       0.80      0.64      0.71     20474
         Bus       0.44      0.94      0.60      9180
       Train       0.51      0.74      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.73      0.72    150960
weighted avg       0.79      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[23353   979     0    41    91  2236  2502   638]
 [  779 24637    29    66    26   261   209   136]
 [    0  1879  7895     0     0     0     0     0]
 [  282  3595     0  5567  2271   317     0     0]
 [  378   273     0     0 13087  5586  1150     0]
 [    0    35     0     0     0  8708   437     0]
 [ 1996   143     0     0   916  2460 16223    72]
 [    0     3     0     0     0     0 11099 10605]]
              precision    recall  f1-score   support

       Still       0.87      0.78      0.82     29840
     Walking       0.78      0.94      0.85     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.98      0.46      0.63     12032
         Car       0.80      0.64      0.71     20474
         Bus       0.45      0.95      0.61      9180
       Train       0.51      0.74      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.73      0.72    150960
weighted avg       0.79      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[23329   987     0    40    85  2269  2491   639]
 [  742 24633    32    57    19   298   176   186]
 [    0  1879  7895     0     0     0     0     0]
 [  285  3700     0  5620  2141   286     0     0]
 [  392   272     0     0 13058  5603  1149     0]
 [    0    36     0     0     0  8709   435     0]
 [ 1951   150     0     0   940  2453 16270    46]
 [    0     3     0     0     0     0 11099 10605]]
              precision    recall  f1-score   support

       Still       0.87      0.78      0.83     29840
     Walking       0.78      0.94      0.85     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.98      0.47      0.63     12032
         Car       0.80      0.64      0.71     20474
         Bus       0.44      0.95      0.60      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.92      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.73      0.72    150960
weighted avg       0.79      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[23226  1019     0    33    95  2273  2528   666]
 [  724 24687    35    51    13   297   130   206]
 [    0  1879  7895     0     0     0     0     0]
 [  259  3718     0  5623  2147   285     0     0]
 [  395   275     0     0 13031  5619  1154     0]
 [    0    39     0     0     0  8707   434     0]
 [ 1899   158     0     0   947  2459 16307    40]
 [    0     4     0     0     0     0 11099 10604]]
              precision    recall  f1-score   support

       Still       0.88      0.78      0.82     29840
     Walking       0.78      0.94      0.85     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.99      0.47      0.63     12032
         Car       0.80      0.64      0.71     20474
         Bus       0.44      0.95      0.60      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.92      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.73      0.72    150960
weighted avg       0.79      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[22942  1305     0    19   121  2272  2535   646]
 [  580 24787    53    10     0   247   127   339]
 [    0  1878  7896     0     0     0     0     0]
 [  385  3381     0  5781  2221   264     0     0]
 [  411   328     0     0 13049  5669  1017     0]
 [    0    39     0     0     0  8732   409     0]
 [ 1869   145     0     0   856  2594 16338     8]
 [    0     4     0     0     0     0 11099 10604]]
              precision    recall  f1-score   support

       Still       0.88      0.77      0.82     29840
     Walking       0.78      0.95      0.85     26143
         Run       0.99      0.81      0.89      9774
        Bike       1.00      0.48      0.65     12032
         Car       0.80      0.64      0.71     20474
         Bus       0.44      0.95      0.60      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.79      0.73      0.72    150960
weighted avg       0.79      0.73      0.73    150960

training set : Bag ; testing set : Bag; test order: 1
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.03
predict lgb
Time elapsed for testing lgb: 1.28
predict xgb
Time elapsed for testing xgb: 2.74
training set : Bag ; testing set : Bag  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26473   626     0    43   285   219  1775   419]
 [  792 24173    14   756    70    79   155   104]
 [    0  1431  8343     0     0     0     0     0]
 [   80  2284     0  9252   265   151     0     0]
 [  352    89     0     0 17811  1963   259     0]
 [    6    57     0    54  2018  6450   595     0]
 [  609    60     0    83  2283   768 17727   280]
 [    0     2     0     0     0     0  2287 19418]]
              precision    recall  f1-score   support

       Still       0.94      0.89      0.91     29840
     Walking       0.84      0.92      0.88     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.91      0.77      0.83     12032
         Car       0.78      0.87      0.82     20474
         Bus       0.67      0.70      0.69      9180
       Train       0.78      0.81      0.79     21810
      Subway       0.96      0.89      0.93     21707

    accuracy                           0.86    150960
   macro avg       0.86      0.84      0.85    150960
weighted avg       0.87      0.86      0.86    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[26505   702     0    48   239   179  1690   477]
 [  727 24259    28   734    75    70   133   117]
 [    0  1491  8283     0     0     0     0     0]
 [   69  2176     0  9537   200    50     0     0]
 [  322    91     0     0 17990  1937   134     0]
 [    2    84     0     0  2015  6521   558     0]
 [  587    93     0    64  2287   751 17783   245]
 [    0     2     0     0     0     0  2288 19417]]
              precision    recall  f1-score   support

       Still       0.94      0.89      0.91     29840
     Walking       0.84      0.93      0.88     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.92      0.79      0.85     12032
         Car       0.79      0.88      0.83     20474
         Bus       0.69      0.71      0.70      9180
       Train       0.79      0.82      0.80     21810
      Subway       0.96      0.89      0.93     21707

    accuracy                           0.86    150960
   macro avg       0.86      0.84      0.85    150960
weighted avg       0.87      0.86      0.86    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[26493   749     0    43   218   157  1630   550]
 [  739 24262    36   719    79    47   118   143]
 [    0  1496  8278     0     0     0     0     0]
 [   89  2200     0  9538   177    28     0     0]
 [  328    93     0     0 18223  1785    45     0]
 [    2    79     0     0  1908  6656   535     0]
 [  588   104     0    65  2323   753 17747   230]
 [    0     2     0     0     0     0  2289 19416]]
              precision    recall  f1-score   support

       Still       0.94      0.89      0.91     29840
     Walking       0.84      0.93      0.88     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.92      0.79      0.85     12032
         Car       0.79      0.89      0.84     20474
         Bus       0.71      0.73      0.72      9180
       Train       0.79      0.81      0.80     21810
      Subway       0.95      0.89      0.92     21707

    accuracy                           0.87    150960
   macro avg       0.87      0.85      0.86    150960
weighted avg       0.87      0.87      0.87    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26411   782     0    38   221   201  1612   575]
 [  737 24203    37   720    83    65   121   177]
 [    0  1498  8276     0     0     0     0     0]
 [  109  2125     0  9614   184     0     0     0]
 [  332   113     0     0 18253  1776     0     0]
 [    1    77     0     0  1863  6724   515     0]
 [  567   109     0    61  2406   775 17667   225]
 [    0     2     0     0     0     0  2290 19415]]
              precision    recall  f1-score   support

       Still       0.94      0.89      0.91     29840
     Walking       0.84      0.93      0.88     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.92      0.80      0.86     12032
         Car       0.79      0.89      0.84     20474
         Bus       0.70      0.73      0.72      9180
       Train       0.80      0.81      0.80     21810
      Subway       0.95      0.89      0.92     21707

    accuracy                           0.86    150960
   macro avg       0.87      0.85      0.86    150960
weighted avg       0.87      0.86      0.87    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[26383   821     0    30   218   193  1641   554]
 [  731 24198    37   715    84    68   117   193]
 [    0  1501  8273     0     0     0     0     0]
 [  119  2097     0  9625   191     0     0     0]
 [  337   108     0     0 18193  1836     0     0]
 [    0    79     0     0  1845  6765   491     0]
 [  501   110     0    59  2458   790 17671   221]
 [    0     3     0     0     0     0  2290 19414]]
              precision    recall  f1-score   support

       Still       0.94      0.88      0.91     29840
     Walking       0.84      0.93      0.88     26143
         Run       1.00      0.85      0.91      9774
        Bike       0.92      0.80      0.86     12032
         Car       0.79      0.89      0.84     20474
         Bus       0.70      0.74      0.72      9180
       Train       0.80      0.81      0.80     21810
      Subway       0.95      0.89      0.92     21707

    accuracy                           0.86    150960
   macro avg       0.87      0.85      0.86    150960
weighted avg       0.87      0.86      0.87    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26263  1001     0     6   245   244  1439   642]
 [  641 24201    38   660   118    51   106   328]
 [    0  1489  8285     0     0     0     0     0]
 [  153  2033     0  9666   143    37     0     0]
 [  325    84     0     0 18154  1911     0     0]
 [    0   108     0     0  1826  6826   420     0]
 [  480   149     0    13  2685   841 17467   175]
 [    0     3     0     0     0     0  2291 19413]]
              precision    recall  f1-score   support

       Still       0.94      0.88      0.91     29840
     Walking       0.83      0.93      0.88     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.93      0.80      0.86     12032
         Car       0.78      0.89      0.83     20474
         Bus       0.69      0.74      0.72      9180
       Train       0.80      0.80      0.80     21810
      Subway       0.94      0.89      0.92     21707

    accuracy                           0.86    150960
   macro avg       0.87      0.85      0.85    150960
weighted avg       0.87      0.86      0.86    150960

training set : Bag ; testing set : Hand; test order: 2
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.41
predict lgb
Time elapsed for testing lgb: 1.32
predict xgb
Time elapsed for testing xgb: 2.71
training set : Bag ; testing set : Hand  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[25215  1470     0   515   112   774   799   955]
 [  717 23706     5  1316     0    24   155   220]
 [    0  1486  8287     1     0     0     0     0]
 [   76  1550     0 10288    85    33     0     0]
 [  461   771     0  1487 14749  2070   936     0]
 [    0     0     0   368  2674  6105    33     0]
 [  776   145     0   320  2163   232 18095    79]
 [    0     1     0     0     0     0  2272 19434]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.88     29840
     Walking       0.81      0.91      0.86     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.72      0.86      0.78     12032
         Car       0.75      0.72      0.73     20474
         Bus       0.66      0.67      0.66      9180
       Train       0.81      0.83      0.82     21810
      Subway       0.94      0.90      0.92     21707

    accuracy                           0.83    150960
   macro avg       0.83      0.82      0.82    150960
weighted avg       0.84      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25269  1461     0   406    74   778   915   937]
 [  695 23815    20  1217     0    32   156   208]
 [    0  1495  8279     0     0     0     0     0]
 [   54  1414     0 10486    65    13     0     0]
 [  484   719     0  1281 15080  2077   833     0]
 [    0     0     0   262  2815  6091    12     0]
 [  678   151     0   321  2178   172 18238    72]
 [    0     3     0     0     0     0  2270 19434]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.82      0.91      0.86     26143
         Run       1.00      0.85      0.92      9774
        Bike       0.75      0.87      0.81     12032
         Car       0.75      0.74      0.74     20474
         Bus       0.66      0.66      0.66      9180
       Train       0.81      0.84      0.82     21810
      Subway       0.94      0.90      0.92     21707

    accuracy                           0.84    150960
   macro avg       0.83      0.83      0.83    150960
weighted avg       0.84      0.84      0.84    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25450  1413     0   364    44   780   859   930]
 [  669 23750    25  1191     0    57   177   274]
 [    0  1515  8259     0     0     0     0     0]
 [   65  1426     0 10520    21     0     0     0]
 [  515   718     0  1060 15316  2121   744     0]
 [    6     0     0   244  2743  6160    27     0]
 [  640   150     0   301  2123   211 18316    69]
 [    0     9     0     0     0     0  2268 19430]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.82      0.91      0.86     26143
         Run       1.00      0.84      0.91      9774
        Bike       0.77      0.87      0.82     12032
         Car       0.76      0.75      0.75     20474
         Bus       0.66      0.67      0.67      9180
       Train       0.82      0.84      0.83     21810
      Subway       0.94      0.90      0.92     21707

    accuracy                           0.84    150960
   macro avg       0.84      0.83      0.83    150960
weighted avg       0.85      0.84      0.84    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[25448  1489     0   351     0   783   841   928]
 [  542 23814    33  1123     0   112   183   336]
 [    0  1511  8263     0     0     0     0     0]
 [   71  1429     0 10532     0     0     0     0]
 [  552   713     0  1079 15283  2186   661     0]
 [    9     3     0   237  2729  6185    17     0]
 [  646   179     0   269  2089   193 18362    72]
 [    0    11     0     0     0     0  2265 19431]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.82      0.91      0.86     26143
         Run       1.00      0.85      0.91      9774
        Bike       0.77      0.88      0.82     12032
         Car       0.76      0.75      0.75     20474
         Bus       0.65      0.67      0.66      9180
       Train       0.82      0.84      0.83     21810
      Subway       0.94      0.90      0.91     21707

    accuracy                           0.84    150960
   macro avg       0.84      0.83      0.83    150960
weighted avg       0.85      0.84      0.84    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[25488  1501     0   350    27   767   784   923]
 [  514 23818    31  1115     0   122   182   361]
 [    0  1536  8238     0     0     0     0     0]
 [   72  1502     0 10458     0     0     0     0]
 [  559   692     0  1058 15381  2193   591     0]
 [    0     4     0   214  2759  6180    23     0]
 [  661   180     0   269  2104   190 18340    66]
 [    0    13     0     0     0     0  2263 19431]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.81      0.91      0.86     26143
         Run       1.00      0.84      0.91      9774
        Bike       0.78      0.87      0.82     12032
         Car       0.76      0.75      0.75     20474
         Bus       0.65      0.67      0.66      9180
       Train       0.83      0.84      0.83     21810
      Subway       0.94      0.90      0.91     21707

    accuracy                           0.84    150960
   macro avg       0.84      0.83      0.83    150960
weighted avg       0.85      0.84      0.84    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[25401  1628     0   343    35   796   744   893]
 [  462 23872    29  1105     0   113   195   367]
 [    0  1544  8230     0     0     0     0     0]
 [   97  1375     0 10560     0     0     0     0]
 [  448   730     0   917 15697  2328   354     0]
 [    5     9     0   220  2777  6169     0     0]
 [  386   225     0   156  2472   133 18434     4]
 [    0    15     0     0     0     0  2255 19437]]
              precision    recall  f1-score   support

       Still       0.95      0.85      0.90     29840
     Walking       0.81      0.91      0.86     26143
         Run       1.00      0.84      0.91      9774
        Bike       0.79      0.88      0.83     12032
         Car       0.75      0.77      0.76     20474
         Bus       0.65      0.67      0.66      9180
       Train       0.84      0.85      0.84     21810
      Subway       0.94      0.90      0.92     21707

    accuracy                           0.85    150960
   macro avg       0.84      0.83      0.83    150960
weighted avg       0.85      0.85      0.85    150960

training set : Bag ; testing set : Hips; test order: 3
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.07
predict lgb
Time elapsed for testing lgb: 1.22
predict xgb
Time elapsed for testing xgb: 2.83
training set : Bag ; testing set : Hips  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[23341  1871     0    20    44   859  3594   111]
 [  665 24421    11    86     0   154   544   262]
 [    0   939  8835     0     0     0     0     0]
 [  125  6106     0  5770    31     0     0     0]
 [  529   130     0     0 11623  3631  4561     0]
 [   11    14     0    23  1163  7378   591     0]
 [  849    75     0     2  1514  1097 18230    43]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.78      0.84     29840
     Walking       0.73      0.93      0.82     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.98      0.48      0.64     12032
         Car       0.81      0.57      0.67     20474
         Bus       0.56      0.80      0.66      9180
       Train       0.47      0.84      0.60     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.72      0.73    150960
weighted avg       0.80      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[23428  1910     0    32    43   723  3597   107]
 [  547 24514    26    87     0   123   530   316]
 [    0   938  8836     0     0     0     0     0]
 [   73  6264     0  5695     0     0     0     0]
 [  539   140     0     0 11585  3630  4580     0]
 [   28    33     0     0  1146  7366   607     0]
 [  767   100     0     0  1567  1079 18275    22]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.79      0.85     29840
     Walking       0.72      0.94      0.82     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.98      0.47      0.64     12032
         Car       0.81      0.57      0.67     20474
         Bus       0.57      0.80      0.67      9180
       Train       0.47      0.84      0.60     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.72      0.73    150960
weighted avg       0.80      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[23443  1886     0    28    44   745  3588   106]
 [  521 24549    28    78     0    92   511   364]
 [    0   936  8838     0     0     0     0     0]
 [   77  6360     0  5595     0     0     0     0]
 [  496   138     0     0 11582  3612  4646     0]
 [   29    37     0     0  1202  7308   604     0]
 [  668   121     0     5  1585  1121 18309     1]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.79      0.85     29840
     Walking       0.72      0.94      0.82     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.98      0.47      0.63     12032
         Car       0.80      0.57      0.66     20474
         Bus       0.57      0.80      0.66      9180
       Train       0.47      0.84      0.60     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.72      0.73    150960
weighted avg       0.80      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[23452  1903     0    16    27   777  3555   110]
 [  532 24554    29    50     0    80   524   374]
 [    0   935  8839     0     0     0     0     0]
 [   85  6364     0  5583     0     0     0     0]
 [  506   168     0     0 11583  3608  4609     0]
 [   28    28     0     0  1206  7312   606     0]
 [  628   128     0     0  1615  1147 18292     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.79      0.85     29840
     Walking       0.72      0.94      0.82     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.99      0.46      0.63     12032
         Car       0.80      0.57      0.66     20474
         Bus       0.57      0.80      0.66      9180
       Train       0.47      0.84      0.60     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.72      0.73    150960
weighted avg       0.80      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[23483  1873     0    16    29   776  3548   115]
 [  541 24528    29    52     0    91   530   372]
 [    0   934  8840     0     0     0     0     0]
 [   94  6303     0  5635     0     0     0     0]
 [  507   187     0     0 11574  3595  4611     0]
 [   27    29     0     0  1197  7320   607     0]
 [  632   132     0     0  1661  1154 18231     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.79      0.85     29840
     Walking       0.72      0.94      0.82     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.99      0.47      0.64     12032
         Car       0.80      0.57      0.66     20474
         Bus       0.57      0.80      0.66      9180
       Train       0.47      0.84      0.60     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.72      0.73    150960
weighted avg       0.80      0.73      0.73    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[23352  2280     0    17    19   527  3520   125]
 [  526 24479    30    56     0    86   502   464]
 [    0   937  8837     0     0     0     0     0]
 [  138  6031     0  5863     0     0     0     0]
 [  531   210     0     0 11633  3567  4533     0]
 [   14    20     0     0  1181  7355   610     0]
 [  677   148     0     0  1753  1074 18158     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.78      0.85     29840
     Walking       0.72      0.94      0.81     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.99      0.49      0.65     12032
         Car       0.80      0.57      0.66     20474
         Bus       0.58      0.80      0.68      9180
       Train       0.47      0.83      0.60     21810
      Subway       0.95      0.49      0.64     21707

    accuracy                           0.73    150960
   macro avg       0.80      0.73      0.73    150960
weighted avg       0.80      0.73      0.73    150960

training set:Hand,the 2th training set
begin training
X_train: (1050525, 204)
y_train: 1050525
Training rf...
Time elapsed for training rf: 304.97
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.753865 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 52001
[LightGBM] [Info] Number of data points in the train set: 840420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.150160
[LightGBM] [Info] Start training from score -2.145573
[LightGBM] [Info] Start training from score -2.235949
[LightGBM] [Info] Start training from score -2.192023
[LightGBM] [Info] Start training from score -1.889660
[LightGBM] [Info] Start training from score -2.001588
[LightGBM] [Info] Start training from score -1.907398
[LightGBM] [Info] Start training from score -2.178226
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.52231
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.22846
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 1.02418
[4]	valid_0's multi_logloss: 0.869089
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.746825
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.648268
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[7]	valid_0's multi_logloss: 0.568291
[8]	valid_0's multi_logloss: 0.501566
[9]	valid_0's multi_logloss: 0.44562
[10]	valid_0's multi_logloss: 0.398562
[11]	valid_0's multi_logloss: 0.358273
[12]	valid_0's multi_logloss: 0.32378
[13]	valid_0's multi_logloss: 0.293804
[14]	valid_0's multi_logloss: 0.268241
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[15]	valid_0's multi_logloss: 0.246215
[16]	valid_0's multi_logloss: 0.226023
[17]	valid_0's multi_logloss: 0.208516
[18]	valid_0's multi_logloss: 0.192971
[19]	valid_0's multi_logloss: 0.179652
[20]	valid_0's multi_logloss: 0.16795
[21]	valid_0's multi_logloss: 0.157761
[22]	valid_0's multi_logloss: 0.148629
[23]	valid_0's multi_logloss: 0.140475
[24]	valid_0's multi_logloss: 0.133094
[25]	valid_0's multi_logloss: 0.126706
[26]	valid_0's multi_logloss: 0.12067
[27]	valid_0's multi_logloss: 0.115281
[28]	valid_0's multi_logloss: 0.109995
[29]	valid_0's multi_logloss: 0.105382
[30]	valid_0's multi_logloss: 0.100849
[31]	valid_0's multi_logloss: 0.0972595
[32]	valid_0's multi_logloss: 0.0937656
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[33]	valid_0's multi_logloss: 0.090323
[34]	valid_0's multi_logloss: 0.0868344
[35]	valid_0's multi_logloss: 0.0840193
[36]	valid_0's multi_logloss: 0.0809917
[37]	valid_0's multi_logloss: 0.0782835
[38]	valid_0's multi_logloss: 0.0757683
[39]	valid_0's multi_logloss: 0.0732482
[40]	valid_0's multi_logloss: 0.0710818
[41]	valid_0's multi_logloss: 0.0689014
[42]	valid_0's multi_logloss: 0.0669238
[43]	valid_0's multi_logloss: 0.0652262
[44]	valid_0's multi_logloss: 0.0634876
[45]	valid_0's multi_logloss: 0.0616944
[46]	valid_0's multi_logloss: 0.0600667
[47]	valid_0's multi_logloss: 0.0585068
[48]	valid_0's multi_logloss: 0.0569738
[49]	valid_0's multi_logloss: 0.0550311
[50]	valid_0's multi_logloss: 0.0537264
[51]	valid_0's multi_logloss: 0.0521355
[52]	valid_0's multi_logloss: 0.0506151
[53]	valid_0's multi_logloss: 0.0493295
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0483221
[55]	valid_0's multi_logloss: 0.0471657
[56]	valid_0's multi_logloss: 0.0461268
[57]	valid_0's multi_logloss: 0.0451634
[58]	valid_0's multi_logloss: 0.0440933
[59]	valid_0's multi_logloss: 0.0430437
[60]	valid_0's multi_logloss: 0.0419811
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0411169
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0402641
[63]	valid_0's multi_logloss: 0.0394649
[64]	valid_0's multi_logloss: 0.0386369
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.037899
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0371798
[67]	valid_0's multi_logloss: 0.0364489
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0358426
[69]	valid_0's multi_logloss: 0.0351414
[70]	valid_0's multi_logloss: 0.0344492
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0339047
[72]	valid_0's multi_logloss: 0.033171
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0326538
[74]	valid_0's multi_logloss: 0.0319874
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0313902
[76]	valid_0's multi_logloss: 0.0309072
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0304177
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0299506
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0295557
[80]	valid_0's multi_logloss: 0.0290104
[81]	valid_0's multi_logloss: 0.0286125
[82]	valid_0's multi_logloss: 0.028035
[83]	valid_0's multi_logloss: 0.0273755
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0268638
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0264123
[86]	valid_0's multi_logloss: 0.0259472
[87]	valid_0's multi_logloss: 0.0255599
[88]	valid_0's multi_logloss: 0.0251313
[89]	valid_0's multi_logloss: 0.0246803
[90]	valid_0's multi_logloss: 0.0242797
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[91]	valid_0's multi_logloss: 0.0239397
[92]	valid_0's multi_logloss: 0.0235047
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.0231673
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0228271
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.0224562
[96]	valid_0's multi_logloss: 0.0221707
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.0218277
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.0214795
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0212647
[100]	valid_0's multi_logloss: 0.0209395
Time elapsed for training LightGBM: 305.53
Training XGBoost...
Time elapsed for training XGBoost: 507.2
begin testing
training set : Hand ; testing set : Torso; test order: 0
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.87
predict lgb
Time elapsed for testing lgb: 1.27
predict xgb
Time elapsed for testing xgb: 2.93
training set : Hand ; testing set : Torso  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26235    57     0     0   347   515  2369   317]
 [ 2755 19495    16   166   525  2436   429   321]
 [    0  1901  7773   100     0     0     0     0]
 [ 3004   693     0   718  6852   765     0     0]
 [  467    29     0     0 15991  3609   378     0]
 [  286     5     0     0   613  7942   334     0]
 [ 2771     2     0     0  1111  1865 15967    94]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.74      0.88      0.80     29840
     Walking       0.88      0.75      0.81     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.73      0.06      0.11     12032
         Car       0.63      0.78      0.70     20474
         Bus       0.46      0.87      0.60      9180
       Train       0.52      0.73      0.61     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.69    150960
   macro avg       0.74      0.67      0.64    150960
weighted avg       0.74      0.69      0.68    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[26219    75     0     0   315   509  2378   344]
 [ 2622 19534    16   129   580  2460   450   352]
 [    0  1912  7781    81     0     0     0     0]
 [ 2841   738     0   739  6952   762     0     0]
 [  490    30     0     0 16022  3595   337     0]
 [  179     4     0     0   631  8087   279     0]
 [ 2754    12     0     0  1060  1927 15983    74]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.75      0.88      0.81     29840
     Walking       0.88      0.75      0.81     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.78      0.06      0.11     12032
         Car       0.63      0.78      0.70     20474
         Bus       0.47      0.88      0.61      9180
       Train       0.52      0.73      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.70    150960
   macro avg       0.74      0.67      0.65    150960
weighted avg       0.75      0.70      0.68    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[26174    80     0     0   319   565  2351   351]
 [ 2565 19475    20    85   662  2444   464   428]
 [    0  1923  7764    87     0     0     0     0]
 [ 2884   608     0   740  7045   755     0     0]
 [  496    32     0     0 16100  3581   265     0]
 [  150     3     0     0   619  8134   274     0]
 [ 2871    29     0     0   985  1907 15966    52]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.74      0.88      0.81     29840
     Walking       0.88      0.74      0.81     26143
         Run       1.00      0.79      0.88      9774
        Bike       0.81      0.06      0.11     12032
         Car       0.63      0.79      0.70     20474
         Bus       0.47      0.89      0.61      9180
       Train       0.52      0.73      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.70    150960
   macro avg       0.75      0.67      0.65    150960
weighted avg       0.75      0.70      0.68    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26140    93     0     0   325   617  2305   360]
 [ 2511 19478    33    52   633  2507   497   432]
 [    0  1933  7841     0     0     0     0     0]
 [ 2750   520     0   745  7251   766     0     0]
 [  498    34     0     0 16173  3593   176     0]
 [  113     2     0     0   547  8270   248     0]
 [ 2876    37     0     0  1019  1880 15964    34]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.75      0.88      0.81     29840
     Walking       0.88      0.75      0.81     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.93      0.06      0.12     12032
         Car       0.62      0.79      0.70     20474
         Bus       0.47      0.90      0.62      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.70    150960
   macro avg       0.76      0.67      0.65    150960
weighted avg       0.76      0.70      0.68    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[26113    99     0     0   336   618  2319   355]
 [ 2610 19390    41    23   647  2508   490   434]
 [    0  1942  7832     0     0     0     0     0]
 [ 2777   517     0   699  7270   769     0     0]
 [  494    37     0     0 16125  3680   138     0]
 [   67     2     0     0   541  8322   248     0]
 [ 2806    39     0     0   943  1920 16076    26]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.75      0.88      0.81     29840
     Walking       0.88      0.74      0.81     26143
         Run       0.99      0.80      0.89      9774
        Bike       0.97      0.06      0.11     12032
         Car       0.62      0.79      0.70     20474
         Bus       0.47      0.91      0.62      9180
       Train       0.53      0.74      0.62     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.70    150960
   macro avg       0.77      0.67      0.65    150960
weighted avg       0.77      0.70      0.68    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26227   143     0     0   365   666  2093   346]
 [ 2844 18800    55     0   694  2759   474   517]
 [    0  1973  7801     0     0     0     0     0]
 [ 2833   263     0   604  7472   860     0     0]
 [  494    61     0     0 16143  3776     0     0]
 [    2     0     0     0   435  8434   309     0]
 [ 2781    30     0     0  1030  1818 16151     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.75      0.88      0.81     29840
     Walking       0.88      0.72      0.79     26143
         Run       0.99      0.80      0.88      9774
        Bike       1.00      0.05      0.10     12032
         Car       0.62      0.79      0.69     20474
         Bus       0.46      0.92      0.61      9180
       Train       0.54      0.74      0.62     21810
      Subway       0.92      0.49      0.64     21707

    accuracy                           0.69    150960
   macro avg       0.77      0.67      0.64    150960
weighted avg       0.77      0.69      0.67    150960

training set : Hand ; testing set : Bag; test order: 1
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.86
predict lgb
Time elapsed for testing lgb: 1.18
predict xgb
Time elapsed for testing xgb: 2.77
training set : Hand ; testing set : Bag  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26002    64     0     0   948   859   843  1124]
 [ 2296 21287    14   324  1058   528   332   304]
 [    0   786  7880  1108     0     0     0     0]
 [ 2505   238     0     0  7851  1405    33     0]
 [  520     8     0     9 18754  1076   107     0]
 [    8     0     0     0  2442  6508   222     0]
 [  882    36     0     0  3145   843 16809    95]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.81      0.87      0.84     29840
     Walking       0.95      0.81      0.88     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.92      0.69     20474
         Bus       0.58      0.71      0.64      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.77    150960
   macro avg       0.70      0.72      0.70    150960
weighted avg       0.75      0.77      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25996    76     0     0   894   892   890  1092]
 [ 2240 21445    21   206  1030   530   336   335]
 [    0   792  7872  1110     0     0     0     0]
 [ 2408   278     0     0  7948  1393     5     0]
 [  533     6     0     0 18781  1080    74     0]
 [    0     0     0     0  2382  6583   215     0]
 [  843    33     0     0  3254   837 16788    55]
 [    0     0     0     0     0     0  2300 19407]]
              precision    recall  f1-score   support

       Still       0.81      0.87      0.84     29840
     Walking       0.95      0.82      0.88     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.92      0.69     20474
         Bus       0.58      0.72      0.64      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.77    150960
   macro avg       0.70      0.72      0.71    150960
weighted avg       0.75      0.77      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25882    91     0     0   883   918   947  1119]
 [ 2194 21572    27   157   999   449   329   416]
 [    0   805  7868  1101     0     0     0     0]
 [ 2490   225     0     0  7894  1423     0     0]
 [  539     5     0     0 18798  1069    63     0]
 [    0     0     0     0  2399  6577   204     0]
 [  805    41     0     0  3252   841 16837    34]
 [    0     0     0     0     0     0  2302 19405]]
              precision    recall  f1-score   support

       Still       0.81      0.87      0.84     29840
     Walking       0.95      0.83      0.88     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.92      0.69     20474
         Bus       0.58      0.72      0.64      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.77    150960
   macro avg       0.70      0.72      0.71    150960
weighted avg       0.75      0.77      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[25844   106     0     0   840   917   965  1168]
 [ 2232 21742    34    88   928   375   324   420]
 [    0   788  7862  1124     0     0     0     0]
 [ 2396   219     0     0  7988  1429     0     0]
 [  545     0     0     0 18869  1010    50     0]
 [    0     0     0     0  2388  6596   196     0]
 [  793    48     0     0  3259   858 16833    19]
 [    0     0     0     0     0     0  2304 19403]]
              precision    recall  f1-score   support

       Still       0.81      0.87      0.84     29840
     Walking       0.95      0.83      0.89     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.92      0.69     20474
         Bus       0.59      0.72      0.65      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.78    150960
   macro avg       0.70      0.73      0.71    150960
weighted avg       0.75      0.78      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[25806   120     0     0   803   939   985  1187]
 [ 2176 21896    36    70   923   294   324   424]
 [    0   849  7858  1067     0     0     0     0]
 [ 2393   128     0     0  8093  1418     0     0]
 [  547     0     0     0 18927   958    42     0]
 [    0     0     0     0  2372  6632   176     0]
 [  724    50     0     0  3297   865 16856    18]
 [    0     0     0     0     0     0  2305 19402]]
              precision    recall  f1-score   support

       Still       0.82      0.86      0.84     29840
     Walking       0.95      0.84      0.89     26143
         Run       1.00      0.80      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.92      0.69     20474
         Bus       0.60      0.72      0.65      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.78    150960
   macro avg       0.71      0.73      0.71    150960
weighted avg       0.75      0.78      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[25690   167     0     0   802   960  1034  1187]
 [ 2541 21485    57    17   895   347   313   488]
 [    0   950  7838   986     0     0     0     0]
 [ 2139     0     0     0  8433  1460     0     0]
 [  545     0     0     0 18937   980    12     0]
 [    0     0     0     0  2292  6801    87     0]
 [  567    42     0     0  3392   911 16886    12]
 [    0     0     0     0     0     0  2312 19395]]
              precision    recall  f1-score   support

       Still       0.82      0.86      0.84     29840
     Walking       0.95      0.82      0.88     26143
         Run       0.99      0.80      0.89      9774
        Bike       0.00      0.00      0.00     12032
         Car       0.54      0.92      0.69     20474
         Bus       0.59      0.74      0.66      9180
       Train       0.82      0.77      0.80     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.78    150960
   macro avg       0.70      0.73      0.71    150960
weighted avg       0.75      0.78      0.75    150960

training set : Hand ; testing set : Hand; test order: 2
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.16
predict lgb
Time elapsed for testing lgb: 1.22
predict xgb
Time elapsed for testing xgb: 2.94
training set : Hand ; testing set : Hand  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[27006   154     0     0   650   740   206  1084]
 [ 2891 21629    15   325   532   310   187   254]
 [    0   966  8808     0     0     0     0     0]
 [ 3662   119     0  2764  5339   148     0     0]
 [  603   107     0     0 17928  1779    57     0]
 [   27     9     0     0  2635  6509     0     0]
 [ 1212    60     0    19  3669   156 16631    63]
 [    0     1     0     0     0     0  2281 19425]]
              precision    recall  f1-score   support

       Still       0.76      0.91      0.83     29840
     Walking       0.94      0.83      0.88     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.89      0.23      0.37     12032
         Car       0.58      0.88      0.70     20474
         Bus       0.68      0.71      0.69      9180
       Train       0.86      0.76      0.81     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.77    150960
weighted avg       0.83      0.80      0.79    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[27128   218     0     0   627   642   161  1064]
 [ 2867 21669    24   324   553   272   144   290]
 [    0   976  8798     0     0     0     0     0]
 [ 3576    74     0  2849  5416   117     0     0]
 [  543   124     0     0 18041  1766     0     0]
 [    7    15     0     0  2764  6394     0     0]
 [ 1154    59     0    24  3687   159 16683    44]
 [    0     0     0     0     0     0  2278 19429]]
              precision    recall  f1-score   support

       Still       0.77      0.91      0.83     29840
     Walking       0.94      0.83      0.88     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.89      0.24      0.37     12032
         Car       0.58      0.88      0.70     20474
         Bus       0.68      0.70      0.69      9180
       Train       0.87      0.76      0.81     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.77    150960
weighted avg       0.83      0.80      0.79    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[27160   223     0     0   650   612   135  1060]
 [ 2842 21601    31   303   536   285   147   398]
 [    0   990  8784     0     0     0     0     0]
 [ 3590    62     0  2762  5526    92     0     0]
 [  531   123     0     0 17996  1824     0     0]
 [    7    12     0     0  2773  6388     0     0]
 [ 1109    55     0     0  3710   154 16761    21]
 [    0     2     0     0     0     0  2276 19429]]
              precision    recall  f1-score   support

       Still       0.77      0.91      0.83     29840
     Walking       0.94      0.83      0.88     26143
         Run       1.00      0.90      0.95      9774
        Bike       0.90      0.23      0.37     12032
         Car       0.58      0.88      0.70     20474
         Bus       0.68      0.70      0.69      9180
       Train       0.87      0.77      0.82     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.77    150960
weighted avg       0.83      0.80      0.79    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[27097   236     0     0   656   608   139  1104]
 [ 2809 21594    37   255   639   237   152   420]
 [    0  1017  8757     0     0     0     0     0]
 [ 3677    66     0  2543  5621   125     0     0]
 [  519   143     0     0 18076  1736     0     0]
 [    7    13     0     0  2777  6383     0     0]
 [  942    63     0     0  3813   175 16816     1]
 [    0     3     0     0     0     0  2273 19431]]
              precision    recall  f1-score   support

       Still       0.77      0.91      0.84     29840
     Walking       0.93      0.83      0.88     26143
         Run       1.00      0.90      0.94      9774
        Bike       0.91      0.21      0.34     12032
         Car       0.57      0.88      0.69     20474
         Bus       0.69      0.70      0.69      9180
       Train       0.87      0.77      0.82     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.76    150960
weighted avg       0.83      0.80      0.79    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[27041   254     0     0   654   604   151  1136]
 [ 2752 21608    39   265   655   252   155   417]
 [    0  1020  8754     0     0     0     0     0]
 [ 3698    70     0  2492  5669   103     0     0]
 [  503   154     0     0 18061  1756     0     0]
 [    0    13     0     0  2788  6379     0     0]
 [  912    67     0     0  3859   161 16811     0]
 [    0     3     0     0     0     0  2272 19432]]
              precision    recall  f1-score   support

       Still       0.77      0.91      0.84     29840
     Walking       0.93      0.83      0.88     26143
         Run       1.00      0.90      0.94      9774
        Bike       0.90      0.21      0.34     12032
         Car       0.57      0.88      0.69     20474
         Bus       0.69      0.69      0.69      9180
       Train       0.87      0.77      0.82     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.76    150960
weighted avg       0.83      0.80      0.79    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26800   353     0     0   639   655   220  1173]
 [ 2846 21500    50   218   731   217   156   425]
 [    0  1233  8541     0     0     0     0     0]
 [ 3514    67     0  2384  6009    58     0     0]
 [  453   102     0     0 18275  1644     0     0]
 [   13    22     0     0  2784  6361     0     0]
 [  778    84     0     0  4115   120 16713     0]
 [    0     0     0     0     0     0  2264 19443]]
              precision    recall  f1-score   support

       Still       0.78      0.90      0.83     29840
     Walking       0.92      0.82      0.87     26143
         Run       0.99      0.87      0.93      9774
        Bike       0.92      0.20      0.33     12032
         Car       0.56      0.89      0.69     20474
         Bus       0.70      0.69      0.70      9180
       Train       0.86      0.77      0.81     21810
      Subway       0.92      0.90      0.91     21707

    accuracy                           0.80    150960
   macro avg       0.83      0.76      0.76    150960
weighted avg       0.83      0.80      0.79    150960

training set : Hand ; testing set : Hips; test order: 3
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.89
predict lgb
Time elapsed for testing lgb: 1.26
predict xgb
Time elapsed for testing xgb: 2.62
training set : Hand ; testing set : Hips  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[23125   121     0    30  1181  1508  3596   279]
 [ 1442 21554    17  1078   353   427  1040   232]
 [    0   793  7162  1819     0     0     0     0]
 [ 1082  5085     0  2875  2624   366     0     0]
 [  515    34     0     0 17097  2643   185     0]
 [  317     0     0    11   756  7443   653     0]
 [ 1322    21     0    35  1936   923 17457   116]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.77      0.80     29840
     Walking       0.78      0.82      0.80     26143
         Run       1.00      0.73      0.84      9774
        Bike       0.49      0.24      0.32     12032
         Car       0.71      0.84      0.77     20474
         Bus       0.56      0.81      0.66      9180
       Train       0.51      0.80      0.63     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.68    150960
weighted avg       0.74      0.71      0.71    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[23080   119     0    35  1276  1476  3572   282]
 [ 1401 21798    21   877   307   403  1064   272]
 [    0   728  7194  1852     0     0     0     0]
 [ 1010  5126     0  2991  2562   343     0     0]
 [  424    49     0     0 17215  2634   152     0]
 [  299    15     0     0   753  7411   702     0]
 [ 1325    37     0    48  1964   918 17425    93]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.77      0.80     29840
     Walking       0.78      0.83      0.81     26143
         Run       1.00      0.74      0.85      9774
        Bike       0.52      0.25      0.34     12032
         Car       0.71      0.84      0.77     20474
         Bus       0.56      0.81      0.66      9180
       Train       0.51      0.80      0.62     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.69    150960
weighted avg       0.75      0.71      0.71    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[23071   125     0    20  1292  1496  3554   282]
 [ 1291 21854    25   860   277   418  1066   352]
 [    0   763  7210  1801     0     0     0     0]
 [  994  5128     0  3060  2526   324     0     0]
 [  411    31     0     0 17225  2692   115     0]
 [  284    20     0     0   735  7421   720     0]
 [ 1266    44     0    40  2080   944 17356    80]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.77      0.81     29840
     Walking       0.78      0.84      0.81     26143
         Run       1.00      0.74      0.85      9774
        Bike       0.53      0.25      0.34     12032
         Car       0.71      0.84      0.77     20474
         Bus       0.56      0.81      0.66      9180
       Train       0.51      0.80      0.62     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.69    150960
weighted avg       0.75      0.71      0.71    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[22960   123     0    10  1326  1564  3555   302]
 [ 1295 21843    37   852   262   430  1046   378]
 [    0   783  7204  1787     0     0     0     0]
 [  978  5112     0  2971  2599   372     0     0]
 [  325    51     0     0 17306  2759    33     0]
 [  260    23     0     0   650  7522   725     0]
 [ 1278    52     0     0  2275   940 17221    44]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.77      0.81     29840
     Walking       0.78      0.84      0.81     26143
         Run       0.99      0.74      0.85      9774
        Bike       0.53      0.25      0.34     12032
         Car       0.71      0.85      0.77     20474
         Bus       0.55      0.82      0.66      9180
       Train       0.51      0.79      0.62     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.69    150960
weighted avg       0.75      0.71      0.71    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[22935   132     0    11  1319  1560  3571   312]
 [ 1346 21864    37   833   235   418  1032   378]
 [    0   875  7153  1746     0     0     0     0]
 [ 1019  5190     0  2784  2662   377     0     0]
 [  320    50     0     0 17290  2792    22     0]
 [  245    26     0     0   662  7530   717     0]
 [ 1257    60     0     0  2307   912 17244    30]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.77      0.81     29840
     Walking       0.78      0.84      0.80     26143
         Run       0.99      0.73      0.84      9774
        Bike       0.52      0.23      0.32     12032
         Car       0.71      0.84      0.77     20474
         Bus       0.55      0.82      0.66      9180
       Train       0.51      0.79      0.62     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.68    150960
weighted avg       0.75      0.71      0.71    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[22861   200     0    22  1280  1475  3656   346]
 [ 1468 21806    40   833   187   448   971   390]
 [    0   994  7000  1780     0     0     0     0]
 [  988  5317     0  2769  2494   464     0     0]
 [  277    77     0     0 17336  2784     0     0]
 [  160    27     0     0   678  7669   646     0]
 [ 1217   101     0     0  2288   824 17380     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.77      0.80     29840
     Walking       0.76      0.83      0.80     26143
         Run       0.99      0.72      0.83      9774
        Bike       0.51      0.23      0.32     12032
         Car       0.71      0.85      0.78     20474
         Bus       0.56      0.84      0.67      9180
       Train       0.51      0.80      0.63     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.71    150960
   macro avg       0.73      0.69      0.68    150960
weighted avg       0.75      0.71      0.71    150960

training set:Torso,the 3th training set
begin training
X_train: (1050525, 204)
y_train: 1050525
Training rf...
Time elapsed for training rf: 250.99
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.596949 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 51998
[LightGBM] [Info] Number of data points in the train set: 840420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.151294
[LightGBM] [Info] Start training from score -2.146763
[LightGBM] [Info] Start training from score -2.236295
[LightGBM] [Info] Start training from score -2.190777
[LightGBM] [Info] Start training from score -1.889313
[LightGBM] [Info] Start training from score -2.002531
[LightGBM] [Info] Start training from score -1.904397
[LightGBM] [Info] Start training from score -2.180014
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.5078
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.21055
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 1.00115
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[4]	valid_0's multi_logloss: 0.844878
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.720512
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.620355
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[7]	valid_0's multi_logloss: 0.539138
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.470057
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.412383
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[10]	valid_0's multi_logloss: 0.364209
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[11]	valid_0's multi_logloss: 0.322682
[12]	valid_0's multi_logloss: 0.287606
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[13]	valid_0's multi_logloss: 0.258335
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[14]	valid_0's multi_logloss: 0.232879
[15]	valid_0's multi_logloss: 0.210236
[16]	valid_0's multi_logloss: 0.190691
[17]	valid_0's multi_logloss: 0.173978
[18]	valid_0's multi_logloss: 0.159199
[19]	valid_0's multi_logloss: 0.146522
[20]	valid_0's multi_logloss: 0.135151
[21]	valid_0's multi_logloss: 0.124988
[22]	valid_0's multi_logloss: 0.1163
[23]	valid_0's multi_logloss: 0.108289
[24]	valid_0's multi_logloss: 0.100971
[25]	valid_0's multi_logloss: 0.0938176
[26]	valid_0's multi_logloss: 0.0881512
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[27]	valid_0's multi_logloss: 0.0831676
[28]	valid_0's multi_logloss: 0.0788814
[29]	valid_0's multi_logloss: 0.0739815
[30]	valid_0's multi_logloss: 0.0703597
[31]	valid_0's multi_logloss: 0.0669499
[32]	valid_0's multi_logloss: 0.0637145
[33]	valid_0's multi_logloss: 0.0608049
[34]	valid_0's multi_logloss: 0.0579518
[35]	valid_0's multi_logloss: 0.0556242
[36]	valid_0's multi_logloss: 0.0528023
[37]	valid_0's multi_logloss: 0.0507034
[38]	valid_0's multi_logloss: 0.0484241
[39]	valid_0's multi_logloss: 0.0465529
[40]	valid_0's multi_logloss: 0.044795
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0430453
[42]	valid_0's multi_logloss: 0.0414765
[43]	valid_0's multi_logloss: 0.0399259
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.0384272
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0372013
[46]	valid_0's multi_logloss: 0.0359471
[47]	valid_0's multi_logloss: 0.0346257
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0333468
[49]	valid_0's multi_logloss: 0.0322416
[50]	valid_0's multi_logloss: 0.0313046
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0302471
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0293051
[53]	valid_0's multi_logloss: 0.0284581
[54]	valid_0's multi_logloss: 0.02756
[55]	valid_0's multi_logloss: 0.0267362
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0259771
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0251976
[58]	valid_0's multi_logloss: 0.0244459
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0237846
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0232091
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.022572
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0218226
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0211941
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0206041
[65]	valid_0's multi_logloss: 0.0201309
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0195848
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0191314
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0187401
[69]	valid_0's multi_logloss: 0.0182919
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0178589
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0174239
[72]	valid_0's multi_logloss: 0.0169505
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0165077
[74]	valid_0's multi_logloss: 0.0160151
[75]	valid_0's multi_logloss: 0.0156596
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0152765
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0149757
[78]	valid_0's multi_logloss: 0.0145951
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0141664
[80]	valid_0's multi_logloss: 0.0138781
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0135936
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0133281
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.0131336
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0128449
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0125321
[86]	valid_0's multi_logloss: 0.0123156
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.0120336
[88]	valid_0's multi_logloss: 0.0117854
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[89]	valid_0's multi_logloss: 0.0115378
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[90]	valid_0's multi_logloss: 0.0112678
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[91]	valid_0's multi_logloss: 0.0110391
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[92]	valid_0's multi_logloss: 0.010823
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.010681
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0104663
[95]	valid_0's multi_logloss: 0.0103033
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.0100293
[97]	valid_0's multi_logloss: 0.00987447
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.00969363
[99]	valid_0's multi_logloss: 0.00954816
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[100]	valid_0's multi_logloss: 0.0093813
Time elapsed for training LightGBM: 121.55
Training XGBoost...
Time elapsed for training XGBoost: 530.11
begin testing
training set : Torso ; testing set : Torso; test order: 0
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.02
predict lgb
Time elapsed for testing lgb: 1.24
predict xgb
Time elapsed for testing xgb: 2.63
training set : Torso ; testing set : Torso  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26540   200     0   128   670    14  2112   176]
 [ 1595 22711    18   744   315    56   463   241]
 [    0   304  7887  1583     0     0     0     0]
 [  339   361     0  7765  3567     0     0     0]
 [  244    42     0     0 18571  1343   274     0]
 [  253    25     0    70  2367  6020   445     0]
 [ 2468     4     0    44  1827  1373 15089  1005]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.84      0.89      0.87     29840
     Walking       0.96      0.87      0.91     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.75      0.65      0.69     12032
         Car       0.68      0.91      0.78     20474
         Bus       0.68      0.66      0.67      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.74      0.75    150960
weighted avg       0.79      0.76      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[26458   217     0   160   582    16  2194   213]
 [ 1603 22749    35   674   250    85   474   273]
 [    0   331  7890  1553     0     0     0     0]
 [  328   350     0  7783  3571     0     0     0]
 [  286    68     0     0 18528  1350   242     0]
 [  120    51     0     0  2421  6168   420     0]
 [ 2531     7     0    47  1769  1354 15076  1026]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.89      0.87     29840
     Walking       0.96      0.87      0.91     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.76      0.65      0.70     12032
         Car       0.68      0.90      0.78     20474
         Bus       0.69      0.67      0.68      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.75      0.76    150960
weighted avg       0.79      0.76      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[26389   235     0   208   502    27  2262   217]
 [ 1570 22761    44   614   222    79   487   366]
 [    0   358  7891  1525     0     0     0     0]
 [  328   326     0  7805  3573     0     0     0]
 [  293    79     0     0 18515  1364   223     0]
 [   91    49     0     0  2318  6293   429     0]
 [ 2572    12     0    72  1658  1381 15098  1017]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.88      0.86     29840
     Walking       0.96      0.87      0.91     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.76      0.65      0.70     12032
         Car       0.69      0.90      0.78     20474
         Bus       0.69      0.69      0.69      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.75      0.76    150960
weighted avg       0.79      0.76      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26350   253     0   157   500    48  2296   236]
 [ 1514 22761    50   592   246    65   515   400]
 [    0   347  7892  1535     0     0     0     0]
 [  379   358     0  7755  3540     0     0     0]
 [  291    89     0     0 18555  1368   171     0]
 [   53    53     0     0  2341  6285   448     0]
 [ 2605    25     0    65  1526  1422 15163  1004]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.88      0.86     29840
     Walking       0.95      0.87      0.91     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.77      0.64      0.70     12032
         Car       0.69      0.91      0.79     20474
         Bus       0.68      0.68      0.68      9180
       Train       0.51      0.70      0.59     21810
      Subway       0.87      0.49      0.62     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.75      0.76    150960
weighted avg       0.79      0.76      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[26326   258     0   134   490    66  2309   257]
 [ 1418 22794    53   615   254    77   517   415]
 [    0   311  7892  1571     0     0     0     0]
 [  388   377     0  7724  3543     0     0     0]
 [  289    99     0     0 18582  1350   154     0]
 [   35    57     0     0  2344  6271   473     0]
 [ 2630    27     0    50  1482  1461 15128  1032]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.88      0.86     29840
     Walking       0.95      0.87      0.91     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.77      0.64      0.70     12032
         Car       0.70      0.91      0.79     20474
         Bus       0.68      0.68      0.68      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.76    150960
   macro avg       0.79      0.75      0.76    150960
weighted avg       0.79      0.76      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26016   328     0   161   465   143  2357   370]
 [ 1424 22749    85   651   326    67   428   413]
 [    0   186  7896  1692     0     0     0     0]
 [  389   315     0  7771  3557     0     0     0]
 [  241   114     0     0 18910  1197    12     0]
 [   54    81     0     0  2156  6477   412     0]
 [ 2684    26     0     0  1464  1451 15180  1005]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.84      0.87      0.86     29840
     Walking       0.96      0.87      0.91     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.76      0.65      0.70     12032
         Car       0.70      0.92      0.80     20474
         Bus       0.69      0.71      0.70      9180
       Train       0.51      0.70      0.59     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.77    150960
   macro avg       0.79      0.75      0.76    150960
weighted avg       0.79      0.77      0.77    150960

training set : Torso ; testing set : Bag; test order: 1
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.04
predict lgb
Time elapsed for testing lgb: 1.26
predict xgb
Time elapsed for testing xgb: 2.79
training set : Torso ; testing set : Bag  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[25414   113  1447   306   454   270   649  1187]
 [ 1372 17228     9  5982   653    11   490   398]
 [    0  1155  8582    37     0     0     0     0]
 [  311   241     0  6215  5188    77     0     0]
 [  353    48     0   177 17869  1889   138     0]
 [   23    23     0  2492   863  5457   322     0]
 [  256     0     0   117  4552   554 15238  1093]
 [    3     0     0     0     0     0  2304 19400]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.92      0.66      0.77     26143
         Run       0.85      0.88      0.87      9774
        Bike       0.41      0.52      0.45     12032
         Car       0.60      0.87      0.71     20474
         Bus       0.66      0.59      0.63      9180
       Train       0.80      0.70      0.74     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    150960
   macro avg       0.75      0.75      0.74    150960
weighted avg       0.79      0.76      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[25366   132  1514   275   427   309   630  1187]
 [ 1304 17084    23  5998   704     4   571   455]
 [    0  1203  8571     0     0     0     0     0]
 [  246    93     0  6353  5269    71     0     0]
 [  353    38     0    62 17875  2033   113     0]
 [   13    34     0  2413   788  5564   368     0]
 [  192     0     0   103  4555   602 15270  1088]
 [    0     0     0     0     0     0  2310 19397]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.89     29840
     Walking       0.92      0.65      0.76     26143
         Run       0.85      0.88      0.86      9774
        Bike       0.42      0.53      0.47     12032
         Car       0.60      0.87      0.71     20474
         Bus       0.65      0.61      0.63      9180
       Train       0.79      0.70      0.74     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    150960
   macro avg       0.75      0.75      0.74    150960
weighted avg       0.79      0.76      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[25299   149  1551   234   487   307   626  1187]
 [ 1264 17003    32  6035   743     6   561   499]
 [    0  1210  8524    40     0     0     0     0]
 [  247    83     0  6346  5291    65     0     0]
 [  410    35     0    48 17915  1979    87     0]
 [   16    39     0  2466   730  5579   350     0]
 [  151     0     0   104  4569   595 15308  1083]
 [    0     0     0     0     0     0  2315 19392]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.92      0.65      0.76     26143
         Run       0.84      0.87      0.86      9774
        Bike       0.42      0.53      0.46     12032
         Car       0.60      0.88      0.71     20474
         Bus       0.65      0.61      0.63      9180
       Train       0.80      0.70      0.75     21810
      Subway       0.88      0.89      0.88     21707

    accuracy                           0.76    150960
   macro avg       0.75      0.75      0.74    150960
weighted avg       0.79      0.76      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[25333   146  1510   219   520   281   644  1187]
 [ 1251 16933    36  6024   753    21   626   499]
 [    0  1241  8506    27     0     0     0     0]
 [  212    45     0  6551  5178    46     0     0]
 [  402    40     0     0 17959  1987    86     0]
 [   17    41     0  2533   711  5532   346     0]
 [   47     0     0    84  4672   580 15359  1068]
 [    0     0     0     0     0     0  2319 19388]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.92      0.65      0.76     26143
         Run       0.85      0.87      0.86      9774
        Bike       0.42      0.54      0.48     12032
         Car       0.60      0.88      0.71     20474
         Bus       0.65      0.60      0.63      9180
       Train       0.79      0.70      0.75     21810
      Subway       0.88      0.89      0.88     21707

    accuracy                           0.77    150960
   macro avg       0.76      0.75      0.74    150960
weighted avg       0.79      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[25356   154  1513   198   533   247   652  1187]
 [ 1263 16878    37  6044   742    33   637   509]
 [    0  1262  8496    16     0     0     0     0]
 [  217     2     0  6636  5137    40     0     0]
 [  380    42     0     0 17937  2026    89     0]
 [   19    41     0  2566   735  5521   298     0]
 [   46     0     0    85  4655   580 15383  1061]
 [    0     0     0     0     0     0  2323 19384]]
              precision    recall  f1-score   support

       Still       0.93      0.85      0.89     29840
     Walking       0.92      0.65      0.76     26143
         Run       0.85      0.87      0.86      9774
        Bike       0.43      0.55      0.48     12032
         Car       0.60      0.88      0.71     20474
         Bus       0.65      0.60      0.63      9180
       Train       0.79      0.71      0.75     21810
      Subway       0.88      0.89      0.88     21707

    accuracy                           0.77    150960
   macro avg       0.76      0.75      0.74    150960
weighted avg       0.79      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[25415   204  1492   168   483   206   685  1187]
 [ 1535 16280    40  5966   684    79   703   856]
 [    0  1434  8340     0     0     0     0     0]
 [  260    31     0  6793  4948     0     0     0]
 [  374    65     0     0 18007  1947    81     0]
 [   41    47     0  2614   668  5634   176     0]
 [   79    24     0     2  4842   607 15280   976]
 [    0     0     0     0     0     0  2339 19368]]
              precision    recall  f1-score   support

       Still       0.92      0.85      0.88     29840
     Walking       0.90      0.62      0.74     26143
         Run       0.84      0.85      0.85      9774
        Bike       0.44      0.56      0.49     12032
         Car       0.61      0.88      0.72     20474
         Bus       0.66      0.61      0.64      9180
       Train       0.79      0.70      0.74     21810
      Subway       0.87      0.89      0.88     21707

    accuracy                           0.76    150960
   macro avg       0.75      0.75      0.74    150960
weighted avg       0.79      0.76      0.77    150960

training set : Torso ; testing set : Hand; test order: 2
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 1.11
predict lgb
Time elapsed for testing lgb: 1.26
predict xgb
Time elapsed for testing xgb: 2.63
training set : Torso ; testing set : Hand  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[24573   671   168  2077   314     0   423  1614]
 [  696 13716     6 10795     0     0   456   474]
 [    0   385  8083  1306     0     0     0     0]
 [    0    44     0 11892    96     0     0     0]
 [  268   140     0  3038 15042  1818   168     0]
 [   10     0     0  2833   963  5237   137     0]
 [  643    75     0  1424  3735     0 14774  1159]
 [   38     0     0     0     0    57  2296 19316]]
              precision    recall  f1-score   support

       Still       0.94      0.82      0.88     29840
     Walking       0.91      0.52      0.67     26143
         Run       0.98      0.83      0.90      9774
        Bike       0.36      0.99      0.52     12032
         Car       0.75      0.73      0.74     20474
         Bus       0.74      0.57      0.64      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.86      0.89      0.87     21707

    accuracy                           0.75    150960
   macro avg       0.79      0.75      0.74    150960
weighted avg       0.82      0.75      0.76    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[24757   622   131  2019   251     0   432  1628]
 [  632 14024    12 10489     0     0   459   527]
 [    0   478  8080  1216     0     0     0     0]
 [    0     3     0 11932    97     0     0     0]
 [  215   182     0  2840 15281  1863    93     0]
 [   11     0     0  2730   948  5328   163     0]
 [  615    23     0  1514  3628     0 14884  1146]
 [    0     0     0     0     0    21  2298 19388]]
              precision    recall  f1-score   support

       Still       0.94      0.83      0.88     29840
     Walking       0.91      0.54      0.68     26143
         Run       0.98      0.83      0.90      9774
        Bike       0.36      0.99      0.53     12032
         Car       0.76      0.75      0.75     20474
         Bus       0.74      0.58      0.65      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.75    150960
   macro avg       0.80      0.76      0.75    150960
weighted avg       0.83      0.75      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[24733   580   129  2054   240     0   472  1632]
 [  586 14036    17 10493     0     0   440   571]
 [    0   477  8047  1250     0     0     0     0]
 [    0     0     0 11934    98     0     0     0]
 [  228   165     0  2702 15371  1918    90     0]
 [    7     0     0  2715   940  5352   166     0]
 [  542    22     0  1502  3731     0 14883  1130]
 [    0     0     0     0     0     0  2298 19409]]
              precision    recall  f1-score   support

       Still       0.95      0.83      0.88     29840
     Walking       0.92      0.54      0.68     26143
         Run       0.98      0.82      0.90      9774
        Bike       0.37      0.99      0.53     12032
         Car       0.75      0.75      0.75     20474
         Bus       0.74      0.58      0.65      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.75    150960
   macro avg       0.80      0.76      0.75    150960
weighted avg       0.83      0.75      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[24795   632   132  1997   165     0   480  1639]
 [  602 14087    13 10400     0     0   430   611]
 [    0   466  8032  1276     0     0     0     0]
 [    0     0     0 11955    77     0     0     0]
 [  269   173     0  2689 15262  1995    86     0]
 [    7     0     0  2783   935  5288   167     0]
 [  444    22     0  1518  3811     0 14892  1123]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.95      0.83      0.89     29840
     Walking       0.92      0.54      0.68     26143
         Run       0.98      0.82      0.89      9774
        Bike       0.37      0.99      0.54     12032
         Car       0.75      0.75      0.75     20474
         Bus       0.73      0.58      0.64      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.75    150960
   macro avg       0.79      0.76      0.75    150960
weighted avg       0.83      0.75      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[24816   689   135  1917   152     0   488  1643]
 [  598 14053    12 10402     0     0   446   632]
 [    0   443  7895  1436     0     0     0     0]
 [    0     0     0 12032     0     0     0     0]
 [  256   188     0  2694 15237  2014    85     0]
 [    6     0     0  2847   927  5235   165     0]
 [  455    18     0  1571  3777     0 14872  1117]
 [    0     0     0     0     0     0  2295 19412]]
              precision    recall  f1-score   support

       Still       0.95      0.83      0.89     29840
     Walking       0.91      0.54      0.68     26143
         Run       0.98      0.81      0.89      9774
        Bike       0.37      1.00      0.54     12032
         Car       0.76      0.74      0.75     20474
         Bus       0.72      0.57      0.64      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.75    150960
   macro avg       0.79      0.76      0.75    150960
weighted avg       0.82      0.75      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[24646   718   102  2013   127    32   473  1729]
 [  547 13606    31 10608     0     0   383   968]
 [    0   571  7789  1414     0     0     0     0]
 [    0     0     0 12032     0     0     0     0]
 [  211   236     0  2249 15546  2158    74     0]
 [    0     0     0  2992   897  5162   129     0]
 [  492     0     0  1431  4032     0 14780  1075]
 [    0     0     0     0     0     0  2301 19406]]
              precision    recall  f1-score   support

       Still       0.95      0.83      0.88     29840
     Walking       0.90      0.52      0.66     26143
         Run       0.98      0.80      0.88      9774
        Bike       0.37      1.00      0.54     12032
         Car       0.75      0.76      0.76     20474
         Bus       0.70      0.56      0.62      9180
       Train       0.81      0.68      0.74     21810
      Subway       0.84      0.89      0.86     21707

    accuracy                           0.75    150960
   macro avg       0.79      0.75      0.74    150960
weighted avg       0.82      0.75      0.76    150960

training set : Torso ; testing set : Hips; test order: 3
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.99
predict lgb
Time elapsed for testing lgb: 1.25
predict xgb
Time elapsed for testing xgb: 2.73
training set : Torso ; testing set : Hips  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[23406   944     0   198   950   187  3754   401]
 [  788 20353   102  3154     0    26  1432   288]
 [    0   253  8653   868     0     0     0     0]
 [  265  1143     0 10566    58     0     0     0]
 [  396    60     0     0 16449  3146   423     0]
 [  258     0     0   158  1837  6181   746     0]
 [  875    15     0    65  2847   793 16161  1054]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.78      0.84     29840
     Walking       0.89      0.78      0.83     26143
         Run       0.99      0.89      0.93      9774
        Bike       0.70      0.88      0.78     12032
         Car       0.74      0.80      0.77     20474
         Bus       0.60      0.67      0.63      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.74    150960
   macro avg       0.77      0.75      0.75    150960
weighted avg       0.78      0.74      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[23510   931     0   174   902   195  3714   414]
 [  793 20301    86  3074     0    60  1468   361]
 [    0   244  8670   860     0     0     0     0]
 [  251  1175     0 10569    37     0     0     0]
 [  428    25     0     0 16452  3173   396     0]
 [  265     0     0   104  1890  6174   747     0]
 [  798    40     0    49  2934   804 16134  1051]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.79      0.84     29840
     Walking       0.89      0.78      0.83     26143
         Run       0.99      0.89      0.94      9774
        Bike       0.71      0.88      0.79     12032
         Car       0.74      0.80      0.77     20474
         Bus       0.59      0.67      0.63      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.74    150960
   macro avg       0.77      0.75      0.75    150960
weighted avg       0.78      0.74      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[23547   921     0   181   870   218  3685   418]
 [  784 20228    90  3044     0    93  1450   454]
 [    0   250  8668   856     0     0     0     0]
 [  209  1172     0 10634    17     0     0     0]
 [  330    51     0     0 16531  3188   374     0]
 [  265     0     0    75  1852  6240   748     0]
 [  759    41     0    53  2992   766 16143  1056]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.79      0.84     29840
     Walking       0.89      0.77      0.83     26143
         Run       0.99      0.89      0.94      9774
        Bike       0.72      0.88      0.79     12032
         Car       0.74      0.81      0.77     20474
         Bus       0.59      0.68      0.63      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.75    150960
   macro avg       0.77      0.76      0.75    150960
weighted avg       0.78      0.75      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[23478  1003     0   131   856   247  3696   429]
 [  795 20112    49  3092     0   127  1487   481]
 [    0   241  8673   860     0     0     0     0]
 [  192  1187     0 10653     0     0     0     0]
 [  274    66     0     0 16605  3197   332     0]
 [  241     0     0    75  1777  6288   799     0]
 [  732    40     0    61  3005   760 16166  1046]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.79      0.85     29840
     Walking       0.89      0.77      0.82     26143
         Run       0.99      0.89      0.94      9774
        Bike       0.72      0.89      0.79     12032
         Car       0.75      0.81      0.78     20474
         Bus       0.59      0.68      0.64      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.84      0.49      0.62     21707

    accuracy                           0.75    150960
   macro avg       0.77      0.76      0.75    150960
weighted avg       0.78      0.75      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[23429  1035     0   138   875   262  3678   423]
 [  794 20150    45  3008     0   154  1500   492]
 [    0   233  8676   865     0     0     0     0]
 [  198  1195     0 10639     0     0     0     0]
 [  256    83     0     0 16634  3182   319     0]
 [  234     0     0    78  1753  6299   816     0]
 [  727    41     0    62  3025   730 16185  1040]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.79      0.84     29840
     Walking       0.89      0.77      0.82     26143
         Run       0.99      0.89      0.94      9774
        Bike       0.72      0.88      0.79     12032
         Car       0.75      0.81      0.78     20474
         Bus       0.59      0.69      0.64      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.84      0.49      0.62     21707

    accuracy                           0.75    150960
   macro avg       0.77      0.76      0.75    150960
weighted avg       0.78      0.75      0.75    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[23269  1023     0   196   858   308  3796   390]
 [  820 20091    43  2730     0   221  1491   747]
 [    0   107  8767   900     0     0     0     0]
 [  254  1113     0 10665     0     0     0     0]
 [  230   161     0     0 16671  3217   195     0]
 [  193     0     0   101  1716  6379   791     0]
 [  600    77     0     0  3106   671 16353  1003]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.78      0.84     29840
     Walking       0.89      0.77      0.82     26143
         Run       1.00      0.90      0.94      9774
        Bike       0.73      0.89      0.80     12032
         Car       0.75      0.81      0.78     20474
         Bus       0.59      0.69      0.64      9180
       Train       0.48      0.75      0.59     21810
      Subway       0.83      0.49      0.62     21707

    accuracy                           0.75    150960
   macro avg       0.77      0.76      0.75    150960
weighted avg       0.78      0.75      0.75    150960

begin training all
training set:all_train_set,the 0th training set
begin training
X_train: (4202100, 204)
y_train: 4202100
Training rf...
Time elapsed for training rf: 1532.18
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 3.713103 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 51995
[LightGBM] [Info] Number of data points in the train set: 3361680, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.149432
[LightGBM] [Info] Start training from score -2.146664
[LightGBM] [Info] Start training from score -2.235841
[LightGBM] [Info] Start training from score -2.191647
[LightGBM] [Info] Start training from score -1.890292
[LightGBM] [Info] Start training from score -2.003779
[LightGBM] [Info] Start training from score -1.905730
[LightGBM] [Info] Start training from score -2.177056
[1]	valid_0's multi_logloss: 1.5391
[2]	valid_0's multi_logloss: 1.25594
[3]	valid_0's multi_logloss: 1.05562
[4]	valid_0's multi_logloss: 0.903974
[5]	valid_0's multi_logloss: 0.784658
[6]	valid_0's multi_logloss: 0.685734
[7]	valid_0's multi_logloss: 0.604567
[8]	valid_0's multi_logloss: 0.538026
[9]	valid_0's multi_logloss: 0.481443
[10]	valid_0's multi_logloss: 0.433566
[11]	valid_0's multi_logloss: 0.392649
[12]	valid_0's multi_logloss: 0.357581
[13]	valid_0's multi_logloss: 0.327243
[14]	valid_0's multi_logloss: 0.301491
[15]	valid_0's multi_logloss: 0.27892
[16]	valid_0's multi_logloss: 0.259075
[17]	valid_0's multi_logloss: 0.241909
[18]	valid_0's multi_logloss: 0.226469
[19]	valid_0's multi_logloss: 0.212992
[20]	valid_0's multi_logloss: 0.200724
[21]	valid_0's multi_logloss: 0.19004
[22]	valid_0's multi_logloss: 0.180305
[23]	valid_0's multi_logloss: 0.172026
[24]	valid_0's multi_logloss: 0.164239
[25]	valid_0's multi_logloss: 0.156905
[26]	valid_0's multi_logloss: 0.15025
[27]	valid_0's multi_logloss: 0.144355
[28]	valid_0's multi_logloss: 0.138509
[29]	valid_0's multi_logloss: 0.132916
[30]	valid_0's multi_logloss: 0.127999
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[31]	valid_0's multi_logloss: 0.123375
[32]	valid_0's multi_logloss: 0.11908
[33]	valid_0's multi_logloss: 0.115243
[34]	valid_0's multi_logloss: 0.111308
[35]	valid_0's multi_logloss: 0.107715
[36]	valid_0's multi_logloss: 0.104266
[37]	valid_0's multi_logloss: 0.101556
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0986687
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[39]	valid_0's multi_logloss: 0.0958236
[40]	valid_0's multi_logloss: 0.0933488
[41]	valid_0's multi_logloss: 0.091079
[42]	valid_0's multi_logloss: 0.0888805
[43]	valid_0's multi_logloss: 0.0865247
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.0842216
[45]	valid_0's multi_logloss: 0.0823067
[46]	valid_0's multi_logloss: 0.0803056
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.078475
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0765778
[49]	valid_0's multi_logloss: 0.0749334
[50]	valid_0's multi_logloss: 0.0733593
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0718709
[52]	valid_0's multi_logloss: 0.0704107
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0689374
[54]	valid_0's multi_logloss: 0.0676761
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0663742
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0653178
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0642281
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0632204
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0623277
[60]	valid_0's multi_logloss: 0.0612622
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0602558
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0593942
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0584419
[64]	valid_0's multi_logloss: 0.0576124
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0564729
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0556968
[67]	valid_0's multi_logloss: 0.0549322
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0541074
[69]	valid_0's multi_logloss: 0.0533431
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0526613
[71]	valid_0's multi_logloss: 0.0518901
[72]	valid_0's multi_logloss: 0.0511349
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0504617
[74]	valid_0's multi_logloss: 0.0496673
[75]	valid_0's multi_logloss: 0.0490124
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.048194
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0475867
[78]	valid_0's multi_logloss: 0.0469323
[79]	valid_0's multi_logloss: 0.0462673
[80]	valid_0's multi_logloss: 0.0457125
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0451213
[82]	valid_0's multi_logloss: 0.0445283
[83]	valid_0's multi_logloss: 0.0440861
[84]	valid_0's multi_logloss: 0.0435626
[85]	valid_0's multi_logloss: 0.0427669
[86]	valid_0's multi_logloss: 0.0422196
[87]	valid_0's multi_logloss: 0.0416805
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0412118
[89]	valid_0's multi_logloss: 0.040717
[90]	valid_0's multi_logloss: 0.0402327
[91]	valid_0's multi_logloss: 0.0398268
[92]	valid_0's multi_logloss: 0.0393542
[93]	valid_0's multi_logloss: 0.038908
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0384659
[95]	valid_0's multi_logloss: 0.0380341
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.0376176
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.0371782
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.0368013
[99]	valid_0's multi_logloss: 0.0364021
[100]	valid_0's multi_logloss: 0.0360772
Time elapsed for training LightGBM: 1393.18
Training XGBoost...
[22:41:44] WARNING: /workspace/src/gbm/gbtree.cc:139: Tree method is automatically selected to be 'approx' for faster speed. To use old behavior (exact greedy algorithm on single machine), set tree_method to 'exact'.
Time elapsed for training XGBoost: 3398.4
begin testing
training set : all_train_set ; testing set : all_test_set; test order: 0
X_val  : (603840, 204)
y_val  : 603840
predict rf
Time elapsed for testing rf 3.62
predict lgb
Time elapsed for testing lgb: 4.47
predict xgb
Time elapsed for testing xgb: 9.95
training set : all_train_set ; testing set : all_test_set  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[105273   1636      0     65   2072   1374   6680   2260]
 [  6124  92012     73   2897    663    937    843   1023]
 [     0   7056  31672    368      0      0      0      0]
 [  3072   4030      0  29085  11178    763      0      0]
 [  1176    447      0      0  75221   4342    710      0]
 [   271     69      0    196   9338  26245    601      0]
 [  4884    137      0    214   9196   4588  65029   3192]
 [     0      2      0      0      0      0  26761  60065]]
              precision    recall  f1-score   support

       Still       0.87      0.88      0.88    119360
     Walking       0.87      0.88      0.88    104572
         Run       1.00      0.81      0.89     39096
        Bike       0.89      0.60      0.72     48128
         Car       0.70      0.92      0.79     81896
         Bus       0.69      0.71      0.70     36720
       Train       0.65      0.75      0.69     87240
      Subway       0.90      0.69      0.78     86828

    accuracy                           0.80    603840
   macro avg       0.82      0.78      0.79    603840
weighted avg       0.82      0.80      0.80    603840

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[105331   1829      0    115   2016   1237   6548   2284]
 [  5863  92322    106   2791    673    799    822   1196]
 [     0   7108  31666    322      0      0      0      0]
 [  2948   3653      0  29849  10996    682      0      0]
 [  1131    393      0      0  75708   4163    501      0]
 [   232     96      0    122   9349  26393    528      0]
 [  4863    200      0    197   9245   4568  64907   3260]
 [     0      0      0      0      0      0  26759  60069]]
              precision    recall  f1-score   support

       Still       0.88      0.88      0.88    119360
     Walking       0.87      0.88      0.88    104572
         Run       1.00      0.81      0.89     39096
        Bike       0.89      0.62      0.73     48128
         Car       0.70      0.92      0.80     81896
         Bus       0.70      0.72      0.71     36720
       Train       0.65      0.74      0.69     87240
      Subway       0.90      0.69      0.78     86828

    accuracy                           0.81    603840
   macro avg       0.82      0.78      0.80    603840
weighted avg       0.82      0.81      0.81    603840

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[105171   2020      0    105   2067   1266   6434   2297]
 [  5639  92397    139   2683    672    789    872   1381]
 [     0   7164  31609    323      0      0      0      0]
 [  2760   3660      0  30111  10908    689      0      0]
 [  1041    435      0      0  75991   3988    441      0]
 [   164     98      0    115   9380  26448    515      0]
 [  4725    221      0    247   9192   4598  64998   3259]
 [     0      1      0      0      0      0  26756  60071]]
              precision    recall  f1-score   support

       Still       0.88      0.88      0.88    119360
     Walking       0.87      0.88      0.88    104572
         Run       1.00      0.81      0.89     39096
        Bike       0.90      0.63      0.74     48128
         Car       0.70      0.93      0.80     81896
         Bus       0.70      0.72      0.71     36720
       Train       0.65      0.75      0.69     87240
      Subway       0.90      0.69      0.78     86828

    accuracy                           0.81    603840
   macro avg       0.82      0.79      0.80    603840
weighted avg       0.82      0.81      0.81    603840

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[105092   2099      0     86   2121   1251   6373   2338]
 [  5503  92339    156   2686    668    786    921   1513]
 [     0   7228  31548    320      0      0      0      0]
 [  2690   3612      0  30189  10901    736      0      0]
 [   961    504      0      0  76157   3916    358      0]
 [   134    125      0     91   9493  26450    427      0]
 [  4770    224      0    260   9367   4494  64916   3209]
 [     0      4      0      0      0      0  26753  60071]]
              precision    recall  f1-score   support

       Still       0.88      0.88      0.88    119360
     Walking       0.87      0.88      0.88    104572
         Run       1.00      0.81      0.89     39096
        Bike       0.90      0.63      0.74     48128
         Car       0.70      0.93      0.80     81896
         Bus       0.70      0.72      0.71     36720
       Train       0.65      0.74      0.69     87240
      Subway       0.89      0.69      0.78     86828

    accuracy                           0.81    603840
   macro avg       0.82      0.79      0.80    603840
weighted avg       0.82      0.81      0.81    603840

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[105043   2102      0    112   2095   1281   6343   2384]
 [  5284  92459    162   2727    666    794    962   1518]
 [     0   7254  31582    260      0      0      0      0]
 [  2681   3543      0  30295  10878    731      0      0]
 [   913    514      0      0  76220   3924    325      0]
 [    98    140      0     73   9593  26433    383      0]
 [  4634    237      0    238   9580   4491  64890   3170]
 [     0      5      0      0      0      0  26752  60071]]
              precision    recall  f1-score   support

       Still       0.89      0.88      0.88    119360
     Walking       0.87      0.88      0.88    104572
         Run       0.99      0.81      0.89     39096
        Bike       0.90      0.63      0.74     48128
         Car       0.70      0.93      0.80     81896
         Bus       0.70      0.72      0.71     36720
       Train       0.65      0.74      0.69     87240
      Subway       0.89      0.69      0.78     86828

    accuracy                           0.81    603840
   macro avg       0.82      0.79      0.80    603840
weighted avg       0.82      0.81      0.81    603840

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[104521   2489      0    225   1926   1386   6268   2545]
 [  5037  92824    207   2678    734    702    850   1540]
 [     0   7607  31442     47      0      0      0      0]
 [  2735   3356      0  31146  10232    659      0      0]
 [   913    470      0      0  76838   3583     92      0]
 [    60    198      0     69   9672  26593    128      0]
 [  3842    328      0    151  10584   4630  64581   3124]
 [     0      1      0      0      0      0  26745  60082]]
              precision    recall  f1-score   support

       Still       0.89      0.88      0.88    119360
     Walking       0.87      0.89      0.88    104572
         Run       0.99      0.80      0.89     39096
        Bike       0.91      0.65      0.76     48128
         Car       0.70      0.94      0.80     81896
         Bus       0.71      0.72      0.72     36720
       Train       0.65      0.74      0.69     87240
      Subway       0.89      0.69      0.78     86828

    accuracy                           0.81    603840
   macro avg       0.83      0.79      0.80    603840
weighted avg       0.82      0.81      0.81    603840

training set : all_train_set ; testing set : Torso; test order: 1
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.88
predict lgb
Time elapsed for testing lgb: 1.19
predict xgb
Time elapsed for testing xgb: 2.44
training set : all_train_set ; testing set : Torso  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26798   205     0    28   311   342  1948   208]
 [ 1637 22987    22   287   220   564   207   219]
 [    0  1889  7885     0     0     0     0     0]
 [  554   414     0  6981  3752   331     0     0]
 [  241    47     0     0 18674  1332   180     0]
 [  224    30     0    24  1684  7082   136     0]
 [ 2068    10     0    33   747  2722 15319   911]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.85      0.90      0.87     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.95      0.58      0.72     12032
         Car       0.74      0.91      0.81     20474
         Bus       0.57      0.77      0.66      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.75      0.76    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[26656   248     0    39   364   317  1994   222]
 [ 1665 23032    26   248   238   496   220   218]
 [    0  1893  7881     0     0     0     0     0]
 [  401   272     0  7208  3830   321     0     0]
 [  287    59     0     0 18663  1307   158     0]
 [  180    37     0     0  1776  7053   134     0]
 [ 2187    20     0    23   692  2704 15257   927]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.89      0.87     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.96      0.60      0.74     12032
         Car       0.73      0.91      0.81     20474
         Bus       0.58      0.77      0.66      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[26513   291     0    42   429   366  1976   223]
 [ 1554 23091    35   244   251   442   232   294]
 [    0  1896  7878     0     0     0     0     0]
 [  390   311     0  7215  3799   317     0     0]
 [  296    70     0     0 18670  1295   143     0]
 [  113    35     0     0  1842  7070   120     0]
 [ 2302    32     0     8   615  2702 15273   878]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.85      0.89      0.87     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.96      0.60      0.74     12032
         Car       0.73      0.91      0.81     20474
         Bus       0.58      0.77      0.66      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26496   302     0    10   472   387  1937   236]
 [ 1494 23006    44   238   263   482   243   373]
 [    0  1900  7874     0     0     0     0     0]
 [  353   343     0  7158  3862   316     0     0]
 [  292    82     0     0 18716  1263   121     0]
 [   81    39     0     0  1869  7068   123     0]
 [ 2385    32     0     0   588  2641 15300   864]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.85      0.89      0.87     29840
     Walking       0.90      0.88      0.89     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.97      0.59      0.74     12032
         Car       0.73      0.91      0.81     20474
         Bus       0.58      0.77      0.66      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[26481   292     0    12   482   394  1914   265]
 [ 1402 23065    48   235   271   485   264   373]
 [    0  1903  7871     0     0     0     0     0]
 [  372   355     0  7156  3834   315     0     0]
 [  289    90     0     0 18719  1275   101     0]
 [   53    42     0     0  1959  7023   103     0]
 [ 2351    30     0     0   608  2643 15331   847]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.86      0.89      0.87     29840
     Walking       0.89      0.88      0.89     26143
         Run       0.99      0.81      0.89      9774
        Bike       0.97      0.59      0.74     12032
         Car       0.72      0.91      0.81     20474
         Bus       0.58      0.77      0.66      9180
       Train       0.53      0.70      0.61     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26273   381     0    64   518   421  1844   339]
 [ 1329 23045    78   298   312   516   193   372]
 [    0  1919  7855     0     0     0     0     0]
 [  475   165     0  7395  3685   312     0     0]
 [  233   107     0     0 18962  1143    29     0]
 [   26    38     0     0  2031  7085     0     0]
 [ 2093    54     0     0   657  2779 15404   823]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.88      0.87     29840
     Walking       0.90      0.88      0.89     26143
         Run       0.99      0.80      0.89      9774
        Bike       0.95      0.61      0.75     12032
         Car       0.72      0.93      0.81     20474
         Bus       0.58      0.77      0.66      9180
       Train       0.54      0.71      0.61     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.80      0.76      0.76    150960
weighted avg       0.80      0.77      0.77    150960

training set : all_train_set ; testing set : Bag; test order: 2
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.85
predict lgb
Time elapsed for testing lgb: 1.2
predict xgb
Time elapsed for testing xgb: 2.49
training set : all_train_set ; testing set : Bag  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[27136   223     0     0   807    79   638   957]
 [ 1332 23202    17   684   210   144   304   250]
 [    0  1862  7888    24     0     0     0     0]
 [  902   640     0  5125  5079   286     0     0]
 [   92    58     0     0 19746   376   202     0]
 [    7    16     0    90  2702  6166   199     0]
 [  715    22     0    82  2602   698 16790   901]
 [    0     1     0     0     0     0  2289 19417]]
              precision    recall  f1-score   support

       Still       0.90      0.91      0.90     29840
     Walking       0.89      0.89      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.85      0.43      0.57     12032
         Car       0.63      0.96      0.77     20474
         Bus       0.80      0.67      0.73      9180
       Train       0.82      0.77      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.85      0.79      0.81    150960
weighted avg       0.85      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[27080   284     0     0   835    84   591   966]
 [ 1339 23165    28   671   250   108   287   295]
 [    0  1888  7886     0     0     0     0     0]
 [  961   567     0  5231  5032   241     0     0]
 [   93    46     0     0 19833   392   110     0]
 [    0    31     0    45  2688  6255   161     0]
 [  730    32     0    88  2601   721 16764   874]
 [    0     0     0     0     0     0  2291 19416]]
              precision    recall  f1-score   support

       Still       0.90      0.91      0.90     29840
     Walking       0.89      0.89      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.87      0.43      0.58     12032
         Car       0.63      0.97      0.77     20474
         Bus       0.80      0.68      0.74      9180
       Train       0.83      0.77      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.85      0.79      0.81    150960
weighted avg       0.85      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[27074   323     0     0   826    87   560   970]
 [ 1363 23071    34   675   246   121   296   337]
 [    0  1891  7883     0     0     0     0     0]
 [  935   478     0  5301  5075   243     0     0]
 [   76    57     0     0 19979   277    85     0]
 [    0    28     0    45  2699  6266   142     0]
 [  707    37     0    89  2564   733 16782   898]
 [    0     0     0     0     0     0  2291 19416]]
              precision    recall  f1-score   support

       Still       0.90      0.91      0.90     29840
     Walking       0.89      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.87      0.44      0.58     12032
         Car       0.64      0.98      0.77     20474
         Bus       0.81      0.68      0.74      9180
       Train       0.83      0.77      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.85      0.79      0.81    150960
weighted avg       0.85      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[27030   339     0     2   826    93   569   981]
 [ 1378 23010    36   744   223    84   305   363]
 [    0  1895  7879     0     0     0     0     0]
 [  849   477     0  5330  5122   254     0     0]
 [   69    71     0     0 20040   240    54     0]
 [    0    31     0    45  2721  6277   106     0]
 [  709    27     0    89  2606   766 16729   884]
 [    0     0     0     0     0     0  2292 19415]]
              precision    recall  f1-score   support

       Still       0.90      0.91      0.90     29840
     Walking       0.89      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.86      0.44      0.58     12032
         Car       0.64      0.98      0.77     20474
         Bus       0.81      0.68      0.74      9180
       Train       0.83      0.77      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.85      0.79      0.81    150960
weighted avg       0.85      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[27045   332     0    20   817    96   543   987]
 [ 1365 23012    36   773   216    86   288   367]
 [    0  1896  7878     0     0     0     0     0]
 [  826   415     0  5340  5193   258     0     0]
 [   67    69     0     0 20070   224    44     0]
 [    0    32     0    46  2706  6321    75     0]
 [  666    26     0    83  2666   777 16721   871]
 [    0     0     0     0     0     0  2293 19414]]
              precision    recall  f1-score   support

       Still       0.90      0.91      0.90     29840
     Walking       0.89      0.88      0.89     26143
         Run       1.00      0.81      0.89      9774
        Bike       0.85      0.44      0.58     12032
         Car       0.63      0.98      0.77     20474
         Bus       0.81      0.69      0.75      9180
       Train       0.84      0.77      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.85      0.80      0.81    150960
weighted avg       0.85      0.83      0.83    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[27030   398     0    45   673   159   519  1016]
 [ 1500 22975    43   752   283    18   199   373]
 [    0  1906  7868     0     0     0     0     0]
 [  757   307     0  5385  5326   257     0     0]
 [   71    50     0     0 20215   129     9     0]
 [    0    34     0    51  2681  6414     0     0]
 [  430    47     0    42  3114   818 16520   839]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.91      0.91      0.91     29840
     Walking       0.89      0.88      0.89     26143
         Run       0.99      0.80      0.89      9774
        Bike       0.86      0.45      0.59     12032
         Car       0.63      0.99      0.77     20474
         Bus       0.82      0.70      0.76      9180
       Train       0.85      0.76      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    150960
   macro avg       0.86      0.80      0.81    150960
weighted avg       0.85      0.83      0.83    150960

training set : all_train_set ; testing set : Hand; test order: 3
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.91
predict lgb
Time elapsed for testing lgb: 1.26
predict xgb
Time elapsed for testing xgb: 2.46
training set : all_train_set ; testing set : Hand  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[26659   450     0    26   636   620   473   976]
 [ 1755 22567    18  1073   163   109   147   311]
 [    0  1481  8259    34     0     0     0     0]
 [  828   180     0  9031  1847   146     0     0]
 [  392   281     0     0 18448  1213   140     0]
 [   11     8     0    39  2929  6190     3     0]
 [ 1172    79     0    81  3307   186 16368   617]
 [    0     0     0     0     0     0  2274 19433]]
              precision    recall  f1-score   support

       Still       0.87      0.89      0.88     29840
     Walking       0.90      0.86      0.88     26143
         Run       1.00      0.84      0.92      9774
        Bike       0.88      0.75      0.81     12032
         Car       0.68      0.90      0.77     20474
         Bus       0.73      0.67      0.70      9180
       Train       0.84      0.75      0.79     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.84    150960
   macro avg       0.85      0.82      0.83    150960
weighted avg       0.85      0.84      0.84    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[26797   513     0    38   614   558   343   977]
 [ 1639 22760    27  1010   130    63   135   379]
 [    0  1479  8257    38     0     0     0     0]
 [  801    63     0  9247  1801   120     0     0]
 [  366   240     0     0 18695  1113    60     0]
 [    9    11     0    26  2851  6283     0     0]
 [ 1093    94     0    83  3316   197 16382   645]
 [    0     0     0     0     0     0  2270 19437]]
              precision    recall  f1-score   support

       Still       0.87      0.90      0.89     29840
     Walking       0.90      0.87      0.89     26143
         Run       1.00      0.84      0.91      9774
        Bike       0.89      0.77      0.82     12032
         Car       0.68      0.91      0.78     20474
         Bus       0.75      0.68      0.72      9180
       Train       0.85      0.75      0.80     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.85    150960
   macro avg       0.86      0.83      0.84    150960
weighted avg       0.86      0.85      0.85    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[26845   513     0    17   648   546   290   981]
 [ 1577 22731    36  1027   125   107   129   411]
 [    0  1493  8251    30     0     0     0     0]
 [  658    33     0  9433  1779   129     0     0]
 [  321   244     0     0 18759  1099    51     0]
 [    9    10     0    23  2846  6292     0     0]
 [  975    95     0   122  3231   220 16538   629]
 [    0     0     0     0     0     0  2267 19440]]
              precision    recall  f1-score   support

       Still       0.88      0.90      0.89     29840
     Walking       0.90      0.87      0.89     26143
         Run       1.00      0.84      0.91      9774
        Bike       0.89      0.78      0.83     12032
         Car       0.68      0.92      0.78     20474
         Bus       0.75      0.69      0.72      9180
       Train       0.86      0.76      0.81     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.85    150960
   macro avg       0.86      0.83      0.84    150960
weighted avg       0.86      0.85      0.85    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[26812   540     0    18   661   547   275   987]
 [ 1545 22745    42  1018   133   122   128   410]
 [    0  1503  8233    38     0     0     0     0]
 [  672    43     0  9435  1716   166     0     0]
 [  306   275     0     0 18754  1109    30     0]
 [   10    12     0    24  2850  6284     0     0]
 [  960    97     0   147  3266   196 16513   631]
 [    0     3     0     0     0     0  2263 19441]]
              precision    recall  f1-score   support

       Still       0.88      0.90      0.89     29840
     Walking       0.90      0.87      0.89     26143
         Run       0.99      0.84      0.91      9774
        Bike       0.88      0.78      0.83     12032
         Car       0.68      0.92      0.78     20474
         Bus       0.75      0.68      0.71      9180
       Train       0.86      0.76      0.81     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.85    150960
   macro avg       0.86      0.83      0.84    150960
weighted avg       0.86      0.85      0.85    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[26744   536     0    22   663   577   308   990]
 [ 1476 22773    44  1035   136   122   148   409]
 [    0  1502  8237    35     0     0     0     0]
 [  664    49     0  9450  1711   158     0     0]
 [  281   273     0     0 18782  1105    33     0]
 [    1    12     0    25  2872  6270     0     0]
 [  905   103     0   148  3346   191 16479   638]
 [    0     4     0     0     0     0  2261 19442]]
              precision    recall  f1-score   support

       Still       0.89      0.90      0.89     29840
     Walking       0.90      0.87      0.89     26143
         Run       0.99      0.84      0.91      9774
        Bike       0.88      0.79      0.83     12032
         Car       0.68      0.92      0.78     20474
         Bus       0.74      0.68      0.71      9180
       Train       0.86      0.76      0.80     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.85    150960
   macro avg       0.86      0.83      0.84    150960
weighted avg       0.86      0.85      0.85    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[26536   592     0    40   649   600   408  1015]
 [ 1303 22917    52  1067   139   109   139   417]
 [    0  1541  8233     0     0     0     0     0]
 [  721     0     0 10026  1195    90     0     0]
 [  361   192     0     0 18939   982     0     0]
 [    6    21     0    18  2864  6271     0     0]
 [  649   146     0   109  3782   153 16319   652]
 [    0     1     0     0     0     0  2251 19455]]
              precision    recall  f1-score   support

       Still       0.90      0.89      0.89     29840
     Walking       0.90      0.88      0.89     26143
         Run       0.99      0.84      0.91      9774
        Bike       0.89      0.83      0.86     12032
         Car       0.69      0.93      0.79     20474
         Bus       0.76      0.68      0.72      9180
       Train       0.85      0.75      0.80     21810
      Subway       0.90      0.90      0.90     21707

    accuracy                           0.85    150960
   macro avg       0.86      0.84      0.85    150960
weighted avg       0.86      0.85      0.85    150960

training set : all_train_set ; testing set : Hips; test order: 4
X_val  : (150960, 204)
y_val  : 150960
predict rf
Time elapsed for testing rf 0.82
predict lgb
Time elapsed for testing lgb: 1.14
predict xgb
Time elapsed for testing xgb: 2.38
training set : all_train_set ; testing set : Hips  testing result
----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 80
[[24680   758     0    11   318   333  3621   119]
 [ 1400 23256    16   853    70   120   185   243]
 [    0  1847  7617   310     0     0     0     0]
 [  788  2796     0  7948   500     0     0     0]
 [  451    61     0     0 18353  1421   188     0]
 [   29    15     0    43  2023  6807   263     0]
 [  929    26     0    18  2540   982 16552   763]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.83      0.85     29840
     Walking       0.81      0.89      0.85     26143
         Run       1.00      0.78      0.88      9774
        Bike       0.87      0.66      0.75     12032
         Car       0.77      0.90      0.83     20474
         Bus       0.70      0.74      0.72      9180
       Train       0.52      0.76      0.62     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.81      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 120
[[24798   784     0    38   203   278  3620   119]
 [ 1220 23365    25   862    55   132   180   304]
 [    0  1897  7593   284     0     0     0     0]
 [  785  2751     0  8163   333     0     0     0]
 [  385    48     0     0 18517  1351   173     0]
 [   43    17     0    51  2034  6802   233     0]
 [  853    54     0     3  2636   946 16504   814]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.88      0.83      0.86     29840
     Walking       0.81      0.89      0.85     26143
         Run       1.00      0.78      0.87      9774
        Bike       0.87      0.68      0.76     12032
         Car       0.78      0.90      0.84     20474
         Bus       0.72      0.74      0.73      9180
       Train       0.52      0.76      0.62     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.81      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 150
[[24739   893     0    46   164   267  3608   123]
 [ 1145 23504    34   737    50   119   215   339]
 [    0  1956  7525   293     0     0     0     0]
 [  777  2838     0  8162   255     0     0     0]
 [  348    64     0     0 18583  1317   162     0]
 [   42    25     0    47  1993  6820   253     0]
 [  741    57     0    28  2782   943 16405   854]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.83      0.86     29840
     Walking       0.80      0.90      0.85     26143
         Run       1.00      0.77      0.87      9774
        Bike       0.88      0.68      0.76     12032
         Car       0.78      0.91      0.84     20474
         Bus       0.72      0.74      0.73      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.81      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 180
[[24754   918     0    56   162   224  3592   134]
 [ 1086 23578    34   686    49    98   245   367]
 [    0  1930  7562   282     0     0     0     0]
 [  816  2749     0  8266   201     0     0     0]
 [  294    76     0     0 18647  1304   153     0]
 [   43    43     0    22  2053  6821   198     0]
 [  716    68     0    24  2907   891 16374   830]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.83      0.86     29840
     Walking       0.80      0.90      0.85     26143
         Run       1.00      0.77      0.87      9774
        Bike       0.89      0.69      0.77     12032
         Car       0.78      0.91      0.84     20474
         Bus       0.73      0.74      0.74      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.81      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 200
[[24773   942     0    58   133   214  3578   142]
 [ 1041 23609    34   684    43   101   262   369]
 [    0  1953  7596   225     0     0     0     0]
 [  819  2724     0  8349   140     0     0     0]
 [  276    82     0     0 18649  1320   147     0]
 [   44    54     0     2  2056  6819   205     0]
 [  712    78     0     7  2960   880 16359   814]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.83      0.86     29840
     Walking       0.80      0.90      0.85     26143
         Run       1.00      0.78      0.87      9774
        Bike       0.90      0.69      0.78     12032
         Car       0.78      0.91      0.84     20474
         Bus       0.73      0.74      0.74      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.81      0.76      0.77    150960
weighted avg       0.80      0.77      0.77    150960

----------------------------rf bag lgb xgb catboost  ---------------------------------
tree_model.pred_mean with window : 300
[[24682  1118     0    76    86   206  3497   175]
 [  905 23887    34   561     0    59   319   378]
 [    0  2388  7339    47     0     0     0     0]
 [  782  2884     0  8340    26     0     0     0]
 [  248   121     0     0 18722  1329    54     0]
 [   28   105     0     0  2096  6823   128     0]
 [  670    81     0     0  3031   880 16338   810]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.83      0.86     29840
     Walking       0.78      0.91      0.84     26143
         Run       1.00      0.75      0.86      9774
        Bike       0.92      0.69      0.79     12032
         Car       0.78      0.91      0.84     20474
         Bus       0.73      0.74      0.74      9180
       Train       0.52      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.77    150960
   macro avg       0.82      0.76      0.77    150960
weighted avg       0.81      0.77      0.77    150960

