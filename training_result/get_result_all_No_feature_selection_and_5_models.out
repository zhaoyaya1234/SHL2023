nohup: ignoring input
the all length of training set:3922100
the all length of test set:575840
begin training single
training set:Hips,the 0th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 184.93
Training bag (tree-based)...
Time elapsed for training bag (tree-based): 138.98
Training CatBoost...
0:	learn: 1.4843412	total: 440ms	remaining: 43.6s
1:	learn: 1.1071580	total: 760ms	remaining: 37.2s
2:	learn: 0.8563423	total: 1.06s	remaining: 34.2s
3:	learn: 0.6852106	total: 1.43s	remaining: 34.4s
4:	learn: 0.5777140	total: 1.75s	remaining: 33.2s
5:	learn: 0.5463731	total: 2.02s	remaining: 31.6s
6:	learn: 0.5225494	total: 2.32s	remaining: 30.9s
7:	learn: 0.4761598	total: 2.67s	remaining: 30.7s
8:	learn: 0.4757629	total: 2.94s	remaining: 29.7s
9:	learn: 0.4569862	total: 3.25s	remaining: 29.2s
10:	learn: 4.1079795	total: 3.54s	remaining: 28.6s
11:	learn: 4.3647564	total: 3.82s	remaining: 28s
12:	learn: 4.3711865	total: 4.15s	remaining: 27.8s
13:	learn: 4.3437774	total: 4.46s	remaining: 27.4s
14:	learn: 4.3084528	total: 4.85s	remaining: 27.5s
15:	learn: 4.2783945	total: 5.21s	remaining: 27.4s
16:	learn: 4.2707614	total: 5.49s	remaining: 26.8s
17:	learn: 4.2620654	total: 5.79s	remaining: 26.4s
18:	learn: 4.2231073	total: 6.08s	remaining: 25.9s
19:	learn: 4.1763011	total: 6.39s	remaining: 25.6s
20:	learn: 4.1360386	total: 6.7s	remaining: 25.2s
21:	learn: 4.0774114	total: 6.97s	remaining: 24.7s
22:	learn: 4.0208762	total: 7.26s	remaining: 24.3s
23:	learn: 3.9726195	total: 7.54s	remaining: 23.9s
24:	learn: 3.9200070	total: 7.84s	remaining: 23.5s
25:	learn: 3.8697423	total: 8.12s	remaining: 23.1s
26:	learn: 3.8260666	total: 8.39s	remaining: 22.7s
27:	learn: 3.7860959	total: 8.67s	remaining: 22.3s
28:	learn: 3.7379144	total: 8.95s	remaining: 21.9s
29:	learn: 3.6918243	total: 9.24s	remaining: 21.6s
30:	learn: 3.6674723	total: 9.51s	remaining: 21.2s
31:	learn: 3.2794081	total: 9.81s	remaining: 20.8s
32:	learn: 3.2735187	total: 10.2s	remaining: 20.7s
33:	learn: 2.8878673	total: 10.5s	remaining: 20.3s
34:	learn: 2.5050660	total: 10.7s	remaining: 19.9s
35:	learn: 2.1706647	total: 11s	remaining: 19.6s
36:	learn: 3.1580065	total: 11.3s	remaining: 19.3s
37:	learn: 3.1466418	total: 11.6s	remaining: 18.9s
38:	learn: 3.1234884	total: 11.9s	remaining: 18.6s
39:	learn: 3.1090044	total: 12.2s	remaining: 18.2s
40:	learn: 3.1060192	total: 12.5s	remaining: 17.9s
41:	learn: 3.0975751	total: 12.8s	remaining: 17.6s
42:	learn: 2.9826873	total: 13.1s	remaining: 17.4s
43:	learn: 2.9815284	total: 13.4s	remaining: 17s
44:	learn: 2.9275007	total: 13.7s	remaining: 16.7s
45:	learn: 2.9165926	total: 14s	remaining: 16.5s
46:	learn: 2.9126421	total: 14.4s	remaining: 16.2s
47:	learn: 2.9080806	total: 14.8s	remaining: 16s
48:	learn: 2.9068686	total: 15.1s	remaining: 15.7s
49:	learn: 2.9039837	total: 15.5s	remaining: 15.5s
50:	learn: 2.9013829	total: 15.8s	remaining: 15.2s
51:	learn: 2.8980332	total: 16.1s	remaining: 14.9s
52:	learn: 2.8842747	total: 16.4s	remaining: 14.5s
53:	learn: 2.8798153	total: 16.7s	remaining: 14.2s
54:	learn: 2.7003889	total: 17.1s	remaining: 14s
55:	learn: 2.6721352	total: 17.4s	remaining: 13.7s
56:	learn: 2.6658077	total: 17.7s	remaining: 13.4s
57:	learn: 2.6634667	total: 18s	remaining: 13s
58:	learn: 2.6610976	total: 18.3s	remaining: 12.7s
59:	learn: 2.6596563	total: 18.6s	remaining: 12.4s
60:	learn: 2.6573480	total: 18.9s	remaining: 12.1s
61:	learn: 2.6223686	total: 19.3s	remaining: 11.8s
62:	learn: 2.5329126	total: 19.6s	remaining: 11.5s
63:	learn: 2.5309008	total: 19.9s	remaining: 11.2s
64:	learn: 2.5264644	total: 20.2s	remaining: 10.9s
65:	learn: 2.5003856	total: 20.5s	remaining: 10.6s
66:	learn: 2.4951230	total: 21s	remaining: 10.3s
67:	learn: 2.4899325	total: 21.4s	remaining: 10s
68:	learn: 2.4849999	total: 21.6s	remaining: 9.72s
69:	learn: 2.4801414	total: 21.9s	remaining: 9.39s
70:	learn: 2.4781439	total: 22.2s	remaining: 9.07s
71:	learn: 2.3158457	total: 22.6s	remaining: 8.8s
72:	learn: 2.3148683	total: 22.9s	remaining: 8.47s
73:	learn: 2.2013244	total: 23.2s	remaining: 8.16s
74:	learn: 2.1967584	total: 23.5s	remaining: 7.83s
75:	learn: 2.1929575	total: 23.8s	remaining: 7.51s
76:	learn: 2.1923851	total: 24.1s	remaining: 7.19s
77:	learn: 2.1892101	total: 24.4s	remaining: 6.87s
78:	learn: 2.1859529	total: 24.7s	remaining: 6.56s
79:	learn: 2.1848525	total: 25s	remaining: 6.24s
80:	learn: 2.1815407	total: 25.2s	remaining: 5.92s
81:	learn: 2.1783120	total: 25.5s	remaining: 5.6s
82:	learn: 2.1750395	total: 25.8s	remaining: 5.29s
83:	learn: 2.1715384	total: 26.1s	remaining: 4.98s
84:	learn: 1.9493554	total: 26.5s	remaining: 4.67s
85:	learn: 1.9452808	total: 26.7s	remaining: 4.35s
86:	learn: 1.9414769	total: 27s	remaining: 4.04s
87:	learn: 1.9378185	total: 27.3s	remaining: 3.72s
88:	learn: 1.9346177	total: 27.6s	remaining: 3.41s
89:	learn: 1.9313324	total: 27.9s	remaining: 3.1s
90:	learn: 1.9304693	total: 28.2s	remaining: 2.79s
91:	learn: 1.9290340	total: 28.5s	remaining: 2.48s
92:	learn: 1.9258480	total: 28.8s	remaining: 2.17s
93:	learn: 1.9228763	total: 29s	remaining: 1.85s
94:	learn: 1.9203256	total: 29.4s	remaining: 1.55s
95:	learn: 1.9170553	total: 29.7s	remaining: 1.24s
96:	learn: 1.9153384	total: 30s	remaining: 929ms
97:	learn: 1.9123410	total: 30.3s	remaining: 619ms
98:	learn: 1.9094295	total: 30.6s	remaining: 309ms
99:	learn: 1.9065723	total: 30.9s	remaining: 0us
Time elapsed for training CatBoost: 32.05
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.554076 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47626
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.081683
[LightGBM] [Info] Start training from score -2.077796
[LightGBM] [Info] Start training from score -3.143183
[LightGBM] [Info] Start training from score -2.125946
[LightGBM] [Info] Start training from score -1.819703
[LightGBM] [Info] Start training from score -1.934305
[LightGBM] [Info] Start training from score -1.837287
[LightGBM] [Info] Start training from score -2.105693
[1]	valid_0's multi_logloss: 1.46829
[2]	valid_0's multi_logloss: 1.18303
[3]	valid_0's multi_logloss: 0.981746
[4]	valid_0's multi_logloss: 0.828295
[5]	valid_0's multi_logloss: 0.706941
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.60927
[7]	valid_0's multi_logloss: 0.529184
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.462695
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[9]	valid_0's multi_logloss: 0.406911
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[10]	valid_0's multi_logloss: 0.360343
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[11]	valid_0's multi_logloss: 0.320556
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[12]	valid_0's multi_logloss: 0.286578
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[13]	valid_0's multi_logloss: 0.257281
[14]	valid_0's multi_logloss: 0.231996
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[15]	valid_0's multi_logloss: 0.209194
[16]	valid_0's multi_logloss: 0.190372
[17]	valid_0's multi_logloss: 0.173513
[18]	valid_0's multi_logloss: 0.15896
[19]	valid_0's multi_logloss: 0.146452
[20]	valid_0's multi_logloss: 0.135503
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[21]	valid_0's multi_logloss: 0.126411
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[22]	valid_0's multi_logloss: 0.117899
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[23]	valid_0's multi_logloss: 0.109824
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[24]	valid_0's multi_logloss: 0.103126
[25]	valid_0's multi_logloss: 0.0970692
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[26]	valid_0's multi_logloss: 0.0914448
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[27]	valid_0's multi_logloss: 0.0863391
[28]	valid_0's multi_logloss: 0.0818983
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[29]	valid_0's multi_logloss: 0.0780099
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[30]	valid_0's multi_logloss: 0.0736014
[31]	valid_0's multi_logloss: 0.0702704
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[32]	valid_0's multi_logloss: 0.0670907
[33]	valid_0's multi_logloss: 0.0642042
[34]	valid_0's multi_logloss: 0.061369
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[35]	valid_0's multi_logloss: 0.058632
[36]	valid_0's multi_logloss: 0.0564105
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.0541378
[38]	valid_0's multi_logloss: 0.0519708
[39]	valid_0's multi_logloss: 0.0500076
[40]	valid_0's multi_logloss: 0.0480647
[41]	valid_0's multi_logloss: 0.0463827
[42]	valid_0's multi_logloss: 0.044773
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[43]	valid_0's multi_logloss: 0.0429931
[44]	valid_0's multi_logloss: 0.0413706
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0398557
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0386857
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0372315
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0359063
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0348653
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0335784
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0324642
[52]	valid_0's multi_logloss: 0.0314257
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0305813
[54]	valid_0's multi_logloss: 0.029685
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0288789
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.027744
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0269667
[58]	valid_0's multi_logloss: 0.0260184
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0251448
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0243951
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.023709
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0230078
[63]	valid_0's multi_logloss: 0.0222728
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0217336
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0211422
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0206773
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0199916
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0195111
[69]	valid_0's multi_logloss: 0.0189388
[70]	valid_0's multi_logloss: 0.0185533
[71]	valid_0's multi_logloss: 0.0180174
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0176312
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0172284
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0167716
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.016217
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0158945
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0155041
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0152147
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0148696
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0146516
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0144011
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0141443
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.01373
[84]	valid_0's multi_logloss: 0.0134199
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0130782
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0127792
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.012576
[88]	valid_0's multi_logloss: 0.0122627
[89]	valid_0's multi_logloss: 0.0120325
[90]	valid_0's multi_logloss: 0.0117269
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[91]	valid_0's multi_logloss: 0.0114396
[92]	valid_0's multi_logloss: 0.0111884
[93]	valid_0's multi_logloss: 0.0109026
[94]	valid_0's multi_logloss: 0.0106703
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.010473
[96]	valid_0's multi_logloss: 0.0102726
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.0100785
[98]	valid_0's multi_logloss: 0.00992793
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.00973271
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[100]	valid_0's multi_logloss: 0.00956811
Time elapsed for training LightGBM: 80.05
Training XGBoost...
Time elapsed for training XGBoost: 355.57
begin testing
training set : Hips ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.19
predict bag
Time elapsed for testing bag: 41.16
predict catboost
Time elapsed for testing CatBoost: 0.32
predict lgb
Time elapsed for testing lgb: 1.25
predict xgb
Time elapsed for testing xgb: 2.67
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hips ; testing set : Torso  testing result
tree_model.pred_mean
[[25940    10     0   109   942   511  1946   382]
 [ 3184  4824     0 10805   435  4548   779  1568]
 [    0   496     0  2278     0     0     0     0]
 [  619     0     0  7551  2730  1132     0     0]
 [  194     0     0     0 20054   226     0     0]
 [   97     0     0    50   691  8129   213     0]
 [ 2556     0     0    27   331  2439 15344  1113]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.80      0.87      0.83     29840
     Walking       0.91      0.18      0.31     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.36      0.63      0.46     12032
         Car       0.80      0.98      0.88     20474
         Bus       0.48      0.89      0.62      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.78      0.49      0.60     21707

    accuracy                           0.64    143960
   macro avg       0.58      0.59      0.54    143960
weighted avg       0.70      0.64      0.61    143960

tree_model.pred_mean_rf
[[24844     0     0    48  1726  1005  1772   445]
 [ 1550   789     0 17454  1110  3666   362  1212]
 [    0   852     0  1922     0     0     0     0]
 [    9     0     0  3396  5310  3167   150     0]
 [  268     0     0     0 18097  1978     0   131]
 [ 1174     0     0    21   480  7505     0     0]
 [ 2496     0     0    24     0  2468 13341  3481]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.83      0.83     29840
     Walking       0.48      0.03      0.06     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.15      0.28      0.19     12032
         Car       0.68      0.88      0.77     20474
         Bus       0.38      0.82      0.52      9180
       Train       0.50      0.61      0.55     21810
      Subway       0.67      0.49      0.56     21707

    accuracy                           0.55    143960
   macro avg       0.46      0.49      0.43    143960
weighted avg       0.57      0.55      0.51    143960

tree_model.pred_mean_bag
[[19673    11     0    38  3346  3747  2040   985]
 [  690 15149     0  2960  1362  3840   797  1345]
 [    0  1826    42   906     0     0     0     0]
 [    1   474     0  1249  5474  4834     0     0]
 [  264     0     0     0 17987  2144    79     0]
 [  688     0     0     8   519  7965     0     0]
 [ 2413     0     0    19   844  2757 15168   609]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.66      0.73     29840
     Walking       0.87      0.58      0.69     26143
         Run       1.00      0.02      0.03      2774
        Bike       0.24      0.10      0.15     12032
         Car       0.61      0.88      0.72     20474
         Bus       0.31      0.87      0.46      9180
       Train       0.52      0.70      0.59     21810
      Subway       0.78      0.49      0.60     21707

    accuracy                           0.61    143960
   macro avg       0.65      0.54      0.50    143960
weighted avg       0.67      0.61      0.60    143960

tree_model.pred_mean_catboost
[[25196    11     0   355   644   181  2861   592]
 [ 4461  8626     0  5288   389  4087  2604   688]
 [    0   225     0  2549     0     0     0     0]
 [ 1878    84     0  6062  3488   379   141     0]
 [  454    12     0     0 19413   513    82     0]
 [  252    15     0    18  1538  7165   192     0]
 [ 3952     6     0    13   333  1169 15687   650]
 [    0     0     0     0     0     0 10113 11594]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.70      0.84      0.76     29840
     Walking       0.96      0.33      0.49     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.42      0.50      0.46     12032
         Car       0.75      0.95      0.84     20474
         Bus       0.53      0.78      0.63      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.86      0.53      0.66     21707

    accuracy                           0.65    143960
   macro avg       0.59      0.58      0.55    143960
weighted avg       0.70      0.65      0.63    143960

tree_model.pred_mean_lightgbm
[[23271   210     0   164  1808   934  2593   860]
 [ 2462  5883     0 10285   359  4696   769  1689]
 [    0   808     0  1966     0     0     0     0]
 [  537     0     0  8130  2560   805     0     0]
 [  167     0     0     0 20199   108     0     0]
 [   18     0     0    67   682  7842   571     0]
 [ 1462     1     0    42   682  3336 15184  1103]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.83      0.78      0.81     29840
     Walking       0.85      0.23      0.36     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.39      0.68      0.50     12032
         Car       0.77      0.99      0.86     20474
         Bus       0.44      0.85      0.58      9180
       Train       0.50      0.70      0.58     21810
      Subway       0.74      0.49      0.59     21707

    accuracy                           0.63    143960
   macro avg       0.57      0.59      0.53    143960
weighted avg       0.69      0.63      0.61    143960

tree_model.pred_mean_xgb
[[26086    27     0   250   985   621  1647   224]
 [ 4748  3258     0 11439   389  4005   520  1784]
 [    0   823     0  1479     0   472     0     0]
 [  688     0     0  8015  2233  1096     0     0]
 [  403     0     0     0 19844   227     0     0]
 [   99     0     0    82   977  7813   209     0]
 [ 1867     0     0    36   360  3050 15321  1176]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.77      0.87      0.82     29840
     Walking       0.79      0.12      0.22     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.38      0.67      0.48     12032
         Car       0.80      0.97      0.88     20474
         Bus       0.45      0.85      0.59      9180
       Train       0.53      0.70      0.61     21810
      Subway       0.77      0.49      0.60     21707

    accuracy                           0.63    143960
   macro avg       0.56      0.58      0.52    143960
weighted avg       0.67      0.63      0.59    143960

test over
training set : Hips ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.99
predict bag
Time elapsed for testing bag: 41.59
predict catboost
Time elapsed for testing CatBoost: 0.34
predict lgb
Time elapsed for testing lgb: 1.35
predict xgb
Time elapsed for testing xgb: 3.11
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hips ; testing set : Bag  testing result
tree_model.pred_mean
[[27754    11     0   115   228    68   617  1047]
 [ 4202  4720     0 12805   502  2027   542  1345]
 [    0  1818     0   956     0     0     0     0]
 [ 1493     0     0  4450  4674  1415     0     0]
 [  100     0     0     7 18033  2334     0     0]
 [   31     0     0   152  3041  5701   255     0]
 [  818     0     0   106  2288   797 16722  1079]
 [    0     0     0     0     0     0  2289 19418]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.81      0.93      0.86     29840
     Walking       0.72      0.18      0.29     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.24      0.37      0.29     12032
         Car       0.63      0.88      0.73     20474
         Bus       0.46      0.62      0.53      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.67    143960
   macro avg       0.57      0.58      0.55    143960
weighted avg       0.69      0.67      0.65    143960

tree_model.pred_mean_rf
[[28304     0     0    67   451   216   410   392]
 [ 1343   618     0 17641  1083  3502   428  1528]
 [    0   651     0  2123     0     0     0     0]
 [   78     0     0   935  7800  3219     0     0]
 [  101     0     0     8 18239  1928   101    97]
 [   13     0     0    63   711  8393     0     0]
 [ 1047     0     0    34   946   891 16002  2890]
 [    0     0     0     0     0     0  2301 19406]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.92      0.95      0.93     29840
     Walking       0.49      0.02      0.05     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.04      0.08      0.06     12032
         Car       0.62      0.89      0.73     20474
         Bus       0.46      0.91      0.61      9180
       Train       0.83      0.73      0.78     21810
      Subway       0.80      0.89      0.84     21707

    accuracy                           0.64    143960
   macro avg       0.52      0.56      0.50    143960
weighted avg       0.65      0.64      0.59    143960

tree_model.pred_mean_bag
[[25607    12     0    36   583   527  2164   911]
 [  716 13419     0  2550  2378  4937   785  1358]
 [    0  1881     0   893     0     0     0     0]
 [   42    60     0   432  5789  5709     0     0]
 [  479     0     0     0 17895  2014    86     0]
 [   40     0     0    87   420  8454   179     0]
 [ 1274     0     0    10  2774  1545 15686   521]
 [    0     0     0     0     0     0  2296 19411]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.91      0.86      0.88     29840
     Walking       0.87      0.51      0.65     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.11      0.04      0.05     12032
         Car       0.60      0.87      0.71     20474
         Bus       0.36      0.92      0.52      9180
       Train       0.74      0.72      0.73     21810
      Subway       0.87      0.89      0.88     21707

    accuracy                           0.70    143960
   macro avg       0.56      0.60      0.55    143960
weighted avg       0.71      0.70      0.68    143960

tree_model.pred_mean_catboost
[[25903    21     0   300   194   463  1768  1191]
 [ 4116 12145     0  7276   251  1203   418   734]
 [    0  1884     0   890     0     0     0     0]
 [ 2688   151     0  5394  2624  1175     0     0]
 [  164     0     0     0 16975  3260    75     0]
 [   36    15     0    80  4013  4779   257     0]
 [ 1489    27     0   116  2027   730 16673   748]
 [    0     0     0     0     0     0  1352 20355]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.75      0.87      0.81     29840
     Walking       0.85      0.46      0.60     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.38      0.45      0.41     12032
         Car       0.65      0.83      0.73     20474
         Bus       0.41      0.52      0.46      9180
       Train       0.81      0.76      0.79     21810
      Subway       0.88      0.94      0.91     21707

    accuracy                           0.71    143960
   macro avg       0.59      0.60      0.59    143960
weighted avg       0.72      0.71      0.70    143960

tree_model.pred_mean_lightgbm
[[26754   264     0   147   260   430   794  1191]
 [ 4118  3440     0 13803   495  2083   564  1640]
 [    0  1472     0  1302     0     0     0     0]
 [ 1353   244     0  6471  3350   614     0     0]
 [   68     2     0    22 19014  1368     0     0]
 [   24     0     0   616  3027  4944   569     0]
 [  382   180     0   160  3396   691 15915  1086]
 [    0     0     0     0     0     0  2283 19424]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.90      0.86     29840
     Walking       0.61      0.13      0.22     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.29      0.54      0.37     12032
         Car       0.64      0.93      0.76     20474
         Bus       0.49      0.54      0.51      9180
       Train       0.79      0.73      0.76     21810
      Subway       0.83      0.89      0.86     21707

    accuracy                           0.67    143960
   macro avg       0.56      0.58      0.54    143960
weighted avg       0.67      0.67      0.63    143960

tree_model.pred_mean_xgb
[[27531    31     0   235   235   313   482  1013]
 [ 4423  1259     0 16010   247  2073   460  1671]
 [    0  1608     0  1166     0     0     0     0]
 [  726   452     0  7023  2537  1294     0     0]
 [  142     0     0    19 17909  2404     0     0]
 [   38     0     0   331  3609  4813   389     0]
 [  733     0     0   158  1994   795 17097  1033]
 [    0     0     0     0     0     0  2287 19420]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.38      0.05      0.09     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.28      0.58      0.38     12032
         Car       0.68      0.87      0.76     20474
         Bus       0.41      0.52      0.46      9180
       Train       0.83      0.78      0.80     21810
      Subway       0.84      0.89      0.87     21707

    accuracy                           0.66    143960
   macro avg       0.53      0.58      0.53    143960
weighted avg       0.64      0.66      0.62    143960

test over
training set : Hips ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.27
predict bag
Time elapsed for testing bag: 42.92
predict catboost
Time elapsed for testing CatBoost: 0.35
predict lgb
Time elapsed for testing lgb: 1.5
predict xgb
Time elapsed for testing xgb: 3.45
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hips ; testing set : Hand  testing result
tree_model.pred_mean
[[25761   328     0   668   386   663  1014  1020]
 [ 1405 14543     0  8894     2    34   316   949]
 [    0  1394     0  1380     0     0     0     0]
 [    0     0     0 11937    61    34     0     0]
 [  467   189     0   501 18124  1193     0     0]
 [    9     0     0   219  3600  5156   196     0]
 [ 1059     0     0   469  3132   181 15797  1172]
 [    0     0     0     0     0     0  2262 19445]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.88      0.56      0.68     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.50      0.99      0.66     12032
         Car       0.72      0.89      0.79     20474
         Bus       0.71      0.56      0.63      9180
       Train       0.81      0.72      0.76     21810
      Subway       0.86      0.90      0.88     21707

    accuracy                           0.77    143960
   macro avg       0.67      0.68      0.66    143960
weighted avg       0.79      0.77      0.76    143960

tree_model.pred_mean_rf
[[24395   273     0   731  1210  1351   847  1033]
 [  718  9528     0 14694   240   234   153   576]
 [    0  1835     0   939     0     0     0     0]
 [   13     0     0  9604  2118   297     0     0]
 [  611   173     0   399 17401  1857     0    33]
 [   49     0     0   171  2285  6675     0     0]
 [  909     4     0   215  2444   429 15081  2728]
 [    0     0     0     0     0     0     0 21707]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.91      0.82      0.86     29840
     Walking       0.81      0.36      0.50     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.36      0.80      0.50     12032
         Car       0.68      0.85      0.75     20474
         Bus       0.62      0.73      0.67      9180
       Train       0.94      0.69      0.80     21810
      Subway       0.83      1.00      0.91     21707

    accuracy                           0.73    143960
   macro avg       0.64      0.66      0.62    143960
weighted avg       0.77      0.73      0.72    143960

tree_model.pred_mean_bag
[[21755  1644     0   107  1318  2579  2112   325]
 [  167 21569     0  3213   308   313   259   314]
 [    0  1942    34   798     0     0     0     0]
 [    0  4165     0  4753  1972  1142     0     0]
 [  437   275     0   788 16869  2105     0     0]
 [  126    14     0   129   981  7930     0     0]
 [  979    54     0   161  4727   829 14419   641]
 [    0     0     0     0     0     0    37 21670]]
              precision    recall  f1-score   support

       Still       0.93      0.73      0.82     29840
     Walking       0.73      0.83      0.77     26143
         Run       1.00      0.01      0.02      2774
        Bike       0.48      0.40      0.43     12032
         Car       0.64      0.82      0.72     20474
         Bus       0.53      0.86      0.66      9180
       Train       0.86      0.66      0.75     21810
      Subway       0.94      1.00      0.97     21707

    accuracy                           0.76    143960
   macro avg       0.76      0.66      0.64    143960
weighted avg       0.78      0.76      0.75    143960

tree_model.pred_mean_catboost
[[24938   158     0  1396   219   257  1917   955]
 [ 2361 16121     0  6136   113   115   329   968]
 [    0  1429     0  1345     0     0     0     0]
 [  200   416     0 11324    16    76     0     0]
 [  611    56     0   707 17631  1469     0     0]
 [  146     0     0   169  4274  4481   110     0]
 [ 1492    19     0   225  2342   268 16580   884]
 [    0     0     0     0     0     0  1801 19906]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.84      0.84      0.84     29840
     Walking       0.89      0.62      0.73     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.53      0.94      0.68     12032
         Car       0.72      0.86      0.78     20474
         Bus       0.67      0.49      0.57      9180
       Train       0.80      0.76      0.78     21810
      Subway       0.88      0.92      0.90     21707

    accuracy                           0.77    143960
   macro avg       0.67      0.68      0.66    143960
weighted avg       0.78      0.77      0.76    143960

tree_model.pred_mean_lightgbm
[[25191   367     0   699   543  1495   357  1188]
 [ 1450 13357     0  9647   132    47   331  1179]
 [    0  1411     0  1363     0     0     0     0]
 [   15     1     0 11939    77     0     0     0]
 [  562   184     0   218 18152  1358     0     0]
 [   21     0     0   614  2968  5090   487     0]
 [  966     0     0  1052  3575     9 15056  1152]
 [    0     0     0     0     0     0  2270 19437]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.89      0.84      0.87     29840
     Walking       0.87      0.51      0.64     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.47      0.99      0.64     12032
         Car       0.71      0.89      0.79     20474
         Bus       0.64      0.55      0.59      9180
       Train       0.81      0.69      0.75     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.75    143960
   macro avg       0.66      0.67      0.64    143960
weighted avg       0.78      0.75      0.74    143960

tree_model.pred_mean_xgb
[[25787   350     0  1064   454   770   428   987]
 [ 1699 13753     0  9122     0    14   319  1236]
 [    0   239     0  2535     0     0     0     0]
 [   72     0     0 11960     0     0     0     0]
 [  547   165     0   715 17670  1377     0     0]
 [   16     0     0   369  3419  4668   708     0]
 [  653    24     0  1038  2318    52 16588  1137]
 [    0     0     0     0     0     0  2272 19435]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.90      0.86      0.88     29840
     Walking       0.95      0.53      0.68     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.45      0.99      0.62     12032
         Car       0.74      0.86      0.80     20474
         Bus       0.68      0.51      0.58      9180
       Train       0.82      0.76      0.79     21810
      Subway       0.85      0.90      0.87     21707

    accuracy                           0.76    143960
   macro avg       0.67      0.68      0.65    143960
weighted avg       0.80      0.76      0.76    143960

test over
training set : Hips ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.03
predict bag
Time elapsed for testing bag: 41.72
predict catboost
Time elapsed for testing CatBoost: 0.35
predict lgb
Time elapsed for testing lgb: 1.35
predict xgb
Time elapsed for testing xgb: 3.0
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hips ; testing set : Hips  testing result
tree_model.pred_mean
[[25549   173     0   108   202    57  3623   128]
 [ 1262 21382     0  2358    25    37   739   340]
 [    0  1759   320   695     0     0     0     0]
 [  359   292     0 11334    47     0     0     0]
 [  706    60     0     0 17919  1789     0     0]
 [   28    44     0    56  3003  5860   189     0]
 [  651     4     0    77  4291    36 15820   931]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.86      0.88     29840
     Walking       0.90      0.82      0.86     26143
         Run       1.00      0.12      0.21      2774
        Bike       0.77      0.94      0.85     12032
         Car       0.70      0.88      0.78     20474
         Bus       0.75      0.64      0.69      9180
       Train       0.50      0.73      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.80      0.68      0.69    143960
weighted avg       0.79      0.76      0.75    143960

tree_model.pred_mean_rf
[[24546   599     0   345   614    24  3473   239]
 [ 1018 16100     0  8195    26    49   497   258]
 [    0  1710     0  1064     0     0     0     0]
 [   74   123     0 11467   368     0     0     0]
 [ 1160    73     0     0 15568  3512    21   140]
 [  338    52     0    58  2903  5743    86     0]
 [  439     5     0    83  2624   953 15874  1832]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.89      0.82      0.86     29840
     Walking       0.86      0.62      0.72     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.54      0.95      0.69     12032
         Car       0.70      0.76      0.73     20474
         Bus       0.56      0.63      0.59      9180
       Train       0.51      0.73      0.60     21810
      Subway       0.81      0.49      0.61     21707

    accuracy                           0.69    143960
   macro avg       0.61      0.62      0.60    143960
weighted avg       0.72      0.69      0.69    143960

tree_model.pred_mean_bag
[[23503   825     0   263  1179   246  3631   193]
 [  590 21033     0  3292   215   486   327   200]
 [    0  2050     0   724     0     0     0     0]
 [   31  1800     0  9633   475    93     0     0]
 [ 1248    74     0    20 15700  3350    82     0]
 [  453    19     0   108  1141  7297   162     0]
 [  727     5     0    74  3327  1076 15654   947]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.89      0.79      0.83     29840
     Walking       0.82      0.80      0.81     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.68      0.80      0.74     12032
         Car       0.71      0.77      0.74     20474
         Bus       0.58      0.79      0.67      9180
       Train       0.51      0.72      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.72    143960
   macro avg       0.63      0.65      0.63    143960
weighted avg       0.74      0.72      0.71    143960

tree_model.pred_mean_catboost
[[24562   120     0  1005   189   134  3727   103]
 [ 1862 21322     0  1325    37    51  1123   423]
 [    0  1831   252   691     0     0     0     0]
 [  300  1020     0 10643    69     0     0     0]
 [  814    39     0     8 17835  1703    75     0]
 [    7    24     0    68  3588  5265   228     0]
 [ 1594    16     0    14  3209    69 14914  1994]
 [    0     0     0     0     0     0  3858 17849]]
              precision    recall  f1-score   support

       Still       0.84      0.82      0.83     29840
     Walking       0.87      0.82      0.84     26143
         Run       1.00      0.09      0.17      2774
        Bike       0.77      0.88      0.83     12032
         Car       0.72      0.87      0.79     20474
         Bus       0.73      0.57      0.64      9180
       Train       0.62      0.68      0.65     21810
      Subway       0.88      0.82      0.85     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.70      0.70    143960
weighted avg       0.79      0.78      0.78    143960

tree_model.pred_mean_lightgbm
[[23793   332     0    80   858   514  3917   346]
 [ 1395 20788     0  2585    18    49   949   359]
 [    0  2132   333   309     0     0     0     0]
 [  421   166     0 11445     0     0     0     0]
 [  277    42     0     0 18950  1205     0     0]
 [    0    41     0    35  2652  5870   582     0]
 [  373     9     0    90  4427   248 15818   845]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.80      0.85     29840
     Walking       0.88      0.80      0.84     26143
         Run       1.00      0.12      0.21      2774
        Bike       0.79      0.95      0.86     12032
         Car       0.70      0.93      0.80     20474
         Bus       0.74      0.64      0.69      9180
       Train       0.49      0.73      0.58     21810
      Subway       0.87      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.68      0.68    143960
weighted avg       0.79      0.75      0.74    143960

tree_model.pred_mean_xgb
[[24739   406     0    94   921    45  3532   103]
 [ 1308 20688     0  2833    16    34   957   307]
 [    0  1529   485   712     0    48     0     0]
 [  415   214     0 11403     0     0     0     0]
 [  387    57     0     0 18450  1580     0     0]
 [   27    45     0    54  3073  5627   354     0]
 [  602     2     0    76  4324    56 15809   941]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.83      0.86     29840
     Walking       0.90      0.79      0.84     26143
         Run       1.00      0.17      0.30      2774
        Bike       0.75      0.95      0.84     12032
         Car       0.69      0.90      0.78     20474
         Bus       0.76      0.61      0.68      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.68      0.69    143960
weighted avg       0.79      0.75      0.75    143960

test over
training set:Bag,the 1th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 176.7
Training bag (tree-based)...
Time elapsed for training bag (tree-based): 137.77
Training CatBoost...
0:	learn: 1.4162273	total: 342ms	remaining: 33.8s
1:	learn: 1.0360351	total: 658ms	remaining: 32.2s
2:	learn: 0.7572254	total: 951ms	remaining: 30.7s
3:	learn: 0.6519387	total: 1.29s	remaining: 31.1s
4:	learn: 0.5983160	total: 1.6s	remaining: 30.4s
5:	learn: 0.5357694	total: 1.93s	remaining: 30.2s
6:	learn: 0.4978337	total: 2.22s	remaining: 29.5s
7:	learn: 0.4406860	total: 2.63s	remaining: 30.3s
8:	learn: 0.4009935	total: 2.9s	remaining: 29.3s
9:	learn: 0.3703927	total: 3.24s	remaining: 29.2s
10:	learn: 0.3409587	total: 3.6s	remaining: 29.1s
11:	learn: 0.3240121	total: 3.88s	remaining: 28.4s
12:	learn: 0.3142213	total: 4.16s	remaining: 27.9s
13:	learn: 0.2947977	total: 4.53s	remaining: 27.8s
14:	learn: 0.2951175	total: 4.8s	remaining: 27.2s
15:	learn: 0.2817027	total: 5.12s	remaining: 26.9s
16:	learn: 0.2727793	total: 5.45s	remaining: 26.6s
17:	learn: 0.2698897	total: 5.72s	remaining: 26s
18:	learn: 0.2589510	total: 6.04s	remaining: 25.7s
19:	learn: 0.2525663	total: 6.34s	remaining: 25.4s
20:	learn: 0.2460372	total: 6.67s	remaining: 25.1s
21:	learn: 0.2312053	total: 7.04s	remaining: 25s
22:	learn: 0.2215562	total: 7.41s	remaining: 24.8s
23:	learn: 0.2175613	total: 7.68s	remaining: 24.3s
24:	learn: 0.2144865	total: 7.97s	remaining: 23.9s
25:	learn: 0.2095706	total: 8.25s	remaining: 23.5s
26:	learn: 0.2028756	total: 8.55s	remaining: 23.1s
27:	learn: 0.1957914	total: 8.93s	remaining: 23s
28:	learn: 0.1921640	total: 9.21s	remaining: 22.6s
29:	learn: 0.1873116	total: 9.54s	remaining: 22.2s
30:	learn: 0.1842759	total: 9.88s	remaining: 22s
31:	learn: 0.1817715	total: 10.2s	remaining: 21.7s
32:	learn: 0.1782511	total: 10.5s	remaining: 21.3s
33:	learn: 0.1897943	total: 10.8s	remaining: 21s
34:	learn: 0.1770032	total: 11.1s	remaining: 20.6s
35:	learn: 0.1725579	total: 11.4s	remaining: 20.3s
36:	learn: 0.1656108	total: 11.8s	remaining: 20s
37:	learn: 0.1603774	total: 12s	remaining: 19.6s
38:	learn: 0.1587461	total: 12.3s	remaining: 19.2s
39:	learn: 0.1560255	total: 12.7s	remaining: 19s
40:	learn: 0.1532978	total: 13.1s	remaining: 18.8s
41:	learn: 0.1521291	total: 13.3s	remaining: 18.4s
42:	learn: 0.1518822	total: 13.7s	remaining: 18.1s
43:	learn: 0.1476334	total: 13.9s	remaining: 17.7s
44:	learn: 0.1436201	total: 14.3s	remaining: 17.5s
45:	learn: 0.1425982	total: 14.6s	remaining: 17.1s
46:	learn: 0.1401848	total: 14.9s	remaining: 16.8s
47:	learn: 0.1396538	total: 15.3s	remaining: 16.5s
48:	learn: 0.1344038	total: 15.6s	remaining: 16.2s
49:	learn: 0.1317412	total: 15.9s	remaining: 15.9s
50:	learn: 0.1283486	total: 16.3s	remaining: 15.6s
51:	learn: 0.1268721	total: 16.6s	remaining: 15.3s
52:	learn: 0.1257114	total: 16.8s	remaining: 14.9s
53:	learn: 0.1231096	total: 17.1s	remaining: 14.6s
54:	learn: 0.1206216	total: 17.5s	remaining: 14.3s
55:	learn: 0.1185742	total: 17.9s	remaining: 14s
56:	learn: 0.1159512	total: 18.2s	remaining: 13.8s
57:	learn: 0.1153450	total: 18.5s	remaining: 13.4s
58:	learn: 0.1136996	total: 18.9s	remaining: 13.1s
59:	learn: 0.1128873	total: 19.2s	remaining: 12.8s
60:	learn: 0.1118967	total: 19.6s	remaining: 12.5s
61:	learn: 0.1100245	total: 19.8s	remaining: 12.2s
62:	learn: 0.1091332	total: 20.1s	remaining: 11.8s
63:	learn: 0.1078425	total: 20.5s	remaining: 11.5s
64:	learn: 0.1079666	total: 20.8s	remaining: 11.2s
65:	learn: 0.1048107	total: 21.1s	remaining: 10.9s
66:	learn: 0.1039297	total: 21.4s	remaining: 10.6s
67:	learn: 0.1017442	total: 21.7s	remaining: 10.2s
68:	learn: 0.1006920	total: 22s	remaining: 9.9s
69:	learn: 0.1000757	total: 22.3s	remaining: 9.56s
70:	learn: 0.0992763	total: 22.6s	remaining: 9.23s
71:	learn: 0.0982572	total: 22.9s	remaining: 8.9s
72:	learn: 0.0976202	total: 23.2s	remaining: 8.57s
73:	learn: 0.0968212	total: 23.5s	remaining: 8.24s
74:	learn: 0.0953082	total: 23.8s	remaining: 7.94s
75:	learn: 0.0948139	total: 24.1s	remaining: 7.61s
76:	learn: 0.0940926	total: 24.4s	remaining: 7.29s
77:	learn: 0.0926946	total: 24.8s	remaining: 6.98s
78:	learn: 0.0922043	total: 25.1s	remaining: 6.66s
79:	learn: 0.0917796	total: 25.3s	remaining: 6.33s
80:	learn: 0.0912225	total: 25.6s	remaining: 6.01s
81:	learn: 0.0905101	total: 25.9s	remaining: 5.68s
82:	learn: 0.0889859	total: 26.2s	remaining: 5.37s
83:	learn: 0.0881718	total: 26.5s	remaining: 5.05s
84:	learn: 0.0875806	total: 26.9s	remaining: 4.74s
85:	learn: 0.0868684	total: 27.2s	remaining: 4.42s
86:	learn: 0.0858498	total: 27.6s	remaining: 4.12s
87:	learn: 0.0846205	total: 27.8s	remaining: 3.8s
88:	learn: 0.0841122	total: 28.1s	remaining: 3.48s
89:	learn: 0.0831257	total: 28.5s	remaining: 3.16s
90:	learn: 0.0819558	total: 28.8s	remaining: 2.85s
91:	learn: 0.0811050	total: 29.2s	remaining: 2.54s
92:	learn: 0.0808002	total: 29.4s	remaining: 2.22s
93:	learn: 0.0804365	total: 29.7s	remaining: 1.9s
94:	learn: 0.0799741	total: 30s	remaining: 1.58s
95:	learn: 0.0783957	total: 30.3s	remaining: 1.26s
96:	learn: 0.0772972	total: 30.7s	remaining: 949ms
97:	learn: 0.0765440	total: 30.9s	remaining: 632ms
98:	learn: 0.0759958	total: 31.2s	remaining: 315ms
99:	learn: 0.0752966	total: 31.5s	remaining: 0us
Time elapsed for training CatBoost: 32.64
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.480104 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47640
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.080702
[LightGBM] [Info] Start training from score -2.076921
[LightGBM] [Info] Start training from score -3.143981
[LightGBM] [Info] Start training from score -2.122938
[LightGBM] [Info] Start training from score -1.822696
[LightGBM] [Info] Start training from score -1.936734
[LightGBM] [Info] Start training from score -1.834537
[LightGBM] [Info] Start training from score -2.107013
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.46107
[2]	valid_0's multi_logloss: 1.17375
[3]	valid_0's multi_logloss: 0.974554
[4]	valid_0's multi_logloss: 0.820858
[5]	valid_0's multi_logloss: 0.698814
[6]	valid_0's multi_logloss: 0.600026
[7]	valid_0's multi_logloss: 0.520164
[8]	valid_0's multi_logloss: 0.453503
[9]	valid_0's multi_logloss: 0.397852
[10]	valid_0's multi_logloss: 0.35058
[11]	valid_0's multi_logloss: 0.310913
[12]	valid_0's multi_logloss: 0.276535
[13]	valid_0's multi_logloss: 0.246703
[14]	valid_0's multi_logloss: 0.221332
[15]	valid_0's multi_logloss: 0.199214
[16]	valid_0's multi_logloss: 0.180059
[17]	valid_0's multi_logloss: 0.163014
[18]	valid_0's multi_logloss: 0.148761
[19]	valid_0's multi_logloss: 0.136026
[20]	valid_0's multi_logloss: 0.124719
[21]	valid_0's multi_logloss: 0.11464
[22]	valid_0's multi_logloss: 0.106047
[23]	valid_0's multi_logloss: 0.0985864
[24]	valid_0's multi_logloss: 0.0919656
[25]	valid_0's multi_logloss: 0.08579
[26]	valid_0's multi_logloss: 0.0798103
[27]	valid_0's multi_logloss: 0.0752976
[28]	valid_0's multi_logloss: 0.0709992
[29]	valid_0's multi_logloss: 0.0673014
[30]	valid_0's multi_logloss: 0.0639638
[31]	valid_0's multi_logloss: 0.0608312
[32]	valid_0's multi_logloss: 0.0579756
[33]	valid_0's multi_logloss: 0.05531
[34]	valid_0's multi_logloss: 0.0522713
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[35]	valid_0's multi_logloss: 0.0499984
[36]	valid_0's multi_logloss: 0.0472359
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[37]	valid_0's multi_logloss: 0.0453652
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0431506
[39]	valid_0's multi_logloss: 0.0414005
[40]	valid_0's multi_logloss: 0.0396219
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0378422
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0364514
[43]	valid_0's multi_logloss: 0.0350013
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[44]	valid_0's multi_logloss: 0.0335716
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0322566
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0310427
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0301666
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0291357
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0279983
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0269253
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0261737
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0252798
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0244633
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0236231
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0227918
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0219735
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0212586
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0205271
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0198894
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[60]	valid_0's multi_logloss: 0.0194056
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0188123
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0183016
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0178292
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0173241
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0168509
[66]	valid_0's multi_logloss: 0.0164833
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0160335
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0156958
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0153539
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0149611
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0146057
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0142156
[73]	valid_0's multi_logloss: 0.0138674
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0135364
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0132009
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[76]	valid_0's multi_logloss: 0.0128242
[77]	valid_0's multi_logloss: 0.0125392
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0122883
[79]	valid_0's multi_logloss: 0.0119288
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0116468
[81]	valid_0's multi_logloss: 0.0113838
[82]	valid_0's multi_logloss: 0.0111138
[83]	valid_0's multi_logloss: 0.0108298
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0106166
[85]	valid_0's multi_logloss: 0.0103224
[86]	valid_0's multi_logloss: 0.0101029
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.0098844
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.00968569
[89]	valid_0's multi_logloss: 0.00952336
[90]	valid_0's multi_logloss: 0.00932201
[91]	valid_0's multi_logloss: 0.00911827
[92]	valid_0's multi_logloss: 0.00891554
[93]	valid_0's multi_logloss: 0.00872966
[94]	valid_0's multi_logloss: 0.00855318
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.00836636
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.00823856
[97]	valid_0's multi_logloss: 0.00808061
[98]	valid_0's multi_logloss: 0.00792143
[99]	valid_0's multi_logloss: 0.0077802
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[100]	valid_0's multi_logloss: 0.00763103
Time elapsed for training LightGBM: 88.36
Training XGBoost...
Time elapsed for training XGBoost: 362.23
begin testing
training set : Bag ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.18
predict bag
Time elapsed for testing bag: 43.67
predict catboost
Time elapsed for testing CatBoost: 0.38
predict lgb
Time elapsed for testing lgb: 1.34
predict xgb
Time elapsed for testing xgb: 2.67
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Bag ; testing set : Torso  testing result
tree_model.pred_mean
[[22973   916     0    15   169  2354  3060   353]
 [  400 24775     4   294     0   323   245   102]
 [    0  1886   888     0     0     0     0     0]
 [  203  4224     0  4696  2439   265   205     0]
 [  315   234     0     0 11990  5782  2153     0]
 [   90    41     0     0     0  8616   433     0]
 [ 2140   138     0     9   750  2423 16231   119]
 [    0     3     0     0     0     0 11099 10605]]
              precision    recall  f1-score   support

       Still       0.88      0.77      0.82     29840
     Walking       0.77      0.95      0.85     26143
         Run       1.00      0.32      0.48      2774
        Bike       0.94      0.39      0.55     12032
         Car       0.78      0.59      0.67     20474
         Bus       0.44      0.94      0.60      9180
       Train       0.49      0.74      0.59     21810
      Subway       0.95      0.49      0.64     21707

    accuracy                           0.70    143960
   macro avg       0.78      0.65      0.65    143960
weighted avg       0.77      0.70      0.70    143960

tree_model.pred_mean_rf
[[14610   559     0   134   786  5245  7083  1423]
 [  299 24106     9   525   349   487   246   122]
 [    0  1795   902    77     0     0     0     0]
 [    0   959     0  7718  3168   187     0     0]
 [   27   149     0     0 10603  5213  4307   175]
 [  402    71     0     5    19  8412   271     0]
 [ 1235    42     0    42   430  3308 15617  1136]
 [    0     7     0     0     0     0 11099 10601]]
              precision    recall  f1-score   support

       Still       0.88      0.49      0.63     29840
     Walking       0.87      0.92      0.90     26143
         Run       0.99      0.33      0.49      2774
        Bike       0.91      0.64      0.75     12032
         Car       0.69      0.52      0.59     20474
         Bus       0.37      0.92      0.53      9180
       Train       0.40      0.72      0.52     21810
      Subway       0.79      0.49      0.60     21707

    accuracy                           0.64    143960
   macro avg       0.74      0.63      0.63    143960
weighted avg       0.74      0.64      0.65    143960

tree_model.pred_mean_bag
[[17398   845     0   127    50  8038  2346  1036]
 [  342 24026     0   918    33    77   558   189]
 [    0  1936   838     0     0     0     0     0]
 [    0  4265     0  6081  1117   569     0     0]
 [   82   167     0    50 13897  6225    53     0]
 [  576    54     0   101    85  8364     0     0]
 [ 2154   115     0    84   405  3368 15253   431]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.58      0.69     29840
     Walking       0.76      0.92      0.83     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.83      0.51      0.63     12032
         Car       0.89      0.68      0.77     20474
         Bus       0.31      0.91      0.47      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.67    143960
   macro avg       0.75      0.64      0.63    143960
weighted avg       0.76      0.67      0.68    143960

tree_model.pred_mean_catboost
[[19785  2072     0   153    75  3947  3294   514]
 [  519 24277     8   212     0   418   679    30]
 [    0  1877   897     0     0     0     0     0]
 [  737  4472     0  4334  1861   291   337     0]
 [  314   188     0     0  8970  8627  2375     0]
 [    0    25     0     0     0  8383   772     0]
 [ 2344   255     0     0   704  2047 16316   144]
 [    0   172     0     0     0     0 11099 10436]]
              precision    recall  f1-score   support

       Still       0.83      0.66      0.74     29840
     Walking       0.73      0.93      0.82     26143
         Run       0.99      0.32      0.49      2774
        Bike       0.92      0.36      0.52     12032
         Car       0.77      0.44      0.56     20474
         Bus       0.35      0.91      0.51      9180
       Train       0.47      0.75      0.58     21810
      Subway       0.94      0.48      0.64     21707

    accuracy                           0.65    143960
   macro avg       0.75      0.61      0.61    143960
weighted avg       0.75      0.65      0.65    143960

tree_model.pred_mean_lightgbm
[[21108  1501     0     0   241  1667  4984   339]
 [  559 24806     6    54    50   275   267   126]
 [    0  1886   888     0     0     0     0     0]
 [  168  5367     0  3688  2396   265   148     0]
 [  199   197     0     0  6932  5355  7791     0]
 [   37    27     0     0     0  8667   449     0]
 [ 1563   145     0     0  1279  2469 16326    28]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.71      0.79     29840
     Walking       0.73      0.95      0.83     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.99      0.31      0.47     12032
         Car       0.64      0.34      0.44     20474
         Bus       0.46      0.94      0.62      9180
       Train       0.40      0.75      0.52     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.65    143960
   macro avg       0.76      0.60      0.60    143960
weighted avg       0.74      0.65      0.64    143960

tree_model.pred_mean_xgb
[[24588   893     0    38    70  1719  2403   129]
 [ 1177 24121     7   134    26   360   220    98]
 [    0  1886   888     0     0     0     0     0]
 [  570  3625     0  5504  1990   270    73     0]
 [  571   283     0     0 11681  6696  1243     0]
 [  253    41     0     0     0  8438   448     0]
 [ 2684   120     0     1   621  2035 15550   799]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.82      0.82      0.82     29840
     Walking       0.78      0.92      0.84     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.97      0.46      0.62     12032
         Car       0.81      0.57      0.67     20474
         Bus       0.43      0.92      0.59      9180
       Train       0.50      0.71      0.59     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.70    143960
   macro avg       0.78      0.65      0.66    143960
weighted avg       0.77      0.70      0.70    143960

test over
training set : Bag ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.04
predict bag
Time elapsed for testing bag: 42.05
predict catboost
Time elapsed for testing CatBoost: 0.37
predict lgb
Time elapsed for testing lgb: 1.38
predict xgb
Time elapsed for testing xgb: 2.81
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Bag ; testing set : Bag  testing result
tree_model.pred_mean
[[26050   754     0    59   473   112  1795   597]
 [  654 24361     2   748    74    40   145   119]
 [    0  1160  1614     0     0     0     0     0]
 [   78  2508     0  8868   443   135     0     0]
 [  354    88     0     0 17733  2103   196     0]
 [    0    66     0    18  2062  6512   522     0]
 [  709    77     0    68  2492   755 17516   193]
 [    0     4     0     0     0     0  2289 19414]]
              precision    recall  f1-score   support

       Still       0.94      0.87      0.90     29840
     Walking       0.84      0.93      0.88     26143
         Run       1.00      0.58      0.74      2774
        Bike       0.91      0.74      0.81     12032
         Car       0.76      0.87      0.81     20474
         Bus       0.67      0.71      0.69      9180
       Train       0.78      0.80      0.79     21810
      Subway       0.96      0.89      0.92     21707

    accuracy                           0.85    143960
   macro avg       0.86      0.80      0.82    143960
weighted avg       0.86      0.85      0.85    143960

tree_model.pred_mean_rf
[[23705   598     0   101   778   746  2561  1351]
 [  175 23753     5  1212   532   292    29   145]
 [    0  1517  1257     0     0     0     0     0]
 [   29   699     0  8662  2369   273     0     0]
 [  159    71     0     0 16990  2968   229    57]
 [    0    48     0    79  1770  6811   472     0]
 [  219    56     0    89  2126   807 17409  1104]
 [    0     6     0     0     0     0  2308 19393]]
              precision    recall  f1-score   support

       Still       0.98      0.79      0.88     29840
     Walking       0.89      0.91      0.90     26143
         Run       1.00      0.45      0.62      2774
        Bike       0.85      0.72      0.78     12032
         Car       0.69      0.83      0.75     20474
         Bus       0.57      0.74      0.65      9180
       Train       0.76      0.80      0.78     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.82    143960
   macro avg       0.83      0.77      0.78    143960
weighted avg       0.84      0.82      0.82    143960

tree_model.pred_mean_bag
[[24810   891     0   134    32   949  2206   818]
 [  242 23565     0  1492    29    76   524   215]
 [    0  1607  1167     0     0     0     0     0]
 [   47  2965     0  5990  2779   251     0     0]
 [  564   109     0    26 17869  1906     0     0]
 [   60    40     0   187   361  8410   122     0]
 [ 1382    31     0   101  3051  2274 14734   237]
 [    3     0     0     0     0     0  2295 19409]]
              precision    recall  f1-score   support

       Still       0.92      0.83      0.87     29840
     Walking       0.81      0.90      0.85     26143
         Run       1.00      0.42      0.59      2774
        Bike       0.76      0.50      0.60     12032
         Car       0.74      0.87      0.80     20474
         Bus       0.61      0.92      0.73      9180
       Train       0.74      0.68      0.71     21810
      Subway       0.94      0.89      0.92     21707

    accuracy                           0.81    143960
   macro avg       0.81      0.75      0.76    143960
weighted avg       0.82      0.81      0.80    143960

tree_model.pred_mean_catboost
[[24485   705     0   235  1308   892  2095   120]
 [  757 23714     9   921    75    18   587    62]
 [    0   862  1912     0     0     0     0     0]
 [ 1171  2043     0  7733   873   212     0     0]
 [  275    69     0     0 16441  3173   516     0]
 [    8    71     0    18  3052  5653   378     0]
 [  756   289     0    63  3417   671 16560    54]
 [    0  3216     0     0    21     0  2508 15962]]
              precision    recall  f1-score   support

       Still       0.89      0.82      0.85     29840
     Walking       0.77      0.91      0.83     26143
         Run       1.00      0.69      0.81      2774
        Bike       0.86      0.64      0.74     12032
         Car       0.65      0.80      0.72     20474
         Bus       0.53      0.62      0.57      9180
       Train       0.73      0.76      0.75     21810
      Subway       0.99      0.74      0.84     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.75      0.76    143960
weighted avg       0.80      0.78      0.78    143960

tree_model.pred_mean_lightgbm
[[25081  1084     0    28   849   272  2336   190]
 [  562 24571     8   544    78    51   225   104]
 [    0  1099  1675     0     0     0     0     0]
 [   41  3044     0  8748   185    14     0     0]
 [  159    67     0     0 18614  1319   315     0]
 [    0    67     0     0  2356  6191   566     0]
 [  723   108     0    58  2755   733 17261   172]
 [    0     0     0     0     0     0  2282 19425]]
              precision    recall  f1-score   support

       Still       0.94      0.84      0.89     29840
     Walking       0.82      0.94      0.87     26143
         Run       1.00      0.60      0.75      2774
        Bike       0.93      0.73      0.82     12032
         Car       0.75      0.91      0.82     20474
         Bus       0.72      0.67      0.70      9180
       Train       0.75      0.79      0.77     21810
      Subway       0.98      0.89      0.93     21707

    accuracy                           0.84    143960
   macro avg       0.86      0.80      0.82    143960
weighted avg       0.85      0.84      0.84    143960

tree_model.pred_mean_xgb
[[27556   619     0    35     9    90   910   621]
 [ 1007 24167     8   535    79    52   205    90]
 [    0   996  1778     0     0     0     0     0]
 [  158  2928     0  8670   171   105     0     0]
 [  548    75     0     0 17936  1787   128     0]
 [   13    78     0    10  2154  6378   547     0]
 [  725    65     0    66  2138   729 17214   873]
 [    0     5     0     0     0     0  2284 19418]]
              precision    recall  f1-score   support

       Still       0.92      0.92      0.92     29840
     Walking       0.84      0.92      0.88     26143
         Run       1.00      0.64      0.78      2774
        Bike       0.93      0.72      0.81     12032
         Car       0.80      0.88      0.83     20474
         Bus       0.70      0.69      0.70      9180
       Train       0.81      0.79      0.80     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.86    143960
   macro avg       0.86      0.81      0.83    143960
weighted avg       0.86      0.86      0.85    143960

test over
training set : Bag ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.12
predict bag
Time elapsed for testing bag: 41.92
predict catboost
Time elapsed for testing CatBoost: 0.27
predict lgb
Time elapsed for testing lgb: 1.32
predict xgb
Time elapsed for testing xgb: 2.68
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Bag ; testing set : Hand  testing result
tree_model.pred_mean
[[24321  2022     0   395     0  1126  1030   946]
 [  337 24227     5  1029     0    44   169   332]
 [    0  1121  1560    93     0     0     0     0]
 [    6  1824     0 10149    51     2     0     0]
 [  427   729     0  1487 15222  2215   394     0]
 [    0     0     0   222  2952  5898   108     0]
 [  901   174     0   295  2744   169 17375   152]
 [    0     3     0     0     0     0  2270 19434]]
              precision    recall  f1-score   support

       Still       0.94      0.82      0.87     29840
     Walking       0.80      0.93      0.86     26143
         Run       1.00      0.56      0.72      2774
        Bike       0.74      0.84      0.79     12032
         Car       0.73      0.74      0.73     20474
         Bus       0.62      0.64      0.63      9180
       Train       0.81      0.80      0.81     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.82    143960
   macro avg       0.82      0.78      0.79    143960
weighted avg       0.83      0.82      0.82    143960

tree_model.pred_mean_rf
[[17038  1526     0   996  2474  5148  1626  1032]
 [  152 23514    16  2041    27   171    35   187]
 [    0   653  2121     0     0     0     0     0]
 [    0   130     0 11884    18     0     0     0]
 [  262   267     0  5187  8532  4000  2226     0]
 [    0    11     0   684  1277  7208     0     0]
 [  388   118     0   598  2299   479 16722  1206]
 [    0    11     0     0     0     0   120 21576]]
              precision    recall  f1-score   support

       Still       0.96      0.57      0.71     29840
     Walking       0.90      0.90      0.90     26143
         Run       0.99      0.76      0.86      2774
        Bike       0.56      0.99      0.71     12032
         Car       0.58      0.42      0.49     20474
         Bus       0.42      0.79      0.55      9180
       Train       0.81      0.77      0.79     21810
      Subway       0.90      0.99      0.94     21707

    accuracy                           0.75    143960
   macro avg       0.76      0.77      0.74    143960
weighted avg       0.79      0.75      0.75    143960

tree_model.pred_mean_bag
[[18209  5287     0   127    22  3538  2350   307]
 [   21 23972     0  1526     0     9   502   113]
 [    0  1309   874   591     0     0     0     0]
 [    0  6209     0  5823     0     0     0     0]
 [  306   778     0  6520 10650  2220     0     0]
 [  141    52     0   793   326  7868     0     0]
 [ 1040   322     0  1006  3462  1104 14623   253]
 [    0     0     0    71     0     0  1899 19737]]
              precision    recall  f1-score   support

       Still       0.92      0.61      0.73     29840
     Walking       0.63      0.92      0.75     26143
         Run       1.00      0.32      0.48      2774
        Bike       0.35      0.48      0.41     12032
         Car       0.74      0.52      0.61     20474
         Bus       0.53      0.86      0.66      9180
       Train       0.75      0.67      0.71     21810
      Subway       0.97      0.91      0.94     21707

    accuracy                           0.71    143960
   macro avg       0.74      0.66      0.66    143960
weighted avg       0.75      0.71      0.71    143960

tree_model.pred_mean_catboost
[[19378  1435     0  1820   129  4841  2146    91]
 [  856 22944    28  1615     0    84   276   340]
 [    0  1029  1443   302     0     0     0     0]
 [   49  1442     0 10367   174     0     0     0]
 [  335   389     0  1755  7188  3533  7274     0]
 [  210     0     0   338  2515  5771   346     0]
 [ 1092   492     0   339  3441   120 16326     0]
 [    0  1643     0     0     0     0  2288 17776]]
              precision    recall  f1-score   support

       Still       0.88      0.65      0.75     29840
     Walking       0.78      0.88      0.83     26143
         Run       0.98      0.52      0.68      2774
        Bike       0.63      0.86      0.73     12032
         Car       0.53      0.35      0.42     20474
         Bus       0.40      0.63      0.49      9180
       Train       0.57      0.75      0.65     21810
      Subway       0.98      0.82      0.89     21707

    accuracy                           0.70    143960
   macro avg       0.72      0.68      0.68    143960
weighted avg       0.73      0.70      0.70    143960

tree_model.pred_mean_lightgbm
[[24300  2094     0   804    38   771   840   993]
 [  817 23778     4   697    14    98   321   414]
 [    0  1530  1244     0     0     0     0     0]
 [  131  3044     0  8252   176   236   193     0]
 [  397   930     0   370 16665  2076    36     0]
 [    8     2     0   125  2860  5890   295     0]
 [  780   208     0   199  3358   208 17001    56]
 [    0     0     0     0     0     0  2274 19433]]
              precision    recall  f1-score   support

       Still       0.92      0.81      0.86     29840
     Walking       0.75      0.91      0.82     26143
         Run       1.00      0.45      0.62      2774
        Bike       0.79      0.69      0.73     12032
         Car       0.72      0.81      0.76     20474
         Bus       0.63      0.64      0.64      9180
       Train       0.81      0.78      0.79     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.81    143960
   macro avg       0.82      0.75      0.77    143960
weighted avg       0.82      0.81      0.81    143960

tree_model.pred_mean_xgb
[[25468  1240     0   609   121   809   664   929]
 [  989 23499     4  1089     0    66   357   139]
 [    0  1124  1650     0     0     0     0     0]
 [   69   482     0 11372   109     0     0     0]
 [  578   720     0  1202 15552  2215   207     0]
 [    5     0     0   206  3300  5489   180     0]
 [  877   113     0   602  2110   127 16937  1044]
 [    0    20     0     0     0     0  2265 19422]]
              precision    recall  f1-score   support

       Still       0.91      0.85      0.88     29840
     Walking       0.86      0.90      0.88     26143
         Run       1.00      0.59      0.75      2774
        Bike       0.75      0.95      0.84     12032
         Car       0.73      0.76      0.75     20474
         Bus       0.63      0.60      0.61      9180
       Train       0.82      0.78      0.80     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.83    143960
   macro avg       0.83      0.79      0.80    143960
weighted avg       0.83      0.83      0.83    143960

test over
training set : Bag ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.34
predict bag
Time elapsed for testing bag: 59.71
predict catboost
Time elapsed for testing CatBoost: 0.35
predict lgb
Time elapsed for testing lgb: 1.34
predict xgb
Time elapsed for testing xgb: 3.48
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Bag ; testing set : Hips  testing result
tree_model.pred_mean
[[22592  2263     0    45   595   628  3603   114]
 [  382 24480     0   276     0    79   590   336]
 [    0   932  1842     0     0     0     0     0]
 [   54  6648     0  5316     0     0    14     0]
 [  700   149     0     0 11437  4141  3996    51]
 [   19    15     0    28  1249  7311   558     0]
 [  718    95     0     0  1822  1106 17837   232]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.92      0.76      0.83     29840
     Walking       0.71      0.94      0.81     26143
         Run       1.00      0.66      0.80      2774
        Bike       0.94      0.44      0.60     12032
         Car       0.76      0.56      0.64     20474
         Bus       0.55      0.80      0.65      9180
       Train       0.47      0.82      0.60     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.70    143960
   macro avg       0.79      0.68      0.70    143960
weighted avg       0.77      0.70      0.71    143960

tree_model.pred_mean_rf
[[22553  1607     0   646   429   549  3649   407]
 [  265 24267     0   651     0   315   425   220]
 [    0   503  1845   426     0     0     0     0]
 [   24  3254     0  8754     0     0     0     0]
 [  564   117     0     0  5993  4757  8879   164]
 [   74    40     0    43   442  8065   516     0]
 [  176    62     0    67   625  1621 18117  1142]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.95      0.76      0.84     29840
     Walking       0.81      0.93      0.87     26143
         Run       1.00      0.67      0.80      2774
        Bike       0.83      0.73      0.77     12032
         Car       0.80      0.29      0.43     20474
         Bus       0.53      0.88      0.66      9180
       Train       0.42      0.83      0.56     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.70    143960
   macro avg       0.77      0.70      0.69    143960
weighted avg       0.77      0.70      0.69    143960

tree_model.pred_mean_bag
[[22499  2230     0   112    10   670  3989   330]
 [  293 22125    60  1866     0   119  1454   226]
 [    0   436  2172   166     0     0     0     0]
 [   18  3672     0  8206    53    83     0     0]
 [ 1317   142     0    43 14488  4484     0     0]
 [  387    26     0   190   378  8199     0     0]
 [  526    51     0    62  1320  3407 15815   629]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.75      0.82     29840
     Walking       0.77      0.85      0.81     26143
         Run       0.97      0.78      0.87      2774
        Bike       0.77      0.68      0.72     12032
         Car       0.89      0.71      0.79     20474
         Bus       0.48      0.89      0.63      9180
       Train       0.49      0.73      0.58     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.72    143960
   macro avg       0.77      0.73      0.73    143960
weighted avg       0.78      0.72      0.73    143960

tree_model.pred_mean_catboost
[[13335  3543     0   922  1575  6081  4126   258]
 [  701 23661   312    84     0   110   892   383]
 [    0   477  2087   210     0     0     0     0]
 [   66  9339     0  2452    63     0   112     0]
 [  167    90     0    70  4359  6600  9067   121]
 [    2     4     0     0  2467  5943   764     0]
 [  649    76     0     0  2521   858 17246   460]
 [    0     7     0     0     0     0 11099 10601]]
              precision    recall  f1-score   support

       Still       0.89      0.45      0.60     29840
     Walking       0.64      0.91      0.75     26143
         Run       0.87      0.75      0.81      2774
        Bike       0.66      0.20      0.31     12032
         Car       0.40      0.21      0.28     20474
         Bus       0.30      0.65      0.41      9180
       Train       0.40      0.79      0.53     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.55    143960
   macro avg       0.63      0.56      0.54    143960
weighted avg       0.64      0.55      0.54    143960

tree_model.pred_mean_lightgbm
[[21349  2463     0    22   333  1276  4283   114]
 [  350 24558     0     0     0    64   786   385]
 [    0   937  1837     0     0     0     0     0]
 [   67  8318     0  3487     0     0   160     0]
 [  483   153     0     0 14223  3124  2491     0]
 [    6    20     0     0  1387  6996   771     0]
 [  631    85     0     0  1756  1139 18199     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.93      0.72      0.81     29840
     Walking       0.67      0.94      0.78     26143
         Run       1.00      0.66      0.80      2774
        Bike       0.99      0.29      0.45     12032
         Car       0.80      0.69      0.75     20474
         Bus       0.56      0.76      0.64      9180
       Train       0.48      0.83      0.61     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.70    143960
   macro avg       0.80      0.67      0.69    143960
weighted avg       0.78      0.70      0.70    143960

tree_model.pred_mean_xgb
[[23326  2061     0    59   182   540  3568   104]
 [  829 23570   214   558     0   114   694   164]
 [    0   926  1848     0     0     0     0     0]
 [  129  6773     0  5130     0     0     0     0]
 [ 1413   113     0     0 12707  4303  1938     0]
 [   53    15     0    36   812  7605   659     0]
 [ 1037    68     0     0  1472   918 17477   838]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.78      0.82     29840
     Walking       0.70      0.90      0.79     26143
         Run       0.90      0.67      0.76      2774
        Bike       0.89      0.43      0.58     12032
         Car       0.84      0.62      0.71     20474
         Bus       0.56      0.83      0.67      9180
       Train       0.49      0.80      0.61     21810
      Subway       0.91      0.49      0.63     21707

    accuracy                           0.71    143960
   macro avg       0.77      0.69      0.70    143960
weighted avg       0.77      0.71      0.71    143960

test over
training set:Hand,the 2th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 187.21
Training bag (tree-based)...
Time elapsed for training bag (tree-based): 137.74
Training CatBoost...
0:	learn: 1.5247624	total: 377ms	remaining: 37.3s
1:	learn: 1.1541942	total: 690ms	remaining: 33.8s
2:	learn: 0.8406583	total: 962ms	remaining: 31.1s
3:	learn: 0.7161614	total: 1.23s	remaining: 29.6s
4:	learn: 0.6361138	total: 1.5s	remaining: 28.4s
5:	learn: 0.5597140	total: 1.85s	remaining: 29s
6:	learn: 0.5780493	total: 2.18s	remaining: 29s
7:	learn: 0.5501705	total: 2.48s	remaining: 28.5s
8:	learn: 0.4946296	total: 2.86s	remaining: 28.9s
9:	learn: 0.4506302	total: 3.21s	remaining: 28.9s
10:	learn: 0.4377610	total: 3.52s	remaining: 28.5s
11:	learn: 0.4206789	total: 3.81s	remaining: 28s
12:	learn: 0.3962986	total: 4.1s	remaining: 27.5s
13:	learn: 0.3840129	total: 4.41s	remaining: 27.1s
14:	learn: 0.3761831	total: 4.67s	remaining: 26.5s
15:	learn: 0.3683160	total: 4.92s	remaining: 25.8s
16:	learn: 0.3510512	total: 5.24s	remaining: 25.6s
17:	learn: 0.3474524	total: 5.49s	remaining: 25s
18:	learn: 0.3379833	total: 5.77s	remaining: 24.6s
19:	learn: 0.3488948	total: 6.05s	remaining: 24.2s
20:	learn: 0.3755690	total: 6.35s	remaining: 23.9s
21:	learn: 0.6537403	total: 6.69s	remaining: 23.7s
22:	learn: 4.0181842	total: 7.01s	remaining: 23.5s
23:	learn: 133.5387037	total: 7.33s	remaining: 23.2s
24:	learn: 96.8805261	total: 7.65s	remaining: 23s
25:	learn: 65.4970864	total: 7.97s	remaining: 22.7s
26:	learn: 44.0422849	total: 8.29s	remaining: 22.4s
27:	learn: 305.3901076	total: 8.61s	remaining: 22.1s
28:	learn: 134.9830609	total: 8.93s	remaining: 21.9s
29:	learn: 182.9240429	total: 9.26s	remaining: 21.6s
30:	learn: 407.7495202	total: 9.59s	remaining: 21.3s
31:	learn: 124.2240287	total: 9.91s	remaining: 21.1s
32:	learn: 405.7782805	total: 10.2s	remaining: 20.8s
33:	learn: 83.9826170	total: 10.5s	remaining: 20.5s
34:	learn: 312.8936872	total: 10.9s	remaining: 20.2s
35:	learn: 98.0490152	total: 11.2s	remaining: 19.9s
36:	learn: 154.2234947	total: 11.5s	remaining: 19.6s
37:	learn: 335.0038557	total: 11.8s	remaining: 19.3s
38:	learn: 103.3936987	total: 12.1s	remaining: 19s
39:	learn: 348.9729433	total: 12.4s	remaining: 18.7s
40:	learn: 65.8056991	total: 12.8s	remaining: 18.4s
41:	learn: 55.5915018	total: 13.1s	remaining: 18.1s
42:	learn: 293.6673716	total: 13.4s	remaining: 17.8s
43:	learn: 130.3986504	total: 13.7s	remaining: 17.5s
44:	learn: 112.6294083	total: 14s	remaining: 17.1s
45:	learn: 316.3226902	total: 14.3s	remaining: 16.8s
46:	learn: 134.1126867	total: 14.7s	remaining: 16.5s
47:	learn: 274.3673437	total: 15s	remaining: 16.2s
48:	learn: 71.1909301	total: 15.3s	remaining: 15.9s
49:	learn: 217.7839713	total: 15.7s	remaining: 15.7s
50:	learn: 192.4460048	total: 16s	remaining: 15.4s
51:	learn: 196.8521189	total: 16.3s	remaining: 15s
52:	learn: 273.4096891	total: 16.6s	remaining: 14.7s
53:	learn: 145.0691017	total: 16.9s	remaining: 14.4s
54:	learn: 212.5501596	total: 17.2s	remaining: 14.1s
55:	learn: 124.6125530	total: 17.6s	remaining: 13.8s
56:	learn: 154.9234259	total: 17.9s	remaining: 13.5s
57:	learn: 205.1880177	total: 18.2s	remaining: 13.2s
58:	learn: 209.4517714	total: 18.5s	remaining: 12.9s
59:	learn: 180.5628236	total: 18.8s	remaining: 12.5s
60:	learn: 193.9997774	total: 19.1s	remaining: 12.2s
61:	learn: 164.0209499	total: 19.4s	remaining: 11.9s
62:	learn: 182.4286801	total: 19.8s	remaining: 11.6s
63:	learn: 167.7340344	total: 20.1s	remaining: 11.3s
64:	learn: 184.2149469	total: 20.4s	remaining: 11s
65:	learn: 264.2036130	total: 20.7s	remaining: 10.7s
66:	learn: 165.7798289	total: 21s	remaining: 10.4s
67:	learn: 238.9306304	total: 21.3s	remaining: 10s
68:	learn: 120.1635296	total: 21.7s	remaining: 9.73s
69:	learn: 212.5411751	total: 22s	remaining: 9.41s
70:	learn: 167.0516130	total: 22.3s	remaining: 9.1s
71:	learn: 157.1347206	total: 22.6s	remaining: 8.79s
72:	learn: 300.6112908	total: 22.9s	remaining: 8.48s
73:	learn: 91.7390790	total: 23.3s	remaining: 8.17s
74:	learn: 279.5827409	total: 23.6s	remaining: 7.85s
75:	learn: 44.6430957	total: 23.9s	remaining: 7.54s
76:	learn: 252.9798531	total: 24.2s	remaining: 7.23s
77:	learn: 189.4764226	total: 24.5s	remaining: 6.92s
78:	learn: 134.1064402	total: 24.8s	remaining: 6.6s
79:	learn: 310.9533294	total: 25.2s	remaining: 6.29s
80:	learn: 124.2608451	total: 25.5s	remaining: 5.97s
81:	learn: 247.8269758	total: 25.8s	remaining: 5.66s
82:	learn: 106.2422644	total: 26.1s	remaining: 5.34s
83:	learn: 190.3051532	total: 26.4s	remaining: 5.03s
84:	learn: 225.4980400	total: 26.7s	remaining: 4.72s
85:	learn: 193.3536296	total: 27.1s	remaining: 4.4s
86:	learn: 256.3385218	total: 27.4s	remaining: 4.09s
87:	learn: 168.1090263	total: 27.7s	remaining: 3.77s
88:	learn: 211.0811826	total: 28s	remaining: 3.46s
89:	learn: 141.6252015	total: 28.3s	remaining: 3.14s
90:	learn: 168.0723933	total: 28.6s	remaining: 2.83s
91:	learn: 231.4455460	total: 28.9s	remaining: 2.52s
92:	learn: 225.4861437	total: 29.3s	remaining: 2.2s
93:	learn: 220.5648605	total: 29.6s	remaining: 1.89s
94:	learn: 198.4433918	total: 29.9s	remaining: 1.57s
95:	learn: 177.8421625	total: 30.2s	remaining: 1.26s
96:	learn: 171.7662831	total: 30.5s	remaining: 944ms
97:	learn: 154.5607472	total: 30.8s	remaining: 629ms
98:	learn: 214.0769445	total: 31.2s	remaining: 315ms
99:	learn: 233.3127504	total: 31.5s	remaining: 0us
Time elapsed for training CatBoost: 32.63
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.588586 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47276
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.082531
[LightGBM] [Info] Start training from score -2.079110
[LightGBM] [Info] Start training from score -3.139967
[LightGBM] [Info] Start training from score -2.122980
[LightGBM] [Info] Start training from score -1.822752
[LightGBM] [Info] Start training from score -1.936213
[LightGBM] [Info] Start training from score -1.834361
[LightGBM] [Info] Start training from score -2.105044
[1]	valid_0's multi_logloss: 1.48513
[2]	valid_0's multi_logloss: 1.20624
[3]	valid_0's multi_logloss: 1.00854
[4]	valid_0's multi_logloss: 0.858762
[5]	valid_0's multi_logloss: 0.740464
[6]	valid_0's multi_logloss: 0.645123
[7]	valid_0's multi_logloss: 0.567311
[8]	valid_0's multi_logloss: 0.502425
[9]	valid_0's multi_logloss: 0.447732
[10]	valid_0's multi_logloss: 0.400363
[11]	valid_0's multi_logloss: 0.36095
[12]	valid_0's multi_logloss: 0.327215
[13]	valid_0's multi_logloss: 0.298164
[14]	valid_0's multi_logloss: 0.271815
[15]	valid_0's multi_logloss: 0.248408
[16]	valid_0's multi_logloss: 0.228477
[17]	valid_0's multi_logloss: 0.211336
[18]	valid_0's multi_logloss: 0.196359
[19]	valid_0's multi_logloss: 0.183371
[20]	valid_0's multi_logloss: 0.171641
[21]	valid_0's multi_logloss: 0.161317
[22]	valid_0's multi_logloss: 0.152008
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[23]	valid_0's multi_logloss: 0.14392
[24]	valid_0's multi_logloss: 0.136337
[25]	valid_0's multi_logloss: 0.129955
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[26]	valid_0's multi_logloss: 0.12388
[27]	valid_0's multi_logloss: 0.118426
[28]	valid_0's multi_logloss: 0.113369
[29]	valid_0's multi_logloss: 0.108947
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[30]	valid_0's multi_logloss: 0.104699
[31]	valid_0's multi_logloss: 0.10095
[32]	valid_0's multi_logloss: 0.0974504
[33]	valid_0's multi_logloss: 0.0937278
[34]	valid_0's multi_logloss: 0.0904739
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[35]	valid_0's multi_logloss: 0.0872384
[36]	valid_0's multi_logloss: 0.0845484
[37]	valid_0's multi_logloss: 0.0814478
[38]	valid_0's multi_logloss: 0.0789599
[39]	valid_0's multi_logloss: 0.0766632
[40]	valid_0's multi_logloss: 0.0743971
[41]	valid_0's multi_logloss: 0.0722571
[42]	valid_0's multi_logloss: 0.0699298
[43]	valid_0's multi_logloss: 0.0679116
[44]	valid_0's multi_logloss: 0.0661111
[45]	valid_0's multi_logloss: 0.0640667
[46]	valid_0's multi_logloss: 0.0623809
[47]	valid_0's multi_logloss: 0.060761
[48]	valid_0's multi_logloss: 0.0592569
[49]	valid_0's multi_logloss: 0.0578011
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0564254
[51]	valid_0's multi_logloss: 0.0549022
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0534414
[53]	valid_0's multi_logloss: 0.0523514
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0510825
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0501143
[56]	valid_0's multi_logloss: 0.0490276
[57]	valid_0's multi_logloss: 0.0478015
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0466918
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0456057
[60]	valid_0's multi_logloss: 0.0446121
[61]	valid_0's multi_logloss: 0.043415
[62]	valid_0's multi_logloss: 0.0425577
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.041697
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0408432
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0400163
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0392247
[67]	valid_0's multi_logloss: 0.0385765
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0377605
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0368505
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0363094
[71]	valid_0's multi_logloss: 0.0356332
[72]	valid_0's multi_logloss: 0.0349435
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0340852
[74]	valid_0's multi_logloss: 0.0334568
[75]	valid_0's multi_logloss: 0.0328682
[76]	valid_0's multi_logloss: 0.0322213
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0316486
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0309321
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.030404
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0298211
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.029264
[82]	valid_0's multi_logloss: 0.0287576
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[83]	valid_0's multi_logloss: 0.0283439
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[84]	valid_0's multi_logloss: 0.0279403
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.027518
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0270437
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[87]	valid_0's multi_logloss: 0.0266028
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0261288
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[89]	valid_0's multi_logloss: 0.025665
[90]	valid_0's multi_logloss: 0.025319
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[91]	valid_0's multi_logloss: 0.0249211
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[92]	valid_0's multi_logloss: 0.0245207
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.0241474
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0237834
[95]	valid_0's multi_logloss: 0.023514
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.0231585
[97]	valid_0's multi_logloss: 0.0228395
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.0225207
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0222422
[100]	valid_0's multi_logloss: 0.0220052
Time elapsed for training LightGBM: 92.44
Training XGBoost...
Time elapsed for training XGBoost: 365.62
begin testing
training set : Hand ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.2
predict bag
Time elapsed for testing bag: 51.11
predict catboost
Time elapsed for testing CatBoost: 0.31
predict lgb
Time elapsed for testing lgb: 1.36
predict xgb
Time elapsed for testing xgb: 2.64
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hand ; testing set : Torso  testing result
tree_model.pred_mean
[[26686    40     0     0   358   355  2161   240]
 [ 3980 17955     2   298   238  2754   491   425]
 [    0  1902   872     0     0     0     0     0]
 [ 3104   665     0   810  6684   769     0     0]
 [  551    16     0     0 15510  4097   300     0]
 [  183     6     0     0   327  8492   172     0]
 [ 2770     3     0     0  1147  1938 15829   123]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.72      0.89      0.80     29840
     Walking       0.87      0.69      0.77     26143
         Run       1.00      0.31      0.48      2774
        Bike       0.73      0.07      0.12     12032
         Car       0.64      0.76      0.69     20474
         Bus       0.46      0.93      0.62      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.73      0.61      0.59    143960
weighted avg       0.73      0.67      0.65    143960

tree_model.pred_mean_rf
[[26733     3     0     0   161   754  1950   239]
 [ 4900 16039     0   298   949  2840   491   626]
 [    0  1860     0   914     0     0     0     0]
 [ 1061   166     0   209  9198  1398     0     0]
 [  690     2     0     0 13891  4127  1764     0]
 [ 1350     0     0     0   301  7529     0     0]
 [ 3921     0     0     0     4  1196 15604  1085]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.69      0.90      0.78     29840
     Walking       0.89      0.61      0.73     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.15      0.02      0.03     12032
         Car       0.57      0.68      0.62     20474
         Bus       0.42      0.82      0.56      9180
       Train       0.50      0.72      0.59     21810
      Subway       0.84      0.49      0.62     21707

    accuracy                           0.63    143960
   macro avg       0.51      0.53      0.49    143960
weighted avg       0.63      0.63      0.60    143960

tree_model.pred_mean_bag
[[25168     6     0     0   249   840  2594   983]
 [ 5239 14725     0   246   427  3565  1030   911]
 [    0  1895     0   879     0     0     0     0]
 [ 2848   723     0   286  3742  4433     0     0]
 [ 1098     0     0     0 15292  3730   354     0]
 [  409     0     0     0   343  8428     0     0]
 [ 3502     0     0     0   643  1974 15398   293]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.66      0.84      0.74     29840
     Walking       0.85      0.56      0.68     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.20      0.02      0.04     12032
         Car       0.74      0.75      0.74     20474
         Bus       0.37      0.92      0.52      9180
       Train       0.51      0.71      0.59     21810
      Subway       0.83      0.49      0.61     21707

    accuracy                           0.62    143960
   macro avg       0.52      0.54      0.49    143960
weighted avg       0.64      0.62      0.60    143960

tree_model.pred_mean_catboost
[[26975   275     0    48   223   875  1314   130]
 [ 6898 14763   609  1525    35  1860   362    91]
 [    0  1894   880     0     0     0     0     0]
 [ 6035  1096     0   519  4084   231    67     0]
 [ 1039     0     0     2 10739  7350  1344     0]
 [ 2214    23     3     0     0  6590   350     0]
 [ 3000     9     0     0  1523  1358 14152  1768]
 [    0     0     0     0     0  2710 11062  7935]]
              precision    recall  f1-score   support

       Still       0.58      0.90      0.71     29840
     Walking       0.82      0.56      0.67     26143
         Run       0.59      0.32      0.41      2774
        Bike       0.25      0.04      0.07     12032
         Car       0.65      0.52      0.58     20474
         Bus       0.31      0.72      0.44      9180
       Train       0.49      0.65      0.56     21810
      Subway       0.80      0.37      0.50     21707

    accuracy                           0.57    143960
   macro avg       0.56      0.51      0.49    143960
weighted avg       0.61      0.57      0.55    143960

tree_model.pred_mean_lightgbm
[[24788   141     0     0   703  1152  2647   409]
 [ 2114 19495    13   305   421  2990   421   384]
 [    0  1888   886     0     0     0     0     0]
 [ 1541   695     0  2091  7107   598     0     0]
 [  301    58     0     0 16745  3033   337     0]
 [   36     5     0     0   818  7870   451     0]
 [ 1606    15     0     0  1356  2647 16174    12]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.83      0.82     29840
     Walking       0.87      0.75      0.80     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.87      0.17      0.29     12032
         Car       0.62      0.82      0.70     20474
         Bus       0.43      0.86      0.57      9180
       Train       0.52      0.74      0.61     21810
      Subway       0.93      0.49      0.64     21707

    accuracy                           0.69    143960
   macro avg       0.76      0.62      0.62    143960
weighted avg       0.75      0.69      0.68    143960

tree_model.pred_mean_xgb
[[26767    87     0     0   586   252  2013   135]
 [ 3284 18592    12   207   348  2872   489   339]
 [    0  1886   888     0     0     0     0     0]
 [ 3374   474     0   628  7187   369     0     0]
 [  592    24     0     0 15189  4446   223     0]
 [  229     9     0     0   929  7882   131     0]
 [ 3169    20     0     0  1164  1643 15814     0]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.72      0.90      0.80     29840
     Walking       0.88      0.71      0.79     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.75      0.05      0.10     12032
         Car       0.60      0.74      0.66     20474
         Bus       0.45      0.86      0.59      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.67    143960
   macro avg       0.73      0.60      0.58    143960
weighted avg       0.73      0.67      0.65    143960

test over
training set : Hand ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.03
predict bag
Time elapsed for testing bag: 42.69
predict catboost
Time elapsed for testing CatBoost: 0.29
predict lgb
Time elapsed for testing lgb: 1.33
predict xgb
Time elapsed for testing xgb: 3.15
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hand ; testing set : Bag  testing result
tree_model.pred_mean
[[25959    78     0     0   808  1080   911  1004]
 [ 2574 21138     0   471   825   471   292   372]
 [    0  1293   351  1130     0     0     0     0]
 [ 3032   474     0     0  7415  1111     0     0]
 [  642     0     0    17 18060  1673    82     0]
 [    0     0     0     0  2326  6683   171     0]
 [  866    31     0     0  3265   849 16705    94]
 [    0     0     0     0     0     0  2295 19412]]
              precision    recall  f1-score   support

       Still       0.78      0.87      0.83     29840
     Walking       0.92      0.81      0.86     26143
         Run       1.00      0.13      0.22      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.55      0.88      0.68     20474
         Bus       0.56      0.73      0.64      9180
       Train       0.82      0.77      0.79     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.75    143960
   macro avg       0.70      0.63      0.62    143960
weighted avg       0.73      0.75      0.73    143960

tree_model.pred_mean_rf
[[27507    11     0     0   264   150   920   988]
 [ 2685 20051     0   277  1250   952   341   587]
 [    0  1269     0  1505     0     0     0     0]
 [ 1326   115     0     0  8465  2126     0     0]
 [  442     0     0     0 17691  2251    55    35]
 [   33     0     0     0  1466  7571   110     0]
 [ 1440     0     0     0  1690   761 16997   922]
 [    0     0     0     0     0     0  2326 19381]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.82      0.92      0.87     29840
     Walking       0.93      0.77      0.84     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.57      0.86      0.69     20474
         Bus       0.55      0.82      0.66      9180
       Train       0.82      0.78      0.80     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    143960
   macro avg       0.57      0.63      0.59    143960
weighted avg       0.71      0.76      0.73    143960

tree_model.pred_mean_bag
[[24236    11     0     0   266  1427  2180  1720]
 [ 3022 19527     0   579   381   804   878   952]
 [    0  1700     0  1074     0     0     0     0]
 [ 2488   322     0     0  5668  3554     0     0]
 [ 1172     0     0     0 16717  2390   195     0]
 [  115     0     0     9   696  8162   198     0]
 [ 1580     0     0     0  3093  1624 15349   164]
 [    0     0     0     0     0     0  2293 19414]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.74      0.81      0.78     29840
     Walking       0.91      0.75      0.82     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.62      0.82      0.71     20474
         Bus       0.45      0.89      0.60      9180
       Train       0.73      0.70      0.72     21810
      Subway       0.87      0.89      0.88     21707

    accuracy                           0.72    143960
   macro avg       0.54      0.61      0.56    143960
weighted avg       0.68      0.72      0.69    143960

tree_model.pred_mean_catboost
[[24068  1282     0     0   924  2526   102   938]
 [ 2895 20777     0  1140   470   364   227   270]
 [    0  1802   400   572     0     0     0     0]
 [ 5062   658     0    75  5340   897     0     0]
 [  701     0     0    24 13575  6062   112     0]
 [   84    29     0    16  2560  6116   375     0]
 [ 1336    68     0     0  2823  1080 14365  2138]
 [    0    10     0     0     0     0  2274 19423]]
              precision    recall  f1-score   support

       Still       0.70      0.81      0.75     29840
     Walking       0.84      0.79      0.82     26143
         Run       1.00      0.14      0.25      2774
        Bike       0.04      0.01      0.01     12032
         Car       0.53      0.66      0.59     20474
         Bus       0.36      0.67      0.47      9180
       Train       0.82      0.66      0.73     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.69    143960
   macro avg       0.64      0.58      0.56    143960
weighted avg       0.67      0.69      0.67    143960

tree_model.pred_mean_lightgbm
[[22752   186     0     0  2304  1763  1648  1187]
 [ 1711 22052     0   225  1012   365   409   369]
 [    0   649   836  1289     0     0     0     0]
 [ 2140   399     0    81  8115  1297     0     0]
 [  571    25     0     0 18494  1298    86     0]
 [    0     0     0     0  2366  6536   278     0]
 [  681    57     0     0  3521   805 16724    22]
 [    0     1     0     0     0     0  2293 19413]]
              precision    recall  f1-score   support

       Still       0.82      0.76      0.79     29840
     Walking       0.94      0.84      0.89     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.05      0.01      0.01     12032
         Car       0.52      0.90      0.66     20474
         Bus       0.54      0.71      0.62      9180
       Train       0.78      0.77      0.77     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.74    143960
   macro avg       0.70      0.65      0.64    143960
weighted avg       0.73      0.74      0.72    143960

tree_model.pred_mean_xgb
[[25884   106     0    30  1145   737  1210   728]
 [ 2928 20659     0   525   849   504   333   345]
 [    0  1003   831   940     0     0     0     0]
 [ 2784   296     0     0  7933  1000    19     0]
 [  639     0     0    19 18736  1080     0     0]
 [    0     1     0     0  2604  6401   174     0]
 [  883    48     0     0  3511   817 16471    80]
 [    0     0     0     0     0     0  2296 19411]]
              precision    recall  f1-score   support

       Still       0.78      0.87      0.82     29840
     Walking       0.93      0.79      0.86     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.00      0.00      0.00     12032
         Car       0.54      0.92      0.68     20474
         Bus       0.61      0.70      0.65      9180
       Train       0.80      0.76      0.78     21810
      Subway       0.94      0.89      0.92     21707

    accuracy                           0.75    143960
   macro avg       0.70      0.65      0.65    143960
weighted avg       0.73      0.75      0.73    143960

test over
training set : Hand ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.07
predict bag
Time elapsed for testing bag: 40.7
predict catboost
Time elapsed for testing CatBoost: 0.25
predict lgb
Time elapsed for testing lgb: 1.32
predict xgb
Time elapsed for testing xgb: 3.2
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hand ; testing set : Hand  testing result
tree_model.pred_mean
[[27462   185     0     0   577   426   184  1006]
 [ 2987 21200     0   321   629   452   184   370]
 [    0   853  1921     0     0     0     0     0]
 [ 4302    94     0  1767  5760   109     0     0]
 [  571   126     0     0 17378  2342    57     0]
 [  210    15     0     0  2111  6844     0     0]
 [ 1226    56     0     0  3744   159 16436   189]
 [    0     0     0     0     0     0  2259 19448]]
              precision    recall  f1-score   support

       Still       0.75      0.92      0.82     29840
     Walking       0.94      0.81      0.87     26143
         Run       1.00      0.69      0.82      2774
        Bike       0.85      0.15      0.25     12032
         Car       0.58      0.85      0.69     20474
         Bus       0.66      0.75      0.70      9180
       Train       0.86      0.75      0.80     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.78    143960
   macro avg       0.82      0.73      0.73    143960
weighted avg       0.81      0.78      0.77    143960

tree_model.pred_mean_rf
[[27022   255     0     0   477   916   133  1037]
 [ 2257 21979     5   462   716   297   106   321]
 [    0   695  2079     0     0     0     0     0]
 [ 1567    77     0  1383  8809   196     0     0]
 [  784   192     0    70 16877  2282   176    93]
 [  361    25     0     0   693  8069    32     0]
 [ 1415    27     0     0  3057   258 15892  1161]
 [    0     1     0     0     0     0  2278 19428]]
              precision    recall  f1-score   support

       Still       0.81      0.91      0.85     29840
     Walking       0.95      0.84      0.89     26143
         Run       1.00      0.75      0.86      2774
        Bike       0.72      0.11      0.20     12032
         Car       0.55      0.82      0.66     20474
         Bus       0.67      0.88      0.76      9180
       Train       0.85      0.73      0.79     21810
      Subway       0.88      0.90      0.89     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.74      0.74    143960
weighted avg       0.80      0.78      0.77    143960

tree_model.pred_mean_bag
[[24742   234     0     0   380  1434  2510   540]
 [ 2512 20931     0   463   488   528   606   615]
 [    0  1561   974   239     0     0     0     0]
 [ 3831   142     0   630  6875   554     0     0]
 [  839   236     0    59 17054  2104   182     0]
 [  379    16     0    19   597  7974   195     0]
 [ 1769     8     0     0  4284   580 14934   235]
 [    0     0     0     0     0     0  2230 19477]]
              precision    recall  f1-score   support

       Still       0.73      0.83      0.77     29840
     Walking       0.91      0.80      0.85     26143
         Run       1.00      0.35      0.52      2774
        Bike       0.45      0.05      0.09     12032
         Car       0.57      0.83      0.68     20474
         Bus       0.61      0.87      0.71      9180
       Train       0.72      0.68      0.70     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.74    143960
   macro avg       0.74      0.66      0.66    143960
weighted avg       0.74      0.74      0.72    143960

tree_model.pred_mean_catboost
[[28102   113     0     0   461   116   100   948]
 [ 4091 18268    78  2049   612   420   265   360]
 [    0   831  1891    52     0     0     0     0]
 [ 7330   291     0   277  4133     0     1     0]
 [  813    76     0     0 15525  3971    89     0]
 [  189    14     0     0  1748  7121   108     0]
 [ 1530    43     0     0  3771   175 16045   246]
 [    0     1     0     0     0     0   365 21341]]
              precision    recall  f1-score   support

       Still       0.67      0.94      0.78     29840
     Walking       0.93      0.70      0.80     26143
         Run       0.96      0.68      0.80      2774
        Bike       0.12      0.02      0.04     12032
         Car       0.59      0.76      0.66     20474
         Bus       0.60      0.78      0.68      9180
       Train       0.95      0.74      0.83     21810
      Subway       0.93      0.98      0.96     21707

    accuracy                           0.75    143960
   macro avg       0.72      0.70      0.69    143960
weighted avg       0.74      0.75      0.73    143960

tree_model.pred_mean_lightgbm
[[26005   251     0     0   690   864   360  1670]
 [ 2283 21721     9   397   628   455   262   388]
 [    0  1209  1565     0     0     0     0     0]
 [ 2626    87     0  3962  5229   128     0     0]
 [  381   111     0     0 18407  1453   122     0]
 [   16     6     0     0  2395  6582   181     0]
 [  724   101     0    12  3617   187 17158    11]
 [    0     0     0     0     0     0  2439 19268]]
              precision    recall  f1-score   support

       Still       0.81      0.87      0.84     29840
     Walking       0.92      0.83      0.88     26143
         Run       0.99      0.56      0.72      2774
        Bike       0.91      0.33      0.48     12032
         Car       0.59      0.90      0.72     20474
         Bus       0.68      0.72      0.70      9180
       Train       0.84      0.79      0.81     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.80    143960
   macro avg       0.83      0.74      0.75    143960
weighted avg       0.82      0.80      0.79    143960

tree_model.pred_mean_xgb
[[27398   164     0     0   576   572   163   967]
 [ 3070 21189     4   321   624   485   174   276]
 [    0   773  2001     0     0     0     0     0]
 [ 3736   222     0  2813  5176    85     0     0]
 [  652    87     0     0 17272  2463     0     0]
 [  193    16     0     0  2586  6385     0     0]
 [ 1123    88     0    64  3905    98 16403   129]
 [    0     0     0     0     0     0  2290 19417]]
              precision    recall  f1-score   support

       Still       0.76      0.92      0.83     29840
     Walking       0.94      0.81      0.87     26143
         Run       1.00      0.72      0.84      2774
        Bike       0.88      0.23      0.37     12032
         Car       0.57      0.84      0.68     20474
         Bus       0.63      0.70      0.66      9180
       Train       0.86      0.75      0.80     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.78    143960
   macro avg       0.82      0.73      0.75    143960
weighted avg       0.81      0.78      0.78    143960

test over
training set : Hand ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.99
predict bag
Time elapsed for testing bag: 41.0
predict catboost
Time elapsed for testing CatBoost: 0.3
predict lgb
Time elapsed for testing lgb: 1.29
predict xgb
Time elapsed for testing xgb: 3.19
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Hand ; testing set : Hips  testing result
tree_model.pred_mean
[[23392    86     0    69  1163  1460  3506   164]
 [ 1820 21459     0  1090   164   403   834   373]
 [    0   974   143  1657     0     0     0     0]
 [ 1541  4855     0  2863  2522   251     0     0]
 [  735    11     0     0 16188  3459    81     0]
 [   84     5     0    30   631  7822   608     0]
 [ 1187     1     0    47  2122   929 17485    39]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.81      0.78      0.80     29840
     Walking       0.78      0.82      0.80     26143
         Run       1.00      0.05      0.10      2774
        Bike       0.50      0.24      0.32     12032
         Car       0.71      0.79      0.75     20474
         Bus       0.55      0.85      0.67      9180
       Train       0.52      0.80      0.63     21810
      Subway       0.95      0.49      0.65     21707

    accuracy                           0.69    143960
   macro avg       0.73      0.60      0.59    143960
weighted avg       0.73      0.69      0.68    143960

tree_model.pred_mean_rf
[[25430   149     0    85    36   218  3787   135]
 [ 1541 22694     0   924   185   303   157   339]
 [    0   298     0  2476     0     0     0     0]
 [ 1062  3739     0  3509  3664    58     0     0]
 [ 1348    38     0     0 12496  2620  3943    29]
 [  766    32     0    23   114  7852   393     0]
 [ 1584    21     0    44  1230  1109 16971   851]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.80      0.85      0.83     29840
     Walking       0.84      0.87      0.85     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.50      0.29      0.37     12032
         Car       0.70      0.61      0.65     20474
         Bus       0.65      0.86      0.74      9180
       Train       0.47      0.78      0.58     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.69    143960
   macro avg       0.61      0.59      0.58    143960
weighted avg       0.71      0.69      0.68    143960

tree_model.pred_mean_bag
[[23154   147     0     0    71  2027  4013   428]
 [ 1692 21528     0   985    48   422   867   601]
 [    0  1777     0   997     0     0     0     0]
 [ 1119  6856     0   777  3064   216     0     0]
 [ 1806    15     0     1 15286  3040   326     0]
 [  551    29     0    12   590  7763   235     0]
 [ 1747    19     0    24  2108  1297 16190   425]
 [    0     0     0     0     0     0 11099 10608]]
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/jnli/.conda/envs/zhaoyayart/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1318: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
              precision    recall  f1-score   support

       Still       0.77      0.78      0.77     29840
     Walking       0.71      0.82      0.76     26143
         Run       0.00      0.00      0.00      2774
        Bike       0.28      0.06      0.10     12032
         Car       0.72      0.75      0.73     20474
         Bus       0.53      0.85      0.65      9180
       Train       0.49      0.74      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.66    143960
   macro avg       0.55      0.56      0.53    143960
weighted avg       0.66      0.66      0.64    143960

tree_model.pred_mean_catboost
[[24328   141     0   131   859  2442  1827   112]
 [ 2198 14882     0  8119    26   142   453   323]
 [    0  1555   786   433     0     0     0     0]
 [ 2203  4048     0  3428  2159   194     0     0]
 [  814     0     0    29 11874  6650  1107     0]
 [   34    87     0    42   384  8002   631     0]
 [ 1133     0     0    42  1610   869 16891  1265]
 [    0     0     0     7     0     0  6181 15519]]
              precision    recall  f1-score   support

       Still       0.79      0.82      0.80     29840
     Walking       0.72      0.57      0.64     26143
         Run       1.00      0.28      0.44      2774
        Bike       0.28      0.28      0.28     12032
         Car       0.70      0.58      0.64     20474
         Bus       0.44      0.87      0.58      9180
       Train       0.62      0.77      0.69     21810
      Subway       0.90      0.71      0.80     21707

    accuracy                           0.66    143960
   macro avg       0.68      0.61      0.61    143960
weighted avg       0.70      0.66      0.67    143960

tree_model.pred_mean_lightgbm
[[21850   134     0    11  1975  1762  3762   346]
 [ 1375 21639     0   809   273   450  1242   355]
 [    0   718   740  1316     0     0     0     0]
 [  936  4987     0  3595  2022   492     0     0]
 [  187    27     0     0 17398  2577   285     0]
 [    3     1     0     0   765  7657   754     0]
 [  915     4     0    47  2087   865 17892     0]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.86      0.73      0.79     29840
     Walking       0.79      0.83      0.81     26143
         Run       1.00      0.27      0.42      2774
        Bike       0.62      0.30      0.40     12032
         Car       0.71      0.85      0.77     20474
         Bus       0.55      0.83      0.67      9180
       Train       0.51      0.82      0.63     21810
      Subway       0.94      0.49      0.64     21707

    accuracy                           0.70    143960
   macro avg       0.75      0.64      0.64    143960
weighted avg       0.75      0.70      0.70    143960

tree_model.pred_mean_xgb
[[23483    86     0    76  1324  1221  3530   120]
 [ 1914 21382     0  1029   201   476   875   266]
 [    0   287   648  1839     0     0     0     0]
 [ 1293  5356     0  2518  2578   287     0     0]
 [  553    19     0     0 16438  3464     0     0]
 [  287     2     0     0  1224  7279   388     0]
 [ 1292    32     0    47  2619   856 16922    42]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.81      0.79      0.80     29840
     Walking       0.79      0.82      0.80     26143
         Run       1.00      0.23      0.38      2774
        Bike       0.46      0.21      0.29     12032
         Car       0.67      0.80      0.73     20474
         Bus       0.54      0.79      0.64      9180
       Train       0.52      0.78      0.62     21810
      Subway       0.96      0.49      0.65     21707

    accuracy                           0.69    143960
   macro avg       0.72      0.61      0.61    143960
weighted avg       0.72      0.69      0.68    143960

test over
training set:Torso,the 3th training set
begin training
X_train: (980525, 204)
y_train: 980525
Training rf...
Time elapsed for training rf: 175.28
Training bag (tree-based)...
Time elapsed for training bag (tree-based): 137.6
Training CatBoost...
0:	learn: 1.5067167	total: 533ms	remaining: 52.7s
1:	learn: 1.1199235	total: 985ms	remaining: 48.3s
2:	learn: 0.8940811	total: 1.26s	remaining: 40.8s
3:	learn: 0.7848897	total: 1.57s	remaining: 37.8s
4:	learn: 1.3843898	total: 1.86s	remaining: 35.4s
5:	learn: 1.2793620	total: 2.23s	remaining: 34.9s
6:	learn: 32.9185600	total: 2.5s	remaining: 33.2s
7:	learn: 15.4790597	total: 2.78s	remaining: 31.9s
8:	learn: 10.5043754	total: 3.05s	remaining: 30.8s
9:	learn: 16.1717192	total: 3.35s	remaining: 30.2s
10:	learn: 10.7871023	total: 3.62s	remaining: 29.3s
11:	learn: 10.7509964	total: 3.95s	remaining: 29s
12:	learn: 10.7378216	total: 4.25s	remaining: 28.5s
13:	learn: 8.5510470	total: 4.53s	remaining: 27.8s
14:	learn: 8.5670359	total: 4.83s	remaining: 27.4s
15:	learn: 8.5574382	total: 5.13s	remaining: 26.9s
16:	learn: 8.5404675	total: 5.4s	remaining: 26.4s
17:	learn: 8.2904955	total: 5.82s	remaining: 26.5s
18:	learn: 8.2570614	total: 6.17s	remaining: 26.3s
19:	learn: 8.2372934	total: 6.46s	remaining: 25.8s
20:	learn: 6.3221400	total: 6.78s	remaining: 25.5s
21:	learn: 6.3174392	total: 7.04s	remaining: 25s
22:	learn: 6.3054435	total: 7.32s	remaining: 24.5s
23:	learn: 6.2937540	total: 7.63s	remaining: 24.2s
24:	learn: 6.2791873	total: 7.9s	remaining: 23.7s
25:	learn: 6.2708774	total: 8.19s	remaining: 23.3s
26:	learn: 6.2610126	total: 8.5s	remaining: 23s
27:	learn: 6.2474148	total: 8.9s	remaining: 22.9s
28:	learn: 6.2981320	total: 9.21s	remaining: 22.5s
29:	learn: 6.4663133	total: 9.52s	remaining: 22.2s
30:	learn: 11.3806035	total: 9.85s	remaining: 21.9s
31:	learn: 11.3080054	total: 10.1s	remaining: 21.5s
32:	learn: 11.2792489	total: 10.4s	remaining: 21.1s
33:	learn: 10.6164226	total: 10.7s	remaining: 20.8s
34:	learn: 10.6028929	total: 11s	remaining: 20.4s
35:	learn: 10.6273344	total: 11.3s	remaining: 20.1s
36:	learn: 10.6000623	total: 11.7s	remaining: 19.9s
37:	learn: 10.5816568	total: 12s	remaining: 19.6s
38:	learn: 10.5586698	total: 12.4s	remaining: 19.4s
39:	learn: 10.5273707	total: 12.7s	remaining: 19s
40:	learn: 10.5844421	total: 13s	remaining: 18.7s
41:	learn: 18.0760435	total: 13.3s	remaining: 18.3s
42:	learn: 22.7410411	total: 13.6s	remaining: 18s
43:	learn: 21.2173641	total: 13.8s	remaining: 17.6s
44:	learn: 20.5282733	total: 14.1s	remaining: 17.2s
45:	learn: 21.1732393	total: 14.4s	remaining: 16.9s
46:	learn: 25.6861878	total: 14.7s	remaining: 16.5s
47:	learn: 24.2788011	total: 14.9s	remaining: 16.2s
48:	learn: 23.3523484	total: 15.2s	remaining: 15.8s
49:	learn: 22.6999662	total: 15.5s	remaining: 15.5s
50:	learn: 17.9112805	total: 15.8s	remaining: 15.2s
51:	learn: 19.2353074	total: 16.1s	remaining: 14.9s
52:	learn: 18.3405180	total: 16.4s	remaining: 14.6s
53:	learn: 18.2129501	total: 16.7s	remaining: 14.2s
54:	learn: 20.1141827	total: 17s	remaining: 13.9s
55:	learn: 19.5890412	total: 17.3s	remaining: 13.6s
56:	learn: 18.4026600	total: 17.5s	remaining: 13.2s
57:	learn: 18.3743409	total: 17.8s	remaining: 12.9s
58:	learn: 18.3398729	total: 18.1s	remaining: 12.6s
59:	learn: 18.3100057	total: 18.4s	remaining: 12.2s
60:	learn: 16.7224108	total: 18.8s	remaining: 12s
61:	learn: 15.1052777	total: 19s	remaining: 11.7s
62:	learn: 13.9899102	total: 19.3s	remaining: 11.3s
63:	learn: 13.9880458	total: 19.6s	remaining: 11s
64:	learn: 13.9781710	total: 19.9s	remaining: 10.7s
65:	learn: 13.9755836	total: 20.2s	remaining: 10.4s
66:	learn: 13.9701602	total: 20.5s	remaining: 10.1s
67:	learn: 13.9683094	total: 20.8s	remaining: 9.79s
68:	learn: 13.9617207	total: 21.1s	remaining: 9.47s
69:	learn: 13.9554694	total: 21.4s	remaining: 9.17s
70:	learn: 13.9461974	total: 21.7s	remaining: 8.85s
71:	learn: 13.8976711	total: 21.9s	remaining: 8.54s
72:	learn: 13.8787553	total: 22.3s	remaining: 8.26s
73:	learn: 13.8686672	total: 22.6s	remaining: 7.93s
74:	learn: 14.3219872	total: 23s	remaining: 7.65s
75:	learn: 13.4050474	total: 23.3s	remaining: 7.34s
76:	learn: 13.3964086	total: 23.6s	remaining: 7.05s
77:	learn: 13.6707261	total: 23.9s	remaining: 6.73s
78:	learn: 13.6104566	total: 24.2s	remaining: 6.42s
79:	learn: 13.5936473	total: 24.5s	remaining: 6.12s
80:	learn: 17.1023797	total: 24.8s	remaining: 5.82s
81:	learn: 26.7794042	total: 25.1s	remaining: 5.51s
82:	learn: 26.5993170	total: 25.4s	remaining: 5.2s
83:	learn: 26.5623958	total: 25.6s	remaining: 4.88s
84:	learn: 26.3895065	total: 25.9s	remaining: 4.57s
85:	learn: 26.3220172	total: 26.2s	remaining: 4.26s
86:	learn: 25.9598420	total: 26.5s	remaining: 3.95s
87:	learn: 25.5678185	total: 26.7s	remaining: 3.65s
88:	learn: 25.4363611	total: 27s	remaining: 3.34s
89:	learn: 25.0953148	total: 27.3s	remaining: 3.03s
90:	learn: 24.7568003	total: 27.5s	remaining: 2.72s
91:	learn: 24.4160094	total: 27.8s	remaining: 2.42s
92:	learn: 24.0752193	total: 28.1s	remaining: 2.11s
93:	learn: 23.8598585	total: 28.3s	remaining: 1.81s
94:	learn: 23.8531614	total: 28.6s	remaining: 1.5s
95:	learn: 23.8338328	total: 28.9s	remaining: 1.21s
96:	learn: 23.7170542	total: 29.2s	remaining: 903ms
97:	learn: 22.9854225	total: 29.5s	remaining: 602ms
98:	learn: 22.9338891	total: 29.8s	remaining: 301ms
99:	learn: 22.9783664	total: 30.1s	remaining: 0us
Time elapsed for training CatBoost: 31.36
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 0.459487 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47482
[LightGBM] [Info] Number of data points in the train set: 784420, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.081417
[LightGBM] [Info] Start training from score -2.076270
[LightGBM] [Info] Start training from score -3.144691
[LightGBM] [Info] Start training from score -2.123289
[LightGBM] [Info] Start training from score -1.820199
[LightGBM] [Info] Start training from score -1.936955
[LightGBM] [Info] Start training from score -1.836103
[LightGBM] [Info] Start training from score -2.107359
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[1]	valid_0's multi_logloss: 1.46801
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[2]	valid_0's multi_logloss: 1.18594
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[3]	valid_0's multi_logloss: 0.986357
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[4]	valid_0's multi_logloss: 0.835362
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[5]	valid_0's multi_logloss: 0.715776
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[6]	valid_0's multi_logloss: 0.619122
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[7]	valid_0's multi_logloss: 0.539777
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[8]	valid_0's multi_logloss: 0.47177
[9]	valid_0's multi_logloss: 0.416164
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[10]	valid_0's multi_logloss: 0.368637
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[11]	valid_0's multi_logloss: 0.327149
[12]	valid_0's multi_logloss: 0.292516
[13]	valid_0's multi_logloss: 0.262424
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[14]	valid_0's multi_logloss: 0.236546
[15]	valid_0's multi_logloss: 0.214607
[16]	valid_0's multi_logloss: 0.195087
[17]	valid_0's multi_logloss: 0.177514
[18]	valid_0's multi_logloss: 0.162649
[19]	valid_0's multi_logloss: 0.149637
[20]	valid_0's multi_logloss: 0.138168
[21]	valid_0's multi_logloss: 0.128083
[22]	valid_0's multi_logloss: 0.119108
[23]	valid_0's multi_logloss: 0.111025
[24]	valid_0's multi_logloss: 0.103867
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[25]	valid_0's multi_logloss: 0.0971184
[26]	valid_0's multi_logloss: 0.0917279
[27]	valid_0's multi_logloss: 0.0866623
[28]	valid_0's multi_logloss: 0.0820538
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[29]	valid_0's multi_logloss: 0.0776023
[30]	valid_0's multi_logloss: 0.0727803
[31]	valid_0's multi_logloss: 0.0691455
[32]	valid_0's multi_logloss: 0.0656177
[33]	valid_0's multi_logloss: 0.0622026
[34]	valid_0's multi_logloss: 0.059493
[35]	valid_0's multi_logloss: 0.0570098
[36]	valid_0's multi_logloss: 0.0546634
[37]	valid_0's multi_logloss: 0.0525271
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[38]	valid_0's multi_logloss: 0.0504597
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[39]	valid_0's multi_logloss: 0.048722
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[40]	valid_0's multi_logloss: 0.0470023
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0449906
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[42]	valid_0's multi_logloss: 0.0432834
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[43]	valid_0's multi_logloss: 0.0416955
[44]	valid_0's multi_logloss: 0.0401829
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0388582
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[46]	valid_0's multi_logloss: 0.0375084
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0363381
[48]	valid_0's multi_logloss: 0.0351344
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[49]	valid_0's multi_logloss: 0.0338498
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0327351
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0317997
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0308238
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[53]	valid_0's multi_logloss: 0.0299701
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[54]	valid_0's multi_logloss: 0.0290439
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[55]	valid_0's multi_logloss: 0.0281061
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0274088
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[57]	valid_0's multi_logloss: 0.0267164
[58]	valid_0's multi_logloss: 0.0259322
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.025225
[60]	valid_0's multi_logloss: 0.0244777
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0238331
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0231795
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0225698
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0219876
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[65]	valid_0's multi_logloss: 0.0213878
[66]	valid_0's multi_logloss: 0.0208607
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0203942
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[68]	valid_0's multi_logloss: 0.0199372
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[69]	valid_0's multi_logloss: 0.0195342
[70]	valid_0's multi_logloss: 0.019009
[71]	valid_0's multi_logloss: 0.0185552
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[72]	valid_0's multi_logloss: 0.0180851
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0176604
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[74]	valid_0's multi_logloss: 0.0172714
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.016904
[76]	valid_0's multi_logloss: 0.0165556
[77]	valid_0's multi_logloss: 0.0162382
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[78]	valid_0's multi_logloss: 0.0159155
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[79]	valid_0's multi_logloss: 0.0155102
[80]	valid_0's multi_logloss: 0.01517
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[81]	valid_0's multi_logloss: 0.0148595
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[82]	valid_0's multi_logloss: 0.0145859
[83]	valid_0's multi_logloss: 0.0142625
[84]	valid_0's multi_logloss: 0.0139901
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0136772
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0133782
[87]	valid_0's multi_logloss: 0.0130878
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[88]	valid_0's multi_logloss: 0.0128291
[89]	valid_0's multi_logloss: 0.0125949
[90]	valid_0's multi_logloss: 0.0122941
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[91]	valid_0's multi_logloss: 0.0120332
[92]	valid_0's multi_logloss: 0.0117985
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[93]	valid_0's multi_logloss: 0.0115964
[94]	valid_0's multi_logloss: 0.0113712
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.0111565
[96]	valid_0's multi_logloss: 0.010967
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[97]	valid_0's multi_logloss: 0.0107384
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[98]	valid_0's multi_logloss: 0.0105421
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.010403
[100]	valid_0's multi_logloss: 0.0102587
Time elapsed for training LightGBM: 89.22
Training XGBoost...
Time elapsed for training XGBoost: 350.33
begin testing
training set : Torso ; testing set : Torso; test order: 0
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.98
predict bag
Time elapsed for testing bag: 40.39
predict catboost
Time elapsed for testing CatBoost: 0.47
predict lgb
Time elapsed for testing lgb: 1.47
predict xgb
Time elapsed for testing xgb: 3.26
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Torso ; testing set : Torso  testing result
tree_model.pred_mean
[[25387   170     0    61   706   379  2318   819]
 [ 1641 22112    14   933   224   325   597   297]
 [    0  1123   889   762     0     0     0     0]
 [  318   180     0  7944  3575    15     0     0]
 [  299    31     0     0 18473  1465   206     0]
 [   98    38     0     9  2252  6585   198     0]
 [ 3103     4     0    45  1039  1449 15091  1079]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.85      0.84     29840
     Walking       0.93      0.85      0.89     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.81      0.66      0.73     12032
         Car       0.70      0.90      0.79     20474
         Bus       0.64      0.72      0.68      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.83      0.49      0.61     21707

    accuracy                           0.74    143960
   macro avg       0.78      0.68      0.70    143960
weighted avg       0.77      0.74      0.74    143960

tree_model.pred_mean_rf
[[25923   205     0    88   344  1255  1865   160]
 [ 1694 18988    21  4541   125   311   287   176]
 [    0     7   907  1860     0     0     0     0]
 [  116   140     0  7454  2954  1077   291     0]
 [  359    38     0     0 17344  2503   230     0]
 [  355    55     0    25   476  8218    51     0]
 [ 2630     3     0    45   769  2209 15100  1054]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.87      0.85     29840
     Walking       0.98      0.73      0.83     26143
         Run       0.98      0.33      0.49      2774
        Bike       0.53      0.62      0.57     12032
         Car       0.79      0.85      0.82     20474
         Bus       0.53      0.90      0.66      9180
       Train       0.52      0.69      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.73    143960
   macro avg       0.76      0.68      0.68    143960
weighted avg       0.77      0.73      0.73    143960

tree_model.pred_mean_bag
[[24687   188     0    85   613  1059  2173  1035]
 [  907 21758     7  2140   337   354   292   348]
 [    0  1410   848   516     0     0     0     0]
 [   58  1756     0  4932  4304   881   101     0]
 [  582    57     0    24 17827  1892    92     0]
 [  386    16     0   106   427  8245     0     0]
 [ 2155    20     0    47  1019  2794 14635  1140]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.83      0.84     29840
     Walking       0.86      0.83      0.85     26143
         Run       0.99      0.31      0.47      2774
        Bike       0.63      0.41      0.50     12032
         Car       0.73      0.87      0.79     20474
         Bus       0.54      0.90      0.68      9180
       Train       0.52      0.67      0.58     21810
      Subway       0.81      0.49      0.61     21707

    accuracy                           0.72    143960
   macro avg       0.74      0.66      0.66    143960
weighted avg       0.74      0.72      0.71    143960

tree_model.pred_mean_catboost
[[22383   114     0    72   385   884  5016   986]
 [ 2267 18555    20  1908   457  1997   772   167]
 [    0  1361   867   546     0     0     0     0]
 [  322   559     0  7006  3751   348    46     0]
 [  441    18     0     0 17116  2421   478     0]
 [  473    24     0    10  1789  6736   148     0]
 [ 3964    11     0    55   597   802 15222  1159]
 [  269     3     0     0     0     0 10827 10608]]
              precision    recall  f1-score   support

       Still       0.74      0.75      0.75     29840
     Walking       0.90      0.71      0.79     26143
         Run       0.98      0.31      0.47      2774
        Bike       0.73      0.58      0.65     12032
         Car       0.71      0.84      0.77     20474
         Bus       0.51      0.73      0.60      9180
       Train       0.47      0.70      0.56     21810
      Subway       0.82      0.49      0.61     21707

    accuracy                           0.68    143960
   macro avg       0.73      0.64      0.65    143960
weighted avg       0.73      0.68      0.69    143960

tree_model.pred_mean_lightgbm
[[23314   444     0   321   807   164  3487  1303]
 [ 1338 22909    18   376   364   116   706   316]
 [    0  1337   886   551     0     0     0     0]
 [  409   520     0  7620  3481     0     2     0]
 [  286    21     0     0 18945  1012   210     0]
 [  152    42     0     2  2532  6022   430     0]
 [ 1701    10     0    26  2855  1090 15177   951]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.78      0.82     29840
     Walking       0.91      0.88      0.89     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.86      0.63      0.73     12032
         Car       0.65      0.93      0.77     20474
         Bus       0.72      0.66      0.68      9180
       Train       0.49      0.70      0.57     21810
      Subway       0.80      0.49      0.61     21707

    accuracy                           0.73    143960
   macro avg       0.78      0.67      0.69    143960
weighted avg       0.77      0.73      0.73    143960

tree_model.pred_mean_xgb
[[26459   164     0    63   931     4  2047   172]
 [ 1738 21672    18   917   576   121   713   388]
 [    0   933   890   951     0     0     0     0]
 [  307   241     0  7911  3573     0     0     0]
 [  302    56     0     0 19254   687   175     0]
 [  179    30     0    38  2279  6264   390     0]
 [ 1552     1     0    43  2250  1761 15105  1098]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.89      0.88     29840
     Walking       0.94      0.83      0.88     26143
         Run       0.98      0.32      0.48      2774
        Bike       0.80      0.66      0.72     12032
         Car       0.67      0.94      0.78     20474
         Bus       0.71      0.68      0.70      9180
       Train       0.51      0.69      0.59     21810
      Subway       0.86      0.49      0.62     21707

    accuracy                           0.75    143960
   macro avg       0.79      0.69      0.71    143960
weighted avg       0.78      0.75      0.75    143960

test over
training set : Torso ; testing set : Bag; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.02
predict bag
Time elapsed for testing bag: 40.98
predict catboost
Time elapsed for testing CatBoost: 0.28
predict lgb
Time elapsed for testing lgb: 1.31
predict xgb
Time elapsed for testing xgb: 2.97
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Torso ; testing set : Bag  testing result
tree_model.pred_mean
[[26690   152   105    80   684   369   573  1187]
 [ 1460 16840     0  5825   742    51   767   458]
 [    0  1435  1095   244     0     0     0     0]
 [  290   149     0  4945  6152   496     0     0]
 [  299    23     0     0 17537  2511   104     0]
 [   54    33     0   459  1328  7181   125     0]
 [  191     0     0    96  4342   703 15385  1093]
 [    0     0     0     0     0     0  2300 19407]]
              precision    recall  f1-score   support

       Still       0.92      0.89      0.91     29840
     Walking       0.90      0.64      0.75     26143
         Run       0.91      0.39      0.55      2774
        Bike       0.42      0.41      0.42     12032
         Car       0.57      0.86      0.68     20474
         Bus       0.63      0.78      0.70      9180
       Train       0.80      0.71      0.75     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    143960
   macro avg       0.76      0.70      0.71    143960
weighted avg       0.78      0.76      0.76    143960

tree_model.pred_mean_rf
[[26131   125     0   125   545  1709   242   963]
 [ 1209 19379     0  4373   156   160   642   224]
 [    0   978   569  1227     0     0     0     0]
 [  345    31     0  5094  4488  2064    10     0]
 [  416    16     0     0 17366  2420   256     0]
 [    0    29     0   143  1503  7462    43     0]
 [  955     4     0    66  2657   801 16280  1047]
 [    0     0     0     0     0     0  4702 17005]]
              precision    recall  f1-score   support

       Still       0.90      0.88      0.89     29840
     Walking       0.94      0.74      0.83     26143
         Run       1.00      0.21      0.34      2774
        Bike       0.46      0.42      0.44     12032
         Car       0.65      0.85      0.74     20474
         Bus       0.51      0.81      0.63      9180
       Train       0.73      0.75      0.74     21810
      Subway       0.88      0.78      0.83     21707

    accuracy                           0.76    143960
   macro avg       0.76      0.68      0.68    143960
weighted avg       0.78      0.76      0.76    143960

tree_model.pred_mean_bag
[[22408   236     0    66   670  3089  1565  1806]
 [ 1134 22141     0  1502   335   434   184   413]
 [    0  1588  1060   126     0     0     0     0]
 [   60   793     0  1519  6691  2969     0     0]
 [  751     8     0    14 17952  1724    25     0]
 [    0    28     0   144   857  8006   145     0]
 [ 1227     0     0    91  4116  1010 14216  1150]
 [    0     0     0     0     0     0  2297 19410]]
              precision    recall  f1-score   support

       Still       0.88      0.75      0.81     29840
     Walking       0.89      0.85      0.87     26143
         Run       1.00      0.38      0.55      2774
        Bike       0.44      0.13      0.20     12032
         Car       0.59      0.88      0.70     20474
         Bus       0.46      0.87      0.61      9180
       Train       0.77      0.65      0.71     21810
      Subway       0.85      0.89      0.87     21707

    accuracy                           0.74    143960
   macro avg       0.74      0.68      0.66    143960
weighted avg       0.76      0.74      0.73    143960

tree_model.pred_mean_catboost
[[24504   126     0   196  1342  2959   541   172]
 [ 2214 13675    23  5778   994  1883  1200   376]
 [    0  2222   346   206     0     0     0     0]
 [  612    32     0  2660  7850   869     9     0]
 [  361    30     0     0 16419  3577    87     0]
 [   78    26     0   100  2813  6162     1     0]
 [  367    43     0    88  3058  2287 15172   795]
 [    0     3     0     0     0   395  2326 18983]]
              precision    recall  f1-score   support

       Still       0.87      0.82      0.85     29840
     Walking       0.85      0.52      0.65     26143
         Run       0.94      0.12      0.22      2774
        Bike       0.29      0.22      0.25     12032
         Car       0.51      0.80      0.62     20474
         Bus       0.34      0.67      0.45      9180
       Train       0.78      0.70      0.74     21810
      Subway       0.93      0.87      0.90     21707

    accuracy                           0.68    143960
   macro avg       0.69      0.59      0.58    143960
weighted avg       0.73      0.68      0.68    143960

tree_model.pred_mean_lightgbm
[[23839   155  1764   324   364   252  1617  1525]
 [ 1377 17770     1  5371   450   238   505   431]
 [    0  1072  1701     1     0     0     0     0]
 [  982   499     0  5907  4644     0     0     0]
 [  186    27     0   371 18127  1561   202     0]
 [   13    18     0  2997   819  5070   263     0]
 [  167     0    84   141  5121   147 15058  1092]
 [    0     0     0     0     0     0  2295 19412]]
              precision    recall  f1-score   support

       Still       0.90      0.80      0.85     29840
     Walking       0.91      0.68      0.78     26143
         Run       0.48      0.61      0.54      2774
        Bike       0.39      0.49      0.44     12032
         Car       0.61      0.89      0.73     20474
         Bus       0.70      0.55      0.62      9180
       Train       0.76      0.69      0.72     21810
      Subway       0.86      0.89      0.88     21707

    accuracy                           0.74    143960
   macro avg       0.70      0.70      0.69    143960
weighted avg       0.77      0.74      0.75    143960

tree_model.pred_mean_xgb
[[24075   134  3496   403   723   109   405   495]
 [ 1633 15380     2  6597   868   195   856   612]
 [    0  1347  1176   251     0     0     0     0]
 [  170    69     0  6786  4669   338     0     0]
 [  383    42   177   744 17411  1623    94     0]
 [   14    32     0  2585   688  5435   426     0]
 [  228     0    60    95  4130   532 15706  1059]
 [    0     0     0     0     0     0  2292 19415]]
              precision    recall  f1-score   support

       Still       0.91      0.81      0.85     29840
     Walking       0.90      0.59      0.71     26143
         Run       0.24      0.42      0.31      2774
        Bike       0.39      0.56      0.46     12032
         Car       0.61      0.85      0.71     20474
         Bus       0.66      0.59      0.62      9180
       Train       0.79      0.72      0.76     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.73    143960
   macro avg       0.68      0.68      0.67    143960
weighted avg       0.77      0.73      0.74    143960

test over
training set : Torso ; testing set : Hand; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.06
predict bag
Time elapsed for testing bag: 40.23
predict catboost
Time elapsed for testing CatBoost: 0.28
predict lgb
Time elapsed for testing lgb: 1.36
predict xgb
Time elapsed for testing xgb: 2.73
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Torso ; testing set : Hand  testing result
tree_model.pred_mean
[[24457  1230   166  1814   290     0   660  1223]
 [  326 18511     0  6490     0     0   387   429]
 [    0   543  1540   691     0     0     0     0]
 [    0   107     0 11828    97     0     0     0]
 [  197   234     0  2950 15171  1826    96     0]
 [    2     0     0   961  1151  6998    68     0]
 [  541    66     0  1636  3688     0 14701  1178]
 [    0     0     0     0     0     0  2285 19422]]
              precision    recall  f1-score   support

       Still       0.96      0.82      0.88     29840
     Walking       0.89      0.71      0.79     26143
         Run       0.90      0.56      0.69      2774
        Bike       0.45      0.98      0.62     12032
         Car       0.74      0.74      0.74     20474
         Bus       0.79      0.76      0.78      9180
       Train       0.81      0.67      0.73     21810
      Subway       0.87      0.89      0.88     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.77      0.76    143960
weighted avg       0.83      0.78      0.79    143960

tree_model.pred_mean_rf
[[26159    99     0  2052   185  1007   115   223]
 [  655  3554     0 21750     0     0     3   181]
 [    0     0  1491  1283     0     0     0     0]
 [    0     0     0 11990    42     0     0     0]
 [  308    15     0  2673 14972  2465    41     0]
 [    0     0     0   682   871  7627     0     0]
 [ 1272    10     0   843  2738   137 15537  1273]
 [    0    18     0     0     0     0     0 21689]]
              precision    recall  f1-score   support

       Still       0.92      0.88      0.90     29840
     Walking       0.96      0.14      0.24     26143
         Run       1.00      0.54      0.70      2774
        Bike       0.29      1.00      0.45     12032
         Car       0.80      0.73      0.76     20474
         Bus       0.68      0.83      0.75      9180
       Train       0.99      0.71      0.83     21810
      Subway       0.93      1.00      0.96     21707

    accuracy                           0.72    143960
   macro avg       0.82      0.73      0.70    143960
weighted avg       0.86      0.72      0.71    143960

tree_model.pred_mean_bag
[[20297  4173     0   233   180  2435  1784   738]
 [  106 22098     0  3727     0     1    18   193]
 [    0   913  1190   671     0     0     0     0]
 [    0  5394     0  6638     0     0     0     0]
 [  277   380     0  5666 12792  1359     0     0]
 [   40    18     0   696   549  7689   188     0]
 [  999   133     0  1444  4122   278 13562  1272]
 [    0     0     0    76     0     0  1903 19728]]
              precision    recall  f1-score   support

       Still       0.93      0.68      0.79     29840
     Walking       0.67      0.85      0.75     26143
         Run       1.00      0.43      0.60      2774
        Bike       0.35      0.55      0.43     12032
         Car       0.73      0.62      0.67     20474
         Bus       0.65      0.84      0.73      9180
       Train       0.78      0.62      0.69     21810
      Subway       0.90      0.91      0.90     21707

    accuracy                           0.72    143960
   macro avg       0.75      0.69      0.69    143960
weighted avg       0.76      0.72      0.73    143960

tree_model.pred_mean_catboost
[[21271  1515     0  2352   603   773  2631   695]
 [  422 19773     0  4965    44    23   446   470]
 [    0  1207   108  1459     0     0     0     0]
 [ 1678  2030     0  8208   116     0     0     0]
 [  180   306     0  5097 12757  1950   184     0]
 [    0    65     0   466  1937  6712     0     0]
 [  360   124     0  1558  3191   877 14811   889]
 [    0     0     0     0     0     0  2302 19405]]
              precision    recall  f1-score   support

       Still       0.89      0.71      0.79     29840
     Walking       0.79      0.76      0.77     26143
         Run       1.00      0.04      0.07      2774
        Bike       0.34      0.68      0.45     12032
         Car       0.68      0.62      0.65     20474
         Bus       0.65      0.73      0.69      9180
       Train       0.73      0.68      0.70     21810
      Subway       0.90      0.89      0.90     21707

    accuracy                           0.72    143960
   macro avg       0.75      0.64      0.63    143960
weighted avg       0.76      0.72      0.72    143960

tree_model.pred_mean_lightgbm
[[19991   978  5038  1495   236     0   756  1346]
 [  622 18199     4  6309     0     0   539   470]
 [    0   320  2173   281     0     0     0     0]
 [   25     5     0 11895   107     0     0     0]
 [  152   326   224  2759 15410  1415   188     0]
 [   23     0     0  2756   577  5429   395     0]
 [  682    71   158  1493  4171     8 14330   897]
 [  168     0     0     0     0    83  2299 19157]]
              precision    recall  f1-score   support

       Still       0.92      0.67      0.78     29840
     Walking       0.91      0.70      0.79     26143
         Run       0.29      0.78      0.42      2774
        Bike       0.44      0.99      0.61     12032
         Car       0.75      0.75      0.75     20474
         Bus       0.78      0.59      0.67      9180
       Train       0.77      0.66      0.71     21810
      Subway       0.88      0.88      0.88     21707

    accuracy                           0.74    143960
   macro avg       0.72      0.75      0.70    143960
weighted avg       0.81      0.74      0.75    143960

tree_model.pred_mean_xgb
[[22222   729  2458  2590   308     0   279  1254]
 [  571 16506     6  7925     3     0   545   587]
 [    0   352  1738   684     0     0     0     0]
 [    0     3     0 11918   111     0     0     0]
 [  289   221     0  4184 14136  1527   117     0]
 [   16     0     0  3345  1009  4707   103     0]
 [  439    74   193  1696  3772     0 14452  1184]
 [    0     0     0     0     0     0  2277 19430]]
              precision    recall  f1-score   support

       Still       0.94      0.74      0.83     29840
     Walking       0.92      0.63      0.75     26143
         Run       0.40      0.63      0.48      2774
        Bike       0.37      0.99      0.54     12032
         Car       0.73      0.69      0.71     20474
         Bus       0.76      0.51      0.61      9180
       Train       0.81      0.66      0.73     21810
      Subway       0.87      0.90      0.88     21707

    accuracy                           0.73    143960
   macro avg       0.72      0.72      0.69    143960
weighted avg       0.81      0.73      0.75    143960

test over
training set : Torso ; testing set : Hips; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 0.99
predict bag
Time elapsed for testing bag: 40.45
predict catboost
Time elapsed for testing CatBoost: 0.26
predict lgb
Time elapsed for testing lgb: 1.33
predict xgb
Time elapsed for testing xgb: 3.31
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : Torso ; testing set : Hips  testing result
tree_model.pred_mean
[[24450   841     0   328   138    75  3707   301]
 [  567 21649     0  2129     0    42  1403   353]
 [    0   149  1774   851     0     0     0     0]
 [   57  1645     0 10309    21     0     0     0]
 [  657    34     0     0 17167  2184   432     0]
 [  290     0     0   114  1323  6858   595     0]
 [  796    34     0    72  2571   911 16449   977]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.91      0.82      0.86     29840
     Walking       0.89      0.83      0.86     26143
         Run       1.00      0.64      0.78      2774
        Bike       0.75      0.86      0.80     12032
         Car       0.81      0.84      0.82     20474
         Bus       0.68      0.75      0.71      9180
       Train       0.49      0.75      0.59     21810
      Subway       0.87      0.49      0.62     21707

    accuracy                           0.76    143960
   macro avg       0.80      0.75      0.76    143960
weighted avg       0.80      0.76      0.76    143960

tree_model.pred_mean_rf
[[23691   466     0   677    21  1265  3594   126]
 [  964 14169     0 10264     0   110   440   196]
 [    0     0  1575  1199     0     0     0     0]
 [   55   354     0 11473   150     0     0     0]
 [ 1079    19     0     0 16194  2818   364     0]
 [ 1098     0     0   241  1872  5688   281     0]
 [ 1129     3     0    94  2034  1073 16429  1048]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.79      0.82     29840
     Walking       0.94      0.54      0.69     26143
         Run       1.00      0.57      0.72      2774
        Bike       0.48      0.95      0.64     12032
         Car       0.80      0.79      0.79     20474
         Bus       0.52      0.62      0.57      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.89      0.49      0.63     21707

    accuracy                           0.69    143960
   macro avg       0.75      0.69      0.68    143960
weighted avg       0.76      0.69      0.70    143960

tree_model.pred_mean_bag
[[21769  1303     0   213    46  1994  3610   905]
 [  415 22415     0  2987     0    88    43   195]
 [    0   689  1212   873     0     0     0     0]
 [    4  2466     0  9400   162     0     0     0]
 [ 1185   103     0    23 17451  1559   153     0]
 [  375    18     0   225  1364  6822   376     0]
 [ 1038    66     0    59  2751  1302 15241  1353]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.88      0.73      0.80     29840
     Walking       0.83      0.86      0.84     26143
         Run       1.00      0.44      0.61      2774
        Bike       0.68      0.78      0.73     12032
         Car       0.80      0.85      0.83     20474
         Bus       0.58      0.74      0.65      9180
       Train       0.50      0.70      0.58     21810
      Subway       0.81      0.49      0.61     21707

    accuracy                           0.73    143960
   macro avg       0.76      0.70      0.71    143960
weighted avg       0.76      0.73      0.73    143960

tree_model.pred_mean_catboost
[[25444   424     0   539   218   193  2779   243]
 [ 1052 20460     0  2535     0   258  1479   359]
 [    0   235  1300  1239     0     0     0     0]
 [  128   899     0 10843   162     0     0     0]
 [  158    24     0    68 15368  3127  1729     0]
 [  444    12     0    26   900  7234   564     0]
 [  956    61     0   115  2618  1364 15274  1422]
 [    0     5     0     0     0     0  5583 16119]]
              precision    recall  f1-score   support

       Still       0.90      0.85      0.88     29840
     Walking       0.92      0.78      0.85     26143
         Run       1.00      0.47      0.64      2774
        Bike       0.71      0.90      0.79     12032
         Car       0.80      0.75      0.77     20474
         Bus       0.59      0.79      0.68      9180
       Train       0.56      0.70      0.62     21810
      Subway       0.89      0.74      0.81     21707

    accuracy                           0.78    143960
   macro avg       0.80      0.75      0.75    143960
weighted avg       0.80      0.78      0.78    143960

tree_model.pred_mean_lightgbm
[[22943   890     0   528   169   156  4126  1028]
 [  762 21432    62  2007     0    75  1351   454]
 [    0   181  1843   750     0     0     0     0]
 [  169  2677     0  9158    28     0     0     0]
 [ 1582    28     0    59 15696  2840   269     0]
 [  246     0     0    77  1756  6383   718     0]
 [  592    33     0    49  3193   805 16148   990]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.77      0.82     29840
     Walking       0.85      0.82      0.83     26143
         Run       0.97      0.66      0.79      2774
        Bike       0.73      0.76      0.74     12032
         Car       0.75      0.77      0.76     20474
         Bus       0.62      0.70      0.66      9180
       Train       0.48      0.74      0.58     21810
      Subway       0.81      0.49      0.61     21707

    accuracy                           0.72    143960
   macro avg       0.76      0.71      0.72    143960
weighted avg       0.76      0.72      0.73    143960

tree_model.pred_mean_xgb
[[23280   822    43   791  1018   119  3614   153]
 [  662 21691    88  1746     0    47  1644   265]
 [    0   148  1784   842     0     0     0     0]
 [  372  1694     0  9960     6     0     0     0]
 [  478    48     0     0 17038  2441   469     0]
 [  360     0     0   112  1326  6655   727     0]
 [  806    64     0    31  2294   748 16824  1043]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.90      0.78      0.83     29840
     Walking       0.89      0.83      0.86     26143
         Run       0.93      0.64      0.76      2774
        Bike       0.74      0.83      0.78     12032
         Car       0.79      0.83      0.81     20474
         Bus       0.66      0.72      0.69      9180
       Train       0.49      0.77      0.60     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.78      0.74      0.75    143960
weighted avg       0.79      0.75      0.75    143960

test over
begin training all
training set:all_train_set,the 0th training set
begin training
X_train: (3922100, 204)
y_train: 3922100
Training rf...
Time elapsed for training rf: 823.74
Training bag (tree-based)...
Time elapsed for training bag (tree-based): 618.8
Training CatBoost...
0:	learn: 1.5458545	total: 1.49s	remaining: 2m 27s
1:	learn: 1.1773961	total: 2.72s	remaining: 2m 13s
2:	learn: 0.8789692	total: 3.89s	remaining: 2m 5s
3:	learn: 0.7918295	total: 5.14s	remaining: 2m 3s
4:	learn: 0.6838930	total: 6.35s	remaining: 2m
5:	learn: 0.6409259	total: 7.46s	remaining: 1m 56s
6:	learn: 0.6212112	total: 8.8s	remaining: 1m 56s
7:	learn: 0.5652735	total: 10.2s	remaining: 1m 57s
8:	learn: 0.5374342	total: 11.3s	remaining: 1m 54s
9:	learn: 0.5025192	total: 12.7s	remaining: 1m 53s
10:	learn: 0.4839088	total: 13.8s	remaining: 1m 51s
11:	learn: 0.4696504	total: 15.4s	remaining: 1m 53s
12:	learn: 0.5323988	total: 16.6s	remaining: 1m 51s
13:	learn: 0.5099625	total: 18.2s	remaining: 1m 51s
14:	learn: 0.4942688	total: 19.3s	remaining: 1m 49s
15:	learn: 0.4734808	total: 20.8s	remaining: 1m 49s
16:	learn: 0.4830404	total: 21.8s	remaining: 1m 46s
17:	learn: 0.6891570	total: 22.9s	remaining: 1m 44s
18:	learn: 4.1810297	total: 24s	remaining: 1m 42s
19:	learn: 4.1653480	total: 25.5s	remaining: 1m 41s
20:	learn: 4.1545576	total: 26.7s	remaining: 1m 40s
21:	learn: 4.1457921	total: 27.9s	remaining: 1m 38s
22:	learn: 4.1418321	total: 28.9s	remaining: 1m 36s
23:	learn: 4.1333466	total: 30.2s	remaining: 1m 35s
24:	learn: 4.1186474	total: 31.5s	remaining: 1m 34s
25:	learn: 4.1054518	total: 32.8s	remaining: 1m 33s
26:	learn: 4.0991373	total: 33.9s	remaining: 1m 31s
27:	learn: 4.0918192	total: 35.3s	remaining: 1m 30s
28:	learn: 4.0888494	total: 36.3s	remaining: 1m 28s
29:	learn: 4.0759180	total: 37.5s	remaining: 1m 27s
30:	learn: 4.0542317	total: 39.1s	remaining: 1m 26s
31:	learn: 4.0558005	total: 40.2s	remaining: 1m 25s
32:	learn: 4.0483505	total: 41.3s	remaining: 1m 23s
33:	learn: 4.0418197	total: 42.5s	remaining: 1m 22s
34:	learn: 4.0372363	total: 43.7s	remaining: 1m 21s
35:	learn: 4.0332345	total: 44.9s	remaining: 1m 19s
36:	learn: 4.0297613	total: 46.4s	remaining: 1m 18s
37:	learn: 4.0282866	total: 47.4s	remaining: 1m 17s
38:	learn: 4.0241914	total: 48.5s	remaining: 1m 15s
39:	learn: 4.0200966	total: 50.1s	remaining: 1m 15s
40:	learn: 4.0170064	total: 51.4s	remaining: 1m 13s
41:	learn: 4.0127551	total: 52.8s	remaining: 1m 12s
42:	learn: 4.0105995	total: 54s	remaining: 1m 11s
43:	learn: 78.6664605	total: 55.1s	remaining: 1m 10s
44:	learn: 3033.0702972	total: 56.4s	remaining: 1m 8s
45:	learn: 19819.7702878	total: 57.7s	remaining: 1m 7s
46:	learn: 12102.4087479	total: 59.1s	remaining: 1m 6s
47:	learn: 21819.2480930	total: 1m	remaining: 1m 5s
48:	learn: 18154.1943824	total: 1m 1s	remaining: 1m 4s
49:	learn: 5687.7615908	total: 1m 3s	remaining: 1m 3s
50:	learn: 21032.5872726	total: 1m 4s	remaining: 1m 1s
51:	learn: 14449.2036796	total: 1m 5s	remaining: 1m
52:	learn: 12764.4221051	total: 1m 7s	remaining: 59.5s
53:	learn: 15890.5663885	total: 1m 8s	remaining: 58.3s
54:	learn: 7493.1032533	total: 1m 9s	remaining: 57.1s
55:	learn: 19356.3081485	total: 1m 11s	remaining: 55.9s
56:	learn: 14711.5821641	total: 1m 12s	remaining: 54.7s
57:	learn: 26491.9730530	total: 1m 13s	remaining: 53.5s
58:	learn: 18288.0061667	total: 1m 15s	remaining: 52.3s
59:	learn: 6683.0994152	total: 1m 16s	remaining: 51.1s
60:	learn: 19326.9727286	total: 1m 17s	remaining: 49.8s
61:	learn: 17297.2918443	total: 1m 19s	remaining: 48.6s
62:	learn: 12814.5644134	total: 1m 20s	remaining: 47.4s
63:	learn: 20685.4459449	total: 1m 22s	remaining: 46.2s
64:	learn: 9175.3624326	total: 1m 23s	remaining: 45.1s
65:	learn: 20203.4032414	total: 1m 25s	remaining: 43.8s
66:	learn: 18565.7075798	total: 1m 26s	remaining: 42.6s
67:	learn: 8439.3579993	total: 1m 27s	remaining: 41.3s
68:	learn: 11775.6476192	total: 1m 29s	remaining: 40.1s
69:	learn: 6678.8545536	total: 1m 30s	remaining: 38.8s
70:	learn: 15959.4623848	total: 1m 31s	remaining: 37.6s
71:	learn: 15471.8477354	total: 1m 33s	remaining: 36.3s
72:	learn: 18549.9483187	total: 1m 34s	remaining: 35s
73:	learn: 18862.8692770	total: 1m 36s	remaining: 33.8s
74:	learn: 10187.2167299	total: 1m 37s	remaining: 32.5s
75:	learn: 17446.5311520	total: 1m 38s	remaining: 31.2s
76:	learn: 18012.4847600	total: 1m 40s	remaining: 29.9s
77:	learn: 7296.3643510	total: 1m 41s	remaining: 28.6s
78:	learn: 17802.8183648	total: 1m 42s	remaining: 27.3s
79:	learn: 8714.3923137	total: 1m 44s	remaining: 26s
80:	learn: 17690.4699006	total: 1m 45s	remaining: 24.8s
81:	learn: 12111.8031182	total: 1m 46s	remaining: 23.5s
82:	learn: 28678.7073708	total: 1m 48s	remaining: 22.2s
83:	learn: 20774.6021024	total: 1m 49s	remaining: 20.9s
84:	learn: 11255.0293383	total: 1m 51s	remaining: 19.6s
85:	learn: 15993.1171879	total: 1m 52s	remaining: 18.4s
86:	learn: 18289.4937907	total: 1m 54s	remaining: 17.1s
87:	learn: 9705.6713138	total: 1m 55s	remaining: 15.8s
88:	learn: 23425.0430109	total: 1m 56s	remaining: 14.5s
89:	learn: 13652.4691165	total: 1m 58s	remaining: 13.1s
90:	learn: 17525.3454687	total: 1m 59s	remaining: 11.8s
91:	learn: 20686.9335688	total: 2m 1s	remaining: 10.5s
92:	learn: 10580.4166854	total: 2m 2s	remaining: 9.22s
93:	learn: 6689.5913628	total: 2m 3s	remaining: 7.9s
94:	learn: 16049.9088947	total: 2m 5s	remaining: 6.59s
95:	learn: 19057.5737495	total: 2m 6s	remaining: 5.27s
96:	learn: 23084.3733470	total: 2m 7s	remaining: 3.96s
97:	learn: 13230.8575940	total: 2m 9s	remaining: 2.64s
98:	learn: 7584.2077961	total: 2m 10s	remaining: 1.32s
99:	learn: 13852.6910382	total: 2m 11s	remaining: 0us
Time elapsed for training CatBoost: 135.18
Training LightGBM...
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Warning] Auto-choosing col-wise multi-threading, the overhead of testing was 1.783965 seconds.
You can set `force_col_wise=true` to remove the overhead.
[LightGBM] [Info] Total Bins 47646
[LightGBM] [Info] Number of data points in the train set: 3137680, number of used features: 204
[LightGBM] [Warning] Accuracy may be bad since you didn't explicitly set num_leaves OR 2^max_depth > num_leaves. (num_leaves=31).
[LightGBM] [Info] Start training from score -2.081399
[LightGBM] [Info] Start training from score -2.078606
[LightGBM] [Info] Start training from score -3.143161
[LightGBM] [Info] Start training from score -2.123146
[LightGBM] [Info] Start training from score -1.820344
[LightGBM] [Info] Start training from score -1.934581
[LightGBM] [Info] Start training from score -1.837517
[LightGBM] [Info] Start training from score -2.106426
[1]	valid_0's multi_logloss: 1.49998
[2]	valid_0's multi_logloss: 1.22867
[3]	valid_0's multi_logloss: 1.03536
[4]	valid_0's multi_logloss: 0.890408
[5]	valid_0's multi_logloss: 0.774165
[6]	valid_0's multi_logloss: 0.679662
[7]	valid_0's multi_logloss: 0.6016
[8]	valid_0's multi_logloss: 0.536121
[9]	valid_0's multi_logloss: 0.481165
[10]	valid_0's multi_logloss: 0.434973
[11]	valid_0's multi_logloss: 0.395681
[12]	valid_0's multi_logloss: 0.361905
[13]	valid_0's multi_logloss: 0.332358
[14]	valid_0's multi_logloss: 0.306908
[15]	valid_0's multi_logloss: 0.284435
[16]	valid_0's multi_logloss: 0.26449
[17]	valid_0's multi_logloss: 0.247176
[18]	valid_0's multi_logloss: 0.231558
[19]	valid_0's multi_logloss: 0.217768
[20]	valid_0's multi_logloss: 0.20582
[21]	valid_0's multi_logloss: 0.195271
[22]	valid_0's multi_logloss: 0.185659
[23]	valid_0's multi_logloss: 0.176663
[24]	valid_0's multi_logloss: 0.16924
[25]	valid_0's multi_logloss: 0.161781
[26]	valid_0's multi_logloss: 0.155734
[27]	valid_0's multi_logloss: 0.149598
[28]	valid_0's multi_logloss: 0.1438
[29]	valid_0's multi_logloss: 0.13859
[30]	valid_0's multi_logloss: 0.133859
[31]	valid_0's multi_logloss: 0.129255
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[32]	valid_0's multi_logloss: 0.125037
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[33]	valid_0's multi_logloss: 0.120811
[34]	valid_0's multi_logloss: 0.117141
[35]	valid_0's multi_logloss: 0.113621
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[36]	valid_0's multi_logloss: 0.110561
[37]	valid_0's multi_logloss: 0.107257
[38]	valid_0's multi_logloss: 0.104229
[39]	valid_0's multi_logloss: 0.101318
[40]	valid_0's multi_logloss: 0.0990549
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[41]	valid_0's multi_logloss: 0.0964463
[42]	valid_0's multi_logloss: 0.0943155
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[43]	valid_0's multi_logloss: 0.0921792
[44]	valid_0's multi_logloss: 0.0901382
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[45]	valid_0's multi_logloss: 0.0877666
[46]	valid_0's multi_logloss: 0.0857757
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[47]	valid_0's multi_logloss: 0.0839392
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[48]	valid_0's multi_logloss: 0.0823966
[49]	valid_0's multi_logloss: 0.0805543
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[50]	valid_0's multi_logloss: 0.0787512
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[51]	valid_0's multi_logloss: 0.0772347
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[52]	valid_0's multi_logloss: 0.0754595
[53]	valid_0's multi_logloss: 0.0741429
[54]	valid_0's multi_logloss: 0.0726713
[55]	valid_0's multi_logloss: 0.0713959
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[56]	valid_0's multi_logloss: 0.0701791
[57]	valid_0's multi_logloss: 0.0691296
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[58]	valid_0's multi_logloss: 0.0678932
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[59]	valid_0's multi_logloss: 0.0666501
[60]	valid_0's multi_logloss: 0.0655254
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[61]	valid_0's multi_logloss: 0.0645251
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[62]	valid_0's multi_logloss: 0.0634571
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[63]	valid_0's multi_logloss: 0.0625977
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[64]	valid_0's multi_logloss: 0.0616236
[65]	valid_0's multi_logloss: 0.0605373
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[66]	valid_0's multi_logloss: 0.0596814
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[67]	valid_0's multi_logloss: 0.0587109
[68]	valid_0's multi_logloss: 0.0577614
[69]	valid_0's multi_logloss: 0.0568522
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[70]	valid_0's multi_logloss: 0.0559837
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[71]	valid_0's multi_logloss: 0.0552054
[72]	valid_0's multi_logloss: 0.0542991
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[73]	valid_0's multi_logloss: 0.0535983
[74]	valid_0's multi_logloss: 0.0529527
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[75]	valid_0's multi_logloss: 0.0520793
[76]	valid_0's multi_logloss: 0.051368
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[77]	valid_0's multi_logloss: 0.0507195
[78]	valid_0's multi_logloss: 0.0499735
[79]	valid_0's multi_logloss: 0.0493404
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[80]	valid_0's multi_logloss: 0.0487742
[81]	valid_0's multi_logloss: 0.0480854
[82]	valid_0's multi_logloss: 0.0472851
[83]	valid_0's multi_logloss: 0.0467326
[84]	valid_0's multi_logloss: 0.0459524
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[85]	valid_0's multi_logloss: 0.0454623
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[86]	valid_0's multi_logloss: 0.0449522
[87]	valid_0's multi_logloss: 0.0444716
[88]	valid_0's multi_logloss: 0.043919
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[89]	valid_0's multi_logloss: 0.0433099
[90]	valid_0's multi_logloss: 0.0427918
[91]	valid_0's multi_logloss: 0.0422475
[92]	valid_0's multi_logloss: 0.0415964
[93]	valid_0's multi_logloss: 0.0411138
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[94]	valid_0's multi_logloss: 0.0406544
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[95]	valid_0's multi_logloss: 0.040174
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[96]	valid_0's multi_logloss: 0.0397323
[97]	valid_0's multi_logloss: 0.0392415
[98]	valid_0's multi_logloss: 0.0388352
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[99]	valid_0's multi_logloss: 0.0383965
[LightGBM] [Warning] No further splits with positive gain, best gain: -inf
[100]	valid_0's multi_logloss: 0.0379937
Time elapsed for training LightGBM: 356.94
Training XGBoost...
Time elapsed for training XGBoost: 1892.31
begin testing
training set : all_train_set ; testing set : all_test_set; test order: 0
X_val  : (575840, 204)
y_val  : 575840
predict rf
Time elapsed for testing rf 4.19
predict bag
Time elapsed for testing bag: 176.49
predict catboost
Time elapsed for testing CatBoost: 1.13
predict lgb
Time elapsed for testing lgb: 4.75
predict xgb
Time elapsed for testing xgb: 12.4
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : all_train_set ; testing set : all_test_set  testing result
tree_model.pred_mean
[[103746   1533      0    165   1685   3615   6311   2305]
 [  5392  92041      1   2653    399   1731   1300   1055]
 [     0   7705   2997    394      0      0      0      0]
 [  3457   4655      0  27510  11187   1103    216      0]
 [  1559    457      0     78  70006   9152    644      0]
 [   143    109      0    122   7635  28487    224      0]
 [  5223    221      0    110  10380   4632  64042   2632]
 [     0      0      0      0      0      0  26751  60077]]
              precision    recall  f1-score   support

       Still       0.87      0.87      0.87    119360
     Walking       0.86      0.88      0.87    104572
         Run       1.00      0.27      0.43     11096
        Bike       0.89      0.57      0.70     48128
         Car       0.69      0.85      0.76     81896
         Bus       0.58      0.78      0.67     36720
       Train       0.64      0.73      0.69     87240
      Subway       0.91      0.69      0.79     86828

    accuracy                           0.78    575840
   macro avg       0.81      0.71      0.72    575840
weighted avg       0.80      0.78      0.78    575840

tree_model.pred_mean_rf
[[104660   1866      0    640   2104   2406   5430   2254]
 [  4770  92385     21   4093   1048    835    559    861]
 [     0   6761   3346    989      0      0      0      0]
 [   390   4603      0  24256  15639   3240      0      0]
 [  1986    494      0    214  72011   6445    558    188]
 [  2062    163      0    232   4642  29618      3      0]
 [  6824    194      0    178   4218   3801  67655   4370]
 [     0     21      0      0      0      0  24504  62303]]
              precision    recall  f1-score   support

       Still       0.87      0.88      0.87    119360
     Walking       0.87      0.88      0.88    104572
         Run       0.99      0.30      0.46     11096
        Bike       0.79      0.50      0.62     48128
         Car       0.72      0.88      0.79     81896
         Bus       0.64      0.81      0.71     36720
       Train       0.69      0.78      0.73     87240
      Subway       0.89      0.72      0.79     86828

    accuracy                           0.79    575840
   macro avg       0.81      0.72      0.73    575840
weighted avg       0.80      0.79      0.79    575840

tree_model.pred_mean_bag
[[93107  2868     0   173  3741  3173 11343  4955]
 [ 3070 89358     0  4752  1368  1800  2287  1937]
 [    0  6572  2380  2144     0     0     0     0]
 [  230 10476     0 13581 19953  3888     0     0]
 [ 3286   639     0   257 69046  8525   143     0]
 [ 2092   122     0   240  2779 31276   211     0]
 [ 8142   102     0   105 10940  5545 60988  1418]
 [    0     0     0     0     0     0 26716 60112]]
              precision    recall  f1-score   support

       Still       0.85      0.78      0.81    119360
     Walking       0.81      0.85      0.83    104572
         Run       1.00      0.21      0.35     11096
        Bike       0.64      0.28      0.39     48128
         Car       0.64      0.84      0.73     81896
         Bus       0.58      0.85      0.69     36720
       Train       0.60      0.70      0.65     87240
      Subway       0.88      0.69      0.77     86828

    accuracy                           0.73    575840
   macro avg       0.75      0.65      0.65    575840
weighted avg       0.75      0.73      0.72    575840

tree_model.pred_mean_catboost
[[85344   570     0   698  3549 21674  4609  2916]
 [ 6593 85174     0  4057   302  4949  2348  1149]
 [    0 10544   321   231     0     0     0     0]
 [ 4983  6978     0 20213 11467  1945  2542     0]
 [ 1816   237     0   280 61894 16882   787     0]
 [  181   142     0   103  3657 32570    67     0]
 [ 5397   273     0   147 10567  4570 65651   635]
 [    0     0     0     0     0     0 28175 58653]]
              precision    recall  f1-score   support

       Still       0.82      0.72      0.76    119360
     Walking       0.82      0.81      0.82    104572
         Run       1.00      0.03      0.06     11096
        Bike       0.79      0.42      0.55     48128
         Car       0.68      0.76      0.71     81896
         Bus       0.39      0.89      0.55     36720
       Train       0.63      0.75      0.69     87240
      Subway       0.93      0.68      0.78     86828

    accuracy                           0.71    575840
   macro avg       0.76      0.63      0.61    575840
weighted avg       0.76      0.71      0.71    575840

tree_model.pred_mean_lightgbm
[[97393  1452   283    48  4309  4558  9521  1796]
 [ 5410 92560    60  2090   834  1100  1208  1310]
 [    0  7371  3500   225     0     0     0     0]
 [ 4431  3628     0 28228 11394   447     0     0]
 [ 1141   273     8     0 75745  4113   616     0]
 [   83   100     0    53  9147 26431   906     0]
 [ 3382   193     0   205 11164  4888 64714  2694]
 [    0    15     0     0     0     0 26757 60056]]
              precision    recall  f1-score   support

       Still       0.87      0.82      0.84    119360
     Walking       0.88      0.89      0.88    104572
         Run       0.91      0.32      0.47     11096
        Bike       0.92      0.59      0.71     48128
         Car       0.67      0.92      0.78     81896
         Bus       0.64      0.72      0.68     36720
       Train       0.62      0.74      0.68     87240
      Subway       0.91      0.69      0.79     86828

    accuracy                           0.78    575840
   macro avg       0.80      0.71      0.73    575840
weighted avg       0.80      0.78      0.78    575840

tree_model.pred_mean_xgb
[[105323   1949      0    235   2526   1533   6304   1490]
 [  5922  92725     58   3054    260    787   1183    583]
 [     0   7157   3395    544      0      0      0      0]
 [  4365   4631      0  31033   7184    838     77      0]
 [  1501    442      0      0  73894   5335    724      0]
 [   244     93      0    129  10119  25550    585      0]
 [  4865    237      0    278  11532   4183  62584   3561]
 [     0      9      0      0      0      0  26750  60069]]
              precision    recall  f1-score   support

       Still       0.86      0.88      0.87    119360
     Walking       0.86      0.89      0.88    104572
         Run       0.98      0.31      0.47     11096
        Bike       0.88      0.64      0.74     48128
         Car       0.70      0.90      0.79     81896
         Bus       0.67      0.70      0.68     36720
       Train       0.64      0.72      0.67     87240
      Subway       0.91      0.69      0.79     86828

    accuracy                           0.79    575840
   macro avg       0.81      0.72      0.74    575840
weighted avg       0.80      0.79      0.79    575840

test over
training set : all_train_set ; testing set : Torso; test order: 1
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.07
predict bag
Time elapsed for testing bag: 37.83
predict catboost
Time elapsed for testing CatBoost: 0.33
predict lgb
Time elapsed for testing lgb: 1.29
predict xgb
Time elapsed for testing xgb: 2.91
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : all_train_set ; testing set : Torso  testing result
tree_model.pred_mean
[[25838   221     0    47   423  1154  1929   228]
 [ 1770 22609     1   259   145   928   249   182]
 [    0  1933   841     0     0     0     0     0]
 [  723   690     0  6387  3643   373   216     0]
 [  297    74     0     0 16964  2980   159     0]
 [  101    38     0     0  1026  7950    65     0]
 [ 2377    23     0    10   926  2527 15347   600]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.83      0.87      0.85     29840
     Walking       0.88      0.86      0.87     26143
         Run       1.00      0.30      0.47      2774
        Bike       0.95      0.53      0.68     12032
         Car       0.73      0.83      0.78     20474
         Bus       0.50      0.87      0.63      9180
       Train       0.53      0.70      0.60     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.68      0.69    143960
weighted avg       0.79      0.74      0.74    143960

tree_model.pred_mean_rf
[[25645   305     0    54   490  1463  1701   182]
 [ 1844 22373     0   705   501   412   149   159]
 [    0  1922   852     0     0     0     0     0]
 [   81  1000     0  4050  5970   931     0     0]
 [  202    86     0     0 18119  1922    66    79]
 [ 1002    58     0     5   795  7320     0     0]
 [ 3316    14     0    25     0  1746 15691  1018]
 [    0     4     0     0     0     0 11099 10604]]
              precision    recall  f1-score   support

       Still       0.80      0.86      0.83     29840
     Walking       0.87      0.86      0.86     26143
         Run       1.00      0.31      0.47      2774
        Bike       0.84      0.34      0.48     12032
         Car       0.70      0.88      0.78     20474
         Bus       0.53      0.80      0.64      9180
       Train       0.55      0.72      0.62     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.73    143960
   macro avg       0.77      0.66      0.66    143960
weighted avg       0.76      0.73      0.72    143960

tree_model.pred_mean_bag
[[23360   182     0    35  1543  1351  2379   990]
 [ 1168 21761     0   756   564   723   639   532]
 [    0  1641   819   314     0     0     0     0]
 [   76  1686     0  1842  6863  1565     0     0]
 [  469    78     0     0 17197  2644    86     0]
 [  846    44     0    17   477  7796     0     0]
 [ 3945     1     0     0   732  1442 15344   346]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.78      0.78      0.78     29840
     Walking       0.86      0.83      0.84     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.62      0.15      0.25     12032
         Car       0.63      0.84      0.72     20474
         Bus       0.50      0.85      0.63      9180
       Train       0.52      0.70      0.60     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.69    143960
   macro avg       0.72      0.62      0.61    143960
weighted avg       0.72      0.69      0.67    143960

tree_model.pred_mean_catboost
[[22077   108     0    53   427  4972  1259   944]
 [ 2136 20398     0   591    78  2420   369   151]
 [    0  2562   172    40     0     0     0     0]
 [ 1728  1132     0  3576  3315   938  1343     0]
 [  403   101     0     0 15392  4428   150     0]
 [  181    43     0     0   768  8188     0     0]
 [ 2271    34     0     0  1012  2437 15913   143]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.77      0.74      0.75     29840
     Walking       0.84      0.78      0.81     26143
         Run       1.00      0.06      0.12      2774
        Bike       0.84      0.30      0.44     12032
         Car       0.73      0.75      0.74     20474
         Bus       0.35      0.89      0.50      9180
       Train       0.53      0.73      0.61     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.67    143960
   macro avg       0.74      0.59      0.58    143960
weighted avg       0.74      0.67      0.67    143960

tree_model.pred_mean_lightgbm
[[24620   327     0    20   720   905  2888   360]
 [ 1437 22980     9   266   229   713   229   280]
 [    0  1886   888     0     0     0     0     0]
 [  528   436     0  7076  3732   260     0     0]
 [  277    24     0     0 18450  1533   190     0]
 [   58    26     0     0  1914  6997   185     0]
 [ 1352    16     0    16  1314  3067 15287   758]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.87      0.83      0.85     29840
     Walking       0.89      0.88      0.89     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.96      0.59      0.73     12032
         Car       0.70      0.90      0.79     20474
         Bus       0.52      0.76      0.62      9180
       Train       0.51      0.70      0.59     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.68      0.70    143960
weighted avg       0.79      0.74      0.74    143960

tree_model.pred_mean_xgb
[[26640   379     0    24   305   359  1994   139]
 [ 2012 22909    10   276   120   462   223   131]
 [    0  1885   889     0     0     0     0     0]
 [  815   333     0  7437  3045   325    77     0]
 [  359    62     0     0 18182  1704   167     0]
 [  201    31     0     0  1785  6984   179     0]
 [ 2422    38     0     0   969  2340 15093   948]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.89      0.86     29840
     Walking       0.89      0.88      0.88     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.96      0.62      0.75     12032
         Car       0.74      0.89      0.81     20474
         Bus       0.57      0.76      0.65      9180
       Train       0.52      0.69      0.60     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.76    143960
   macro avg       0.80      0.69      0.71    143960
weighted avg       0.79      0.76      0.75    143960

test over
training set : all_train_set ; testing set : Bag; test order: 2
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.08
predict bag
Time elapsed for testing bag: 37.14
predict catboost
Time elapsed for testing CatBoost: 0.29
predict lgb
Time elapsed for testing lgb: 1.31
predict xgb
Time elapsed for testing xgb: 2.55
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : all_train_set ; testing set : Bag  testing result
tree_model.pred_mean
[[27080   303     0     0   581   466   440   970]
 [ 1223 23104     0   779   164   245   362   266]
 [    0  1943   831     0     0     0     0     0]
 [ 1241   857     0  4135  5289   510     0     0]
 [  295    40     0     0 18830  1143   166     0]
 [    0    33     0    47  2143  6897    60     0]
 [  780    37     0    33  3036   823 16307   794]
 [    0     0     0     0     0     0  2288 19419]]
              precision    recall  f1-score   support

       Still       0.88      0.91      0.90     29840
     Walking       0.88      0.88      0.88     26143
         Run       1.00      0.30      0.46      2774
        Bike       0.83      0.34      0.49     12032
         Car       0.63      0.92      0.75     20474
         Bus       0.68      0.75      0.72      9180
       Train       0.83      0.75      0.79     21810
      Subway       0.91      0.89      0.90     21707

    accuracy                           0.81    143960
   macro avg       0.83      0.72      0.73    143960
weighted avg       0.83      0.81      0.80    143960

tree_model.pred_mean_rf
[[28029   237     0    43   341   111   123   956]
 [  953 23414     0   832   387   159    87   311]
 [    0  1914   860     0     0     0     0     0]
 [  108   623     0  1865  7237  2199     0     0]
 [  255    36     0     0 18618  1370   134    61]
 [   33    39     0    50  1364  7694     0     0]
 [ 1375    18     0    66  1020   511 17851   969]
 [    0     0     0     0     0     0  2306 19401]]
              precision    recall  f1-score   support

       Still       0.91      0.94      0.93     29840
     Walking       0.89      0.90      0.89     26143
         Run       1.00      0.31      0.47      2774
        Bike       0.65      0.16      0.25     12032
         Car       0.64      0.91      0.75     20474
         Bus       0.64      0.84      0.73      9180
       Train       0.87      0.82      0.84     21810
      Subway       0.89      0.89      0.89     21707

    accuracy                           0.82    143960
   macro avg       0.81      0.72      0.72    143960
weighted avg       0.82      0.82      0.80    143960

tree_model.pred_mean_bag
[[24513   246     0    27   536   241  2494  1783]
 [  866 22503     0  1190   179   523   376   506]
 [    0  1706   613   455     0     0     0     0]
 [   83   884     0  1192  7855  2018     0     0]
 [  825    39     0    21 17888  1701     0     0]
 [  276    15     0    93   811  7854   131     0]
 [ 1829     1     0    33  3542  1282 14841   282]
 [    0     0     0     0     0     0  2291 19416]]
              precision    recall  f1-score   support

       Still       0.86      0.82      0.84     29840
     Walking       0.89      0.86      0.87     26143
         Run       1.00      0.22      0.36      2774
        Bike       0.40      0.10      0.16     12032
         Car       0.58      0.87      0.70     20474
         Bus       0.58      0.86      0.69      9180
       Train       0.74      0.68      0.71     21810
      Subway       0.88      0.89      0.89     21707

    accuracy                           0.76    143960
   macro avg       0.74      0.66      0.65    143960
weighted avg       0.76      0.76      0.74    143960

tree_model.pred_mean_catboost
[[21639   124     0    74  1314  5670   116   903]
 [ 1493 21027     0  1786   191   819   395   432]
 [    0  2648    65    61     0     0     0     0]
 [ 1581  1217     0  3131  4896   723   484     0]
 [  368    20     0     0 16259  3633   194     0]
 [    0    47     0    35   546  8552     0     0]
 [  890    62     0     9  3084   887 16769   109]
 [    0     0     0     0     0     0  2206 19501]]
              precision    recall  f1-score   support

       Still       0.83      0.73      0.78     29840
     Walking       0.84      0.80      0.82     26143
         Run       1.00      0.02      0.05      2774
        Bike       0.61      0.26      0.37     12032
         Car       0.62      0.79      0.70     20474
         Bus       0.42      0.93      0.58      9180
       Train       0.83      0.77      0.80     21810
      Subway       0.93      0.90      0.91     21707

    accuracy                           0.74    143960
   macro avg       0.76      0.65      0.62    143960
weighted avg       0.78      0.74      0.74    143960

tree_model.pred_mean_lightgbm
[[24573   290   176     0  1927   744  1883   247]
 [ 1312 23353     9   444   246    77   370   332]
 [    0  1868   890    16     0     0     0     0]
 [ 1036   568     0  5983  4379    66     0     0]
 [   69    40     8     0 19820   388   149     0]
 [    0    54     0     0  2503  6381   242     0]
 [  521    28     0   114  3120   716 16408   903]
 [    0     2     0     0     0     0  2282 19423]]
              precision    recall  f1-score   support

       Still       0.89      0.82      0.86     29840
     Walking       0.89      0.89      0.89     26143
         Run       0.82      0.32      0.46      2774
        Bike       0.91      0.50      0.64     12032
         Car       0.62      0.97      0.76     20474
         Bus       0.76      0.70      0.73      9180
       Train       0.77      0.75      0.76     21810
      Subway       0.93      0.89      0.91     21707

    accuracy                           0.81    143960
   macro avg       0.82      0.73      0.75    143960
weighted avg       0.83      0.81      0.81    143960

tree_model.pred_mean_xgb
[[28073   383     0    11   424   186   469   294]
 [ 1445 23210     6   809   110    79   363   121]
 [    0  1688   887   199     0     0     0     0]
 [ 2213   815     0  5345  3333   326     0     0]
 [  288    55     0     0 19846   125   160     0]
 [    0    35     0    51  3103  5813   178     0]
 [  635    61     0    58  3686   717 15734   919]
 [    0     2     0     0     0     0  2281 19424]]
              precision    recall  f1-score   support

       Still       0.86      0.94      0.90     29840
     Walking       0.88      0.89      0.89     26143
         Run       0.99      0.32      0.48      2774
        Bike       0.83      0.44      0.58     12032
         Car       0.65      0.97      0.78     20474
         Bus       0.80      0.63      0.71      9180
       Train       0.82      0.72      0.77     21810
      Subway       0.94      0.89      0.91     21707

    accuracy                           0.82    143960
   macro avg       0.85      0.73      0.75    143960
weighted avg       0.84      0.82      0.81    143960

test over
training set : all_train_set ; testing set : Hand; test order: 3
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.08
predict bag
Time elapsed for testing bag: 35.5
predict catboost
Time elapsed for testing CatBoost: 0.25
predict lgb
Time elapsed for testing lgb: 1.32
predict xgb
Time elapsed for testing xgb: 2.67
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : all_train_set ; testing set : Hand  testing result
tree_model.pred_mean
[[26458   436     0    74   544  1007   345   976]
 [ 1584 22829     0   908    90   208   186   338]
 [    0  1621  1059    94     0     0     0     0]
 [  861   145     0  8995  1811   220     0     0]
 [  306   299     0    78 17259  2398   134     0]
 [    7    19     0    26  2532  6596     0     0]
 [  988   103     0    49  3684   292 16070   624]
 [    0     0     0     0     0     0  2265 19442]]
              precision    recall  f1-score   support

       Still       0.88      0.89      0.88     29840
     Walking       0.90      0.87      0.88     26143
         Run       1.00      0.38      0.55      2774
        Bike       0.88      0.75      0.81     12032
         Car       0.67      0.84      0.74     20474
         Bus       0.62      0.72      0.66      9180
       Train       0.85      0.74      0.79     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.82    143960
   macro avg       0.84      0.76      0.78    143960
weighted avg       0.84      0.82      0.83    143960

tree_model.pred_mean_rf
[[26044   625     0   159  1051   817   159   985]
 [  977 23110     0  1507   160   142    40   207]
 [    0  1325  1132   317     0     0     0     0]
 [    2   188     0  9576  2156   110     0     0]
 [  557   298     0   214 17757  1559    41    48]
 [  339    27     0   110  1388  7316     0     0]
 [  994   104     0    55  2426   356 16623  1252]
 [    0    17     0     0     0     0     0 21690]]
              precision    recall  f1-score   support

       Still       0.90      0.87      0.89     29840
     Walking       0.90      0.88      0.89     26143
         Run       1.00      0.41      0.58      2774
        Bike       0.80      0.80      0.80     12032
         Car       0.71      0.87      0.78     20474
         Bus       0.71      0.80      0.75      9180
       Train       0.99      0.76      0.86     21810
      Subway       0.90      1.00      0.95     21707

    accuracy                           0.86    143960
   macro avg       0.86      0.80      0.81    143960
weighted avg       0.87      0.86      0.86    143960

tree_model.pred_mean_bag
[[21913  1348     0    23  1362  1482  2466  1246]
 [  278 23131     0  1096   564   115   511   448]
 [    0  1552   493   729     0     0     0     0]
 [    0  4366     0  2955  4407   304     0     0]
 [  609   412     0   225 17521  1707     0     0]
 [  355    38     0    58   436  8213    80     0]
 [ 1144    85     0     7  4394  1141 14770   269]
 [    0     0     0     0     0     0  2227 19480]]
              precision    recall  f1-score   support

       Still       0.90      0.73      0.81     29840
     Walking       0.75      0.88      0.81     26143
         Run       1.00      0.18      0.30      2774
        Bike       0.58      0.25      0.35     12032
         Car       0.61      0.86      0.71     20474
         Bus       0.63      0.89      0.74      9180
       Train       0.74      0.68      0.71     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.75    143960
   macro avg       0.76      0.67      0.67    143960
weighted avg       0.77      0.75      0.74    143960

tree_model.pred_mean_catboost
[[22706   166     0   526   464  4862   167   949]
 [ 1805 21405     0   948    30  1091   532   332]
 [    0  2729     5    40     0     0     0     0]
 [  653   110     0  8818  1820   227   404     0]
 [  389    82     0   270 15116  4407   210     0]
 [    0    32     0    23  1011  8114     0     0]
 [  979   106     0   133  3866   264 16325   137]
 [    0     0     0     0     0     0  3771 17936]]
              precision    recall  f1-score   support

       Still       0.86      0.76      0.81     29840
     Walking       0.87      0.82      0.84     26143
         Run       1.00      0.00      0.00      2774
        Bike       0.82      0.73      0.77     12032
         Car       0.68      0.74      0.71     20474
         Bus       0.43      0.88      0.58      9180
       Train       0.76      0.75      0.76     21810
      Subway       0.93      0.83      0.87     21707

    accuracy                           0.77    143960
   macro avg       0.79      0.69      0.67    143960
weighted avg       0.80      0.77      0.77    143960

tree_model.pred_mean_lightgbm
[[25734   355   107    15   611  1065   954   999]
 [ 1689 22784     7   729   288    96   168   382]
 [    0  1590  1184     0     0     0     0     0]
 [ 1955   181     0  7085  2690   121     0     0]
 [  450   168     0     0 18764  1001    91     0]
 [   12    11     0    10  2745  6220   182     0]
 [  931   102     0    75  3757   172 16469   304]
 [    0    12     0     0     0     0  2277 19418]]
              precision    recall  f1-score   support

       Still       0.84      0.86      0.85     29840
     Walking       0.90      0.87      0.89     26143
         Run       0.91      0.43      0.58      2774
        Bike       0.90      0.59      0.71     12032
         Car       0.65      0.92      0.76     20474
         Bus       0.72      0.68      0.70      9180
       Train       0.82      0.76      0.79     21810
      Subway       0.92      0.89      0.91     21707

    accuracy                           0.82    143960
   macro avg       0.83      0.75      0.77    143960
weighted avg       0.83      0.82      0.82    143960

tree_model.pred_mean_xgb
[[26810   609     0   151   574   568   176   952]
 [ 1473 23174    10  1101    30    46   138   171]
 [    0  1455  1223    96     0     0     0     0]
 [  680   293     0 10067   805   187     0     0]
 [  365   285     0     0 17849  1764   211     0]
 [   21    11     0    29  3100  5989    30     0]
 [  922    78     0   213  3937   206 15593   861]
 [    0     7     0     0     0     0  2271 19429]]
              precision    recall  f1-score   support

       Still       0.89      0.90      0.89     29840
     Walking       0.89      0.89      0.89     26143
         Run       0.99      0.44      0.61      2774
        Bike       0.86      0.84      0.85     12032
         Car       0.68      0.87      0.76     20474
         Bus       0.68      0.65      0.67      9180
       Train       0.85      0.71      0.78     21810
      Subway       0.91      0.90      0.90     21707

    accuracy                           0.83    143960
   macro avg       0.84      0.77      0.79    143960
weighted avg       0.84      0.83      0.83    143960

test over
training set : all_train_set ; testing set : Hips; test order: 4
X_val  : (143960, 204)
y_val  : 143960
predict rf
Time elapsed for testing rf 1.02
predict bag
Time elapsed for testing bag: 35.21
predict catboost
Time elapsed for testing CatBoost: 0.25
predict lgb
Time elapsed for testing lgb: 1.3
predict xgb
Time elapsed for testing xgb: 3.03
----------------------------rf bag lgb xgb catboost  ---------------------------------
--------------------------- rf---------------------------------
---------------------------bag---------------------------------
--------------------------- catboost---------------------------------
--------------------------- lightgbm---------------------------------
--------------------------- xgb---------------------------------
training set : all_train_set ; testing set : Hips  testing result
tree_model.pred_mean
[[24370   573     0    44   137   988  3597   131]
 [  798 23516     0   707     0   350   503   269]
 [    0  2169   305   300     0     0     0     0]
 [  632  2963     0  7993   444     0     0     0]
 [  661    44     0     0 16953  2631   185     0]
 [   35    19     0    49  1934  7044    99     0]
 [ 1078    58     0    18  2734   990 16318   614]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.88      0.82      0.85     29840
     Walking       0.80      0.90      0.85     26143
         Run       1.00      0.11      0.20      2774
        Bike       0.88      0.66      0.76     12032
         Car       0.76      0.83      0.79     20474
         Bus       0.59      0.77      0.67      9180
       Train       0.51      0.75      0.61     21810
      Subway       0.91      0.49      0.64     21707

    accuracy                           0.74    143960
   macro avg       0.79      0.67      0.67    143960
weighted avg       0.78      0.74      0.74    143960

tree_model.pred_mean_rf
[[24942   699     0   384   222    15  3447   131]
 [  960 23502     0  1092     0   122   283   184]
 [    0  1600   502   672     0     0     0     0]
 [  199  2792     0  8765   276     0     0     0]
 [  972    74     0     0 17517  1594   317     0]
 [  688    39     0    67  1095  7288     3     0]
 [ 1139    58     0    32   772  1188 17490  1131]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.86      0.84      0.85     29840
     Walking       0.82      0.90      0.86     26143
         Run       1.00      0.18      0.31      2774
        Bike       0.80      0.73      0.76     12032
         Car       0.88      0.86      0.87     20474
         Bus       0.71      0.79      0.75      9180
       Train       0.54      0.80      0.64     21810
      Subway       0.88      0.49      0.63     21707

    accuracy                           0.77    143960
   macro avg       0.81      0.70      0.71    143960
weighted avg       0.80      0.77      0.76    143960

tree_model.pred_mean_bag
[[23319  1092     0    88   300   100  4005   936]
 [  755 21966     0  1710    61   439   761   451]
 [    0  1616   460   698     0     0     0     0]
 [   71  3540     0  7593   828     0     0     0]
 [ 1383   110     0    11 16440  2473    57     0]
 [  615    25     0    72  1055  7413     0     0]
 [ 1222    15     0    65  2272  1682 16033   521]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.85      0.78      0.82     29840
     Walking       0.77      0.84      0.81     26143
         Run       1.00      0.17      0.28      2774
        Bike       0.74      0.63      0.68     12032
         Car       0.78      0.80      0.79     20474
         Bus       0.61      0.81      0.70      9180
       Train       0.50      0.74      0.60     21810
      Subway       0.85      0.49      0.62     21707

    accuracy                           0.72    143960
   macro avg       0.76      0.66      0.66    143960
weighted avg       0.75      0.72      0.72    143960

tree_model.pred_mean_catboost
[[18922   172     0    45  1344  6170  3067   120]
 [ 1192 22314     0   732     3   616  1052   234]
 [    0  2605    79    90     0     0     0     0]
 [ 1021  4519     0  4688  1436    57   311     0]
 [  656    34     0    10 15127  4414   233     0]
 [    0    20     0    45  1332  7716    67     0]
 [ 1257    71     0     5  2605   982 16644   246]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.82      0.63      0.72     29840
     Walking       0.75      0.85      0.80     26143
         Run       1.00      0.03      0.06      2774
        Bike       0.83      0.39      0.53     12032
         Car       0.69      0.74      0.71     20474
         Bus       0.39      0.84      0.53      9180
       Train       0.51      0.76      0.61     21810
      Subway       0.95      0.49      0.64     21707

    accuracy                           0.67    143960
   macro avg       0.74      0.59      0.58    143960
weighted avg       0.74      0.67      0.66    143960

tree_model.pred_mean_lightgbm
[[22466   480     0    13  1051  1844  3796   190]
 [  972 23478     0   651    71   214   441   316]
 [    0  1978   587   209     0     0     0     0]
 [  912  2443     0  8084   593     0     0     0]
 [  345    41     0     0 18711  1191   186     0]
 [   13     9     0    43  1985  6833   297     0]
 [  578    47     0     0  2973   933 16550   729]
 [    0     1     0     0     0     0 11099 10607]]
              precision    recall  f1-score   support

       Still       0.89      0.75      0.82     29840
     Walking       0.82      0.90      0.86     26143
         Run       1.00      0.21      0.35      2774
        Bike       0.90      0.67      0.77     12032
         Car       0.74      0.91      0.82     20474
         Bus       0.62      0.74      0.68      9180
       Train       0.51      0.76      0.61     21810
      Subway       0.90      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.68      0.69    143960
weighted avg       0.79      0.75      0.74    143960

tree_model.pred_mean_xgb
[[23800   578     0    49  1223   420  3665   105]
 [  958 23498     0   868     0   200   459   160]
 [    0  2129   396   249     0     0     0     0]
 [  657  3190     0  8184     1     0     0     0]
 [  489    40     0     0 18017  1742   186     0]
 [   22    16     0    49  2131  6764   198     0]
 [  886    60     0     7  2940   920 16164   833]
 [    0     0     0     0     0     0 11099 10608]]
              precision    recall  f1-score   support

       Still       0.89      0.80      0.84     29840
     Walking       0.80      0.90      0.84     26143
         Run       1.00      0.14      0.25      2774
        Bike       0.87      0.68      0.76     12032
         Car       0.74      0.88      0.80     20474
         Bus       0.67      0.74      0.70      9180
       Train       0.51      0.74      0.60     21810
      Subway       0.91      0.49      0.63     21707

    accuracy                           0.75    143960
   macro avg       0.80      0.67      0.68    143960
weighted avg       0.78      0.75      0.74    143960

test over
